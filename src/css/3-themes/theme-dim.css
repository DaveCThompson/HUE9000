/* src/css/themes/theme-dim.css (REFACTOR-V2.1) */
/* Overrides variables from _variables-theme-contract.css for the DIM theme. */

body.theme-dim {
    /* --- Global Theme Adjustments --- */
    --theme-component-opacity: 0.85; 

    --theme-text-primary-l: 0.20;   --theme-text-primary-c: 0.001; --theme-text-primary-h: 240; --theme-text-primary-a: 0.8;
    --theme-text-secondary-l: 0.36; --theme-text-secondary-c: 0.001; --theme-text-secondary-h: 240; --theme-text-secondary-a: 0.25; 
    --theme-text-tertiary-l: 0.625;  --theme-text-tertiary-c: 0.001;  --theme-text-tertiary-h: 240; --theme-text-tertiary-a: 0.15; 

    /* --- Body Background --- */
    --body-bg-top-l: 0.125;     
    --body-bg-top-c: 0;         
    --body-bg-top-h: 0;
    --body-bg-top-a: 1;
    --body-bg-bottom-l: 0.09;   
    --body-bg-bottom-c: 0;      
    --body-bg-bottom-h: 0;
    --body-bg-bottom-a: 1;
    --noise-base-opacity: 0.08; 
    --noise-blend-mode: multiply;


    /* --- Panel Bezel & Sections --- */
    --panel-section-bg-l: 0.01; --panel-section-bg-c: 0.0005; --panel-section-bg-h: 240; --panel-section-bg-a: 1;
    --panel-section-border-l: 0.625; --panel-section-border-c: 0.0005; --panel-section-border-h: 240; --panel-section-border-a: 0.05;

    --panel-bezel-grad-1-l: 0.065; --panel-bezel-grad-2-l: 0.060; --panel-bezel-grad-3-l: 0.045; 
    --panel-bezel-grad-4-l: 0.055; --panel-bezel-grad-5-l: 0.070; --panel-bezel-grad-6-l: 0.035; 
    --panel-bezel-grad-7-l: 0.040; --panel-bezel-grad-8-l: 0.050; --panel-bezel-grad-9-l: 0.045; 
    --panel-bezel-texture-opacity: 0.05; 
    --panel-shadow-outer: none;
    --panel-shadow-inner: inset 0 0 0 1px oklch(var(--panel-section-border-l) var(--panel-section-border-c) var(--panel-section-border-h) / 0.5);

    /* --- Component: Button Unit --- */
    --btn-unlit-bg-l: 0.06;
    --btn-unlit-bg-a: 0.3;
    --btn-unlit-border-l: 0.1;
    --btn-unlit-border-a: 0.4;
    --btn-unlit-text-l: 0.1;
    --btn-unlit-text-a: 0.9;

    --btn-energized-unselected-bg-l: 0.75;
    --btn-energized-unselected-bg-a: 0.75;
    --btn-energized-unselected-border-l: 0.65;
    --btn-energized-unselected-border-a: 0.85;
    --btn-energized-unselected-text-l: 0.15;
    --btn-energized-unselected-light-l: 0.88;
    --btn-energized-unselected-glow-hover-l: 0.83;
    --btn-energized-unselected-glow-hover-a: 0.30;

    --btn-energized-selected-bg-l: 0.90;
    --btn-energized-selected-bg-a: 0.90;
    --btn-energized-selected-border-l: 0.80;
    --btn-energized-selected-border-a: 0.95;
    --btn-energized-selected-text-l: 0.15;
    --btn-energized-selected-light-l: 0.98;
    --btn-energized-selected-glow-l: 0.95;

    --btn-dimly-lit-bg-l: 0.28;
    --btn-dimly-lit-bg-a: 0.80;
    --btn-dimly-lit-border-l:0.33;
    --btn-dimly-lit-border-a:0.85;
    --btn-dimly-lit-text-l: 0.1;
    --btn-dimly-lit-light-l: 0.75;
    --btn-dimly-lit-light-a: 0.58;

    --btn-pressed-innershadow-color: oklch(0% 0 0 / 0.1);


    /* --- Component: LCD Screens --- */
    --lcd-unlit-bg-l: 0.01;
    --lcd-unlit-bg-c: 0;
    --lcd-unlit-bg-h: 0;
    --lcd-unlit-bg-a: 0.9;
    --lcd-unlit-text-l: 0.90; /* MODIFIED: Text lightness for unlit LCDs (e.g., P1-P5 terminal) */
    --lcd-unlit-text-c: 0;    
    --lcd-unlit-text-h: 0;    
    --lcd-unlit-text-a: 1; 
    --lcd-unlit-border-l: 0.03;
    --lcd-unlit-border-a: 0.15;
    --lcd-unlit-shadow: none;

    /* MODIFIED: Harmonized active-dim and dimly-lit variables */
    --lcd-active-dim-bg-l: 0.18; /* Match dimly-lit end gradient */
    --lcd-active-dim-bg-a: 1.0;
    --lcd-active-dim-text-l: 0.90; 
    --lcd-active-dim-text-c: 0;    
    --lcd-active-dim-text-h: 0;
    --lcd-active-dim-text-a: 1; 
    --lcd-active-dim-border-l: 0.09;
    --lcd-active-dim-border-a: 0.25;
    --lcd-active-dim-shadow: inset 0 1px 2px oklch(0% 0 0 / 0.1);
    --lcd-active-dim-chroma-factor: 0; 

    --lcd-dimly-lit-grad-start-l: 0.22;
    --lcd-dimly-lit-grad-end-l: 0.18;
    --lcd-dimly-lit-text-l: 0.90; /* MODIFIED: Text lightness for dimly-lit LCDs (e.g., P6-P9 terminal) */
    --lcd-dimly-lit-text-c: 0;          
    --lcd-dimly-lit-text-h: 0;
    --lcd-dimly-lit-text-a: 1; 
    --lcd-dimly-lit-shadow: inset 0 1px 2px oklch(0% 0 0 / 0.1);
    --lcd-dimly-lit-chroma-factor: 0;   

    --lcd-text-shadow-base-alpha: 0.25; 


    /* --- Component: Logo --- */

    /* --- Component: Lens Container & Core --- */
    --lens-bezel-opacity: 0.86; 
    --lens-bezel-dim-overlay-alpha: 0.4; 

    --lens-bezel-o-1-l: 0.1875;  --lens-bezel-o-1-c: 0.00875; --lens-bezel-o-1-h: 70.0;
    --lens-bezel-o-2-l: 0.1825;  --lens-bezel-o-2-c: 0.00875; --lens-bezel-o-2-h: 72.5;
    --lens-bezel-o-3-l: 0.1375;  --lens-bezel-o-3-c: 0.00875; --lens-bezel-o-3-h: 52.5;
    --lens-bezel-o-4-l: 0.1325;  --lens-bezel-o-4-c: 0.00625; --lens-bezel-o-4-h: 50.0;
    --lens-bezel-o-5-l: 0.3600;  --lens-bezel-o-5-c: 0.00400; --lens-bezel-o-5-h: 60.0;
    --lens-bezel-o-6-l: 0.2750;  --lens-bezel-o-6-c: 0.003125; --lens-bezel-o-6-h: 65.0; 
    --lens-bezel-o-7-l: 0.1350;  --lens-bezel-o-7-c: 0.003125; --lens-bezel-o-7-h: 53.75; 
    --lens-bezel-o-8-l: 0.1350;  --lens-bezel-o-8-c: 0.003125; --lens-bezel-o-8-h: 45.0;  
    --lens-bezel-o-9-l: 0.1425;  --lens-bezel-o-9-c: 0.003125; --lens-bezel-o-9-h: 45.0;  

    --lens-bezel-i-1-l: 0.3250;   --lens-bezel-i-1-c: 0.00875; --lens-bezel-i-1-h: 10.0;
    --lens-bezel-i-2-l: 0.2375;   --lens-bezel-i-2-c: 0.01125; --lens-bezel-i-2-h: 2.5;
    --lens-bezel-i-3-l: 0.2250;   --lens-bezel-i-3-c: 0.00875; --lens-bezel-i-3-h: 5.0;
    --lens-bezel-i-4-l: 0.3000;   --lens-bezel-i-4-c: 0.00625; --lens-bezel-i-4-h: 10.0;
    --lens-bezel-i-5-l: 0.3075;   --lens-bezel-i-5-c: 0.00625; --lens-bezel-i-5-h: 11.25;
    --lens-bezel-i-6-l: 0.2125;   --lens-bezel-i-6-c: 0.00200;  --lens-bezel-i-6-h: 60.0; 
    --lens-bezel-i-7-l: 0.2375;   --lens-bezel-i-7-c: 0.004375; --lens-bezel-i-7-h: 3.125; 
    --lens-bezel-i-8-l: 0.2625;   --lens-bezel-i-8-c: 0.004375; --lens-bezel-i-8-h: 4.375; 
    --lens-bezel-i-9-l: 0.1875;   --lens-bezel-i-9-c: 0.00250;  --lens-bezel-i-9-h: 35.0;  
    --lens-bezel-i-10-l: var(--lens-bezel-i-1-l); --lens-bezel-i-10-c: var(--lens-bezel-i-1-c); --lens-bezel-i-10-h: var(--lens-bezel-i-1-h);


    --lens-core-bg-l: 0.03; 

    --base-outer-glow-blur: calc(var(--_s-base-outer-glow-blur, 50px) * 2.5);
    --base-outer-glow-opacity: calc(var(--_s-base-outer-glow-opacity) * 1.33 * 1.1);
    --tune-outer-glow-l-factor-min: calc(var(--_s-tune-outer-glow-l-factor-min, 0.1) * 0.6);
    --tune-outer-glow-c-factor-min: calc(var(--_s-tune-outer-glow-c-factor-min, 0.02) * 0.4);
    --tune-outer-glow-blur-low-power-multiplier: calc(var(--_s-tune-outer-glow-blur-low-power-multiplier) * 1.2);

    --lens-outer-glow-dim-scale-multiplier: 1.3;

    --lens-super-glow-size-multiplier-dim: 1.8;
    --lens-super-glow-opacity-multiplier-dim: 1.5;
    --lens-super-glow-edge-stop-dim: 80%;

    --base-lens-super-glow-opacity-reference: calc(var(--_s-base-lens-super-glow-opacity-reference) * var(--lens-super-glow-opacity-multiplier-dim));
    --base-lens-super-glow-scale: calc(var(--_s-base-lens-super-glow-scale) * var(--lens-super-glow-size-multiplier-dim));
    --base-lens-super-glow-edge-stop: var(--lens-super-glow-edge-stop-dim);

    /* --- Component: Color Chips --- */
    --color-chip-base-opacity: .05; 

    /* --- Component: Grill --- */
    /* MODIFIED for brighter grill in P0 of theme-dim */
    --grill-bg-a: 0; /* Make background-color transparent */
    --grill-opacity: 0.08; /* Base opacity for grill texture in dim mode */
    --grill-blend-mode: normal; /* Use normal blend mode with transparent background */

    /* --- Component: Terminal Text Glow (Theme-Specific) --- */
    --terminal-text-glow-color: oklch(0.85 0.10 160); /* Bright Cyan for dim mode */
    --theme-terminal-glow-opacity-factor: 1.0; /* Full intensity */
    --theme-terminal-glow-size-factor: 1.0;    /* Full size */
}


body.theme-dim .hue-lcd-display.lcd--unlit .lcd-value {
    opacity: 0; 
}

body.theme-dim .actual-lcd-screen-element #terminal-lcd-content .terminal-line--initial-boot {
    /* The P1 line's text color will be inherited. Its glow is set by the flicker profile.
       Its autoAlpha (line opacity) is set to 1 by the flicker profile.
       The terminalManager ensures #terminal-lcd-content is visible for P1. */
}
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();function qe(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Ps(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.__proto__=e}/*!
 * GSAP 3.13.0
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var Ce={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},ai={duration:.5,overwrite:!1,delay:0},lr,se,$,ze=1e8,le=1/ze,wn=Math.PI*2,la=wn/4,ca=0,vs=Math.sqrt,da=Math.cos,ha=Math.sin,ie=function(e){return typeof e=="string"},W=function(e){return typeof e=="function"},tt=function(e){return typeof e=="number"},cr=function(e){return typeof e>"u"},Ye=function(e){return typeof e=="object"},ge=function(e){return e!==!1},dr=function(){return typeof window<"u"},Gi=function(e){return W(e)||ie(e)},Ns=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},ce=Array.isArray,Fn=/(?:-?\.?\d|\.)+/gi,Ls=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Jt=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Sn=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Os=/[+-]=-?[.\d]+/,bs=/[^,'"\[\]\s]+/gi,fa=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,V,Ue,Mn,hr,Ie={},Qi={},Rs,ws=function(e){return(Qi=ui(e,Ie))&&Se},fr=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},vi=function(e,t){return!t&&console.warn(e)},Fs=function(e,t){return e&&(Ie[e]=t)&&Qi&&(Qi[e]=t)||Ie},Ni=function(){return 0},pa={suppressEvents:!0,isStart:!0,kill:!1},Wi={suppressEvents:!0,kill:!1},_a={suppressEvents:!0},pr={},ht=[],xn={},Ms,Te={},Tn={},Yr=30,ji=[],_r="",gr=function(e){var t=e[0],i,n;if(Ye(t)||W(t)||(e=[e]),!(i=(t._gsap||{}).harness)){for(n=ji.length;n--&&!ji[n].targetTest(t););i=ji[n]}for(n=e.length;n--;)e[n]&&(e[n]._gsap||(e[n]._gsap=new so(e[n],i)))||e.splice(n,1);return e},bt=function(e){return e._gsap||gr(be(e))[0]._gsap},xs=function(e,t,i){return(i=e[t])&&W(i)?e[t]():cr(i)&&e.getAttribute&&e.getAttribute(t)||i},me=function(e,t){return(e=e.split(",")).forEach(t)||e},q=function(e){return Math.round(e*1e5)/1e5||0},Q=function(e){return Math.round(e*1e7)/1e7||0},ni=function(e,t){var i=t.charAt(0),n=parseFloat(t.substr(2));return e=parseFloat(e),i==="+"?e+n:i==="-"?e-n:i==="*"?e*n:e/n},ga=function(e,t){for(var i=t.length,n=0;e.indexOf(t[n])<0&&++n<i;);return n<i},Ji=function(){var e=ht.length,t=ht.slice(0),i,n;for(xn={},ht.length=0,i=0;i<e;i++)n=t[i],n&&n._lazy&&(n.render(n._lazy[0],n._lazy[1],!0)._lazy=0)},mr=function(e){return!!(e._initted||e._startAt||e.add)},Bs=function(e,t,i,n){ht.length&&!se&&Ji(),e.render(t,i,!!(se&&t<0&&mr(e))),ht.length&&!se&&Ji()},ks=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(bs).length<2?t:ie(e)?e.trim():e},Us=function(e){return e},Pe=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},ma=function(e){return function(t,i){for(var n in i)n in t||n==="duration"&&e||n==="ease"||(t[n]=i[n])}},ui=function(e,t){for(var i in t)e[i]=t[i];return e},Wr=function r(e,t){for(var i in t)i!=="__proto__"&&i!=="constructor"&&i!=="prototype"&&(e[i]=Ye(t[i])?r(e[i]||(e[i]={}),t[i]):t[i]);return e},Zi=function(e,t){var i={},n;for(n in e)n in t||(i[n]=e[n]);return i},Ai=function(e){var t=e.parent||V,i=e.keyframes?ma(ce(e.keyframes)):Pe;if(ge(e.inherit))for(;t;)i(e,t.vars.defaults),t=t.parent||t._dp;return e},Da=function(e,t){for(var i=e.length,n=i===t.length;n&&i--&&e[i]===t[i];);return i<0},Gs=function(e,t,i,n,s){var a=e[n],o;if(s)for(o=t[s];a&&a[s]>o;)a=a._prev;return a?(t._next=a._next,a._next=t):(t._next=e[i],e[i]=t),t._next?t._next._prev=t:e[n]=t,t._prev=a,t.parent=t._dp=e,t},fn=function(e,t,i,n){i===void 0&&(i="_first"),n===void 0&&(n="_last");var s=t._prev,a=t._next;s?s._next=a:e[i]===t&&(e[i]=a),a?a._prev=s:e[n]===t&&(e[n]=s),t._next=t._prev=t.parent=null},_t=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},Rt=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var i=e;i;)i._dirty=1,i=i.parent;return e},Ea=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},Bn=function(e,t,i,n){return e._startAt&&(se?e._startAt.revert(Wi):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,n))},Sa=function r(e){return!e||e._ts&&r(e.parent)},jr=function(e){return e._repeat?li(e._tTime,e=e.duration()+e._rDelay)*e:0},li=function(e,t){var i=Math.floor(e=Q(e/t));return e&&i===e?i-1:i},en=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},pn=function(e){return e._end=Q(e._start+(e._tDur/Math.abs(e._ts||e._rts||le)||0))},_n=function(e,t){var i=e._dp;return i&&i.smoothChildTiming&&e._ts&&(e._start=Q(i._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),pn(e),i._dirty||Rt(i,e)),e},Hs=function(e,t){var i;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(i=en(e.rawTime(),t),(!t._dur||Bi(0,t.totalDuration(),i)-t._tTime>le)&&t.render(i,!0)),Rt(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(i=e;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;e._zTime=-1e-8}},He=function(e,t,i,n){return t.parent&&_t(t),t._start=Q((tt(i)?i:i||e!==V?Le(e,i,t):e._time)+t._delay),t._end=Q(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),Gs(e,t,"_first","_last",e._sort?"_start":0),kn(t)||(e._recent=t),n||Hs(e,t),e._ts<0&&_n(e,e._tTime),e},$s=function(e,t){return(Ie.ScrollTrigger||fr("scrollTrigger",t))&&Ie.ScrollTrigger.create(t,e)},Vs=function(e,t,i,n,s){if(Er(e,t,s),!e._initted)return 1;if(!i&&e._pt&&!se&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&Ms!==ye.frame)return ht.push(e),e._lazy=[s,n],1},Ta=function r(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||r(t))},kn=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},ya=function(e,t,i,n){var s=e.ratio,a=t<0||!t&&(!e._start&&Ta(e)&&!(!e._initted&&kn(e))||(e._ts<0||e._dp._ts<0)&&!kn(e))?0:1,o=e._rDelay,u=0,l,c,d;if(o&&e._repeat&&(u=Bi(0,e._tDur,t),c=li(u,o),e._yoyo&&c&1&&(a=1-a),c!==li(e._tTime,o)&&(s=1-a,e.vars.repeatRefresh&&e._initted&&e.invalidate())),a!==s||se||n||e._zTime===le||!t&&e._zTime){if(!e._initted&&Vs(e,t,n,i,u))return;for(d=e._zTime,e._zTime=t||(i?le:0),i||(i=t&&!d),e.ratio=a,e._from&&(a=1-a),e._time=0,e._tTime=u,l=e._pt;l;)l.r(a,l.d),l=l._next;t<0&&Bn(e,t,i,!0),e._onUpdate&&!i&&Ae(e,"onUpdate"),u&&e._repeat&&!i&&e.parent&&Ae(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===a&&(a&&_t(e,1),!i&&!se&&(Ae(e,a?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},Aa=function(e,t,i){var n;if(i>t)for(n=e._first;n&&n._start<=i;){if(n.data==="isPause"&&n._start>t)return n;n=n._next}else for(n=e._last;n&&n._start>=i;){if(n.data==="isPause"&&n._start<t)return n;n=n._prev}},ci=function(e,t,i,n){var s=e._repeat,a=Q(t)||0,o=e._tTime/e._tDur;return o&&!n&&(e._time*=a/e._dur),e._dur=a,e._tDur=s?s<0?1e10:Q(a*(s+1)+e._rDelay*s):a,o>0&&!n&&_n(e,e._tTime=e._tDur*o),e.parent&&pn(e),i||Rt(e.parent,e),e},qr=function(e){return e instanceof fe?Rt(e):ci(e,e._dur)},Ca={_start:0,endTime:Ni,totalDuration:Ni},Le=function r(e,t,i){var n=e.labels,s=e._recent||Ca,a=e.duration()>=ze?s.endTime(!1):e._dur,o,u,l;return ie(t)&&(isNaN(t)||t in n)?(u=t.charAt(0),l=t.substr(-1)==="%",o=t.indexOf("="),u==="<"||u===">"?(o>=0&&(t=t.replace(/=/,"")),(u==="<"?s._start:s.endTime(s._repeat>=0))+(parseFloat(t.substr(1))||0)*(l?(o<0?s:i).totalDuration()/100:1)):o<0?(t in n||(n[t]=a),n[t]):(u=parseFloat(t.charAt(o-1)+t.substr(o+1)),l&&i&&(u=u/100*(ce(i)?i[0]:i).totalDuration()),o>1?r(e,t.substr(0,o-1),i)+u:a+u)):t==null?a:+t},Ci=function(e,t,i){var n=tt(t[1]),s=(n?2:1)+(e<2?0:1),a=t[s],o,u;if(n&&(a.duration=t[1]),a.parent=i,e){for(o=a,u=i;u&&!("immediateRender"in o);)o=u.vars.defaults||{},u=ge(u.vars.inherit)&&u.parent;a.immediateRender=ge(o.immediateRender),e<2?a.runBackwards=1:a.startAt=t[s-1]}return new K(t[0],a,t[s+1])},Et=function(e,t){return e||e===0?t(e):t},Bi=function(e,t,i){return i<e?e:i>t?t:i},ue=function(e,t){return!ie(e)||!(t=fa.exec(e))?"":t[1]},Ia=function(e,t,i){return Et(i,function(n){return Bi(e,t,n)})},Un=[].slice,zs=function(e,t){return e&&Ye(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&Ye(e[0]))&&!e.nodeType&&e!==Ue},Pa=function(e,t,i){return i===void 0&&(i=[]),e.forEach(function(n){var s;return ie(n)&&!t||zs(n,1)?(s=i).push.apply(s,be(n)):i.push(n)})||i},be=function(e,t,i){return $&&!t&&$.selector?$.selector(e):ie(e)&&!i&&(Mn||!di())?Un.call((t||hr).querySelectorAll(e),0):ce(e)?Pa(e,i):zs(e)?Un.call(e,0):e?[e]:[]},Gn=function(e){return e=be(e)[0]||vi("Invalid scope")||{},function(t){var i=e.current||e.nativeElement||e;return be(t,i.querySelectorAll?i:i===e?vi("Invalid scope")||hr.createElement("div"):e)}},Ys=function(e){return e.sort(function(){return .5-Math.random()})},Ws=function(e){if(W(e))return e;var t=Ye(e)?e:{each:e},i=wt(t.ease),n=t.from||0,s=parseFloat(t.base)||0,a={},o=n>0&&n<1,u=isNaN(n)||o,l=t.axis,c=n,d=n;return ie(n)?c=d={center:.5,edges:.5,end:1}[n]||0:!o&&u&&(c=n[0],d=n[1]),function(h,p,_){var f=(_||t).length,g=a[f],m,D,T,A,S,C,I,E,y;if(!g){if(y=t.grid==="auto"?0:(t.grid||[1,ze])[1],!y){for(I=-1e8;I<(I=_[y++].getBoundingClientRect().left)&&y<f;);y<f&&y--}for(g=a[f]=[],m=u?Math.min(y,f)*c-.5:n%y,D=y===ze?0:u?f*d/y-.5:n/y|0,I=0,E=ze,C=0;C<f;C++)T=C%y-m,A=D-(C/y|0),g[C]=S=l?Math.abs(l==="y"?A:T):vs(T*T+A*A),S>I&&(I=S),S<E&&(E=S);n==="random"&&Ys(g),g.max=I-E,g.min=E,g.v=f=(parseFloat(t.amount)||parseFloat(t.each)*(y>f?f-1:l?l==="y"?f/y:y:Math.max(y,f/y))||0)*(n==="edges"?-1:1),g.b=f<0?s-f:s,g.u=ue(t.amount||t.each)||0,i=i&&f<0?io(i):i}return f=(g[h]-g.min)/g.max||0,Q(g.b+(i?i(f):f)*g.v)+g.u}},Hn=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(i){var n=Q(Math.round(parseFloat(i)/e)*e*t);return(n-n%1)/t+(tt(i)?0:ue(i))}},js=function(e,t){var i=ce(e),n,s;return!i&&Ye(e)&&(n=i=e.radius||ze,e.values?(e=be(e.values),(s=!tt(e[0]))&&(n*=n)):e=Hn(e.increment)),Et(t,i?W(e)?function(a){return s=e(a),Math.abs(s-a)<=n?s:a}:function(a){for(var o=parseFloat(s?a.x:a),u=parseFloat(s?a.y:0),l=ze,c=0,d=e.length,h,p;d--;)s?(h=e[d].x-o,p=e[d].y-u,h=h*h+p*p):h=Math.abs(e[d]-o),h<l&&(l=h,c=d);return c=!n||l<=n?e[c]:a,s||c===a||tt(a)?c:c+ue(a)}:Hn(e))},qs=function(e,t,i,n){return Et(ce(e)?!t:i===!0?!!(i=0):!n,function(){return ce(e)?e[~~(Math.random()*e.length)]:(i=i||1e-5)&&(n=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((e-i/2+Math.random()*(t-e+i*.99))/i)*i*n)/n})},va=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(n){return t.reduce(function(s,a){return a(s)},n)}},Na=function(e,t){return function(i){return e(parseFloat(i))+(t||ue(i))}},La=function(e,t,i){return Ks(e,t,0,1,i)},Xs=function(e,t,i){return Et(i,function(n){return e[~~t(n)]})},Oa=function r(e,t,i){var n=t-e;return ce(e)?Xs(e,r(0,e.length),t):Et(i,function(s){return(n+(s-e)%n)%n+e})},ba=function r(e,t,i){var n=t-e,s=n*2;return ce(e)?Xs(e,r(0,e.length-1),t):Et(i,function(a){return a=(s+(a-e)%s)%s||0,e+(a>n?s-a:a)})},Li=function(e){for(var t=0,i="",n,s,a,o;~(n=e.indexOf("random(",t));)a=e.indexOf(")",n),o=e.charAt(n+7)==="[",s=e.substr(n+7,a-n-7).match(o?bs:Fn),i+=e.substr(t,n-t)+qs(o?s:+s[0],o?0:+s[1],+s[2]||1e-5),t=a+1;return i+e.substr(t,e.length-t)},Ks=function(e,t,i,n,s){var a=t-e,o=n-i;return Et(s,function(u){return i+((u-e)/a*o||0)})},Ra=function r(e,t,i,n){var s=isNaN(e+t)?0:function(p){return(1-p)*e+p*t};if(!s){var a=ie(e),o={},u,l,c,d,h;if(i===!0&&(n=1)&&(i=null),a)e={p:e},t={p:t};else if(ce(e)&&!ce(t)){for(c=[],d=e.length,h=d-2,l=1;l<d;l++)c.push(r(e[l-1],e[l]));d--,s=function(_){_*=d;var f=Math.min(h,~~_);return c[f](_-f)},i=t}else n||(e=ui(ce(e)?[]:{},e));if(!c){for(u in t)Dr.call(o,e,u,"get",t[u]);s=function(_){return yr(_,o)||(a?e.p:e)}}}return Et(i,s)},Xr=function(e,t,i){var n=e.labels,s=ze,a,o,u;for(a in n)o=n[a]-t,o<0==!!i&&o&&s>(o=Math.abs(o))&&(u=a,s=o);return u},Ae=function(e,t,i){var n=e.vars,s=n[t],a=$,o=e._ctx,u,l,c;if(s)return u=n[t+"Params"],l=n.callbackScope||e,i&&ht.length&&Ji(),o&&($=o),c=u?s.apply(l,u):s.call(l),$=a,c},Si=function(e){return _t(e),e.scrollTrigger&&e.scrollTrigger.kill(!!se),e.progress()<1&&Ae(e,"onInterrupt"),e},Zt,Qs=[],Js=function(e){if(e)if(e=!e.name&&e.default||e,dr()||e.headless){var t=e.name,i=W(e),n=t&&!i&&e.init?function(){this._props=[]}:e,s={init:Ni,render:yr,add:Dr,kill:qa,modifier:ja,rawVars:0},a={targetTest:0,get:0,getSetter:Tr,aliases:{},register:0};if(di(),e!==n){if(Te[t])return;Pe(n,Pe(Zi(e,s),a)),ui(n.prototype,ui(s,Zi(e,a))),Te[n.prop=t]=n,e.targetTest&&(ji.push(n),pr[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}Fs(t,n),e.register&&e.register(Se,n,De)}else Qs.push(e)},B=255,Ti={aqua:[0,B,B],lime:[0,B,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,B],navy:[0,0,128],white:[B,B,B],olive:[128,128,0],yellow:[B,B,0],orange:[B,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[B,0,0],pink:[B,192,203],cyan:[0,B,B],transparent:[B,B,B,0]},yn=function(e,t,i){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(i-t)*e*6:e<.5?i:e*3<2?t+(i-t)*(2/3-e)*6:t)*B+.5|0},Zs=function(e,t,i){var n=e?tt(e)?[e>>16,e>>8&B,e&B]:0:Ti.black,s,a,o,u,l,c,d,h,p,_;if(!n){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),Ti[e])n=Ti[e];else if(e.charAt(0)==="#"){if(e.length<6&&(s=e.charAt(1),a=e.charAt(2),o=e.charAt(3),e="#"+s+s+a+a+o+o+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return n=parseInt(e.substr(1,6),16),[n>>16,n>>8&B,n&B,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),n=[e>>16,e>>8&B,e&B]}else if(e.substr(0,3)==="hsl"){if(n=_=e.match(Fn),!t)u=+n[0]%360/360,l=+n[1]/100,c=+n[2]/100,a=c<=.5?c*(l+1):c+l-c*l,s=c*2-a,n.length>3&&(n[3]*=1),n[0]=yn(u+1/3,s,a),n[1]=yn(u,s,a),n[2]=yn(u-1/3,s,a);else if(~e.indexOf("="))return n=e.match(Ls),i&&n.length<4&&(n[3]=1),n}else n=e.match(Fn)||Ti.transparent;n=n.map(Number)}return t&&!_&&(s=n[0]/B,a=n[1]/B,o=n[2]/B,d=Math.max(s,a,o),h=Math.min(s,a,o),c=(d+h)/2,d===h?u=l=0:(p=d-h,l=c>.5?p/(2-d-h):p/(d+h),u=d===s?(a-o)/p+(a<o?6:0):d===a?(o-s)/p+2:(s-a)/p+4,u*=60),n[0]=~~(u+.5),n[1]=~~(l*100+.5),n[2]=~~(c*100+.5)),i&&n.length<4&&(n[3]=1),n},eo=function(e){var t=[],i=[],n=-1;return e.split(ft).forEach(function(s){var a=s.match(Jt)||[];t.push.apply(t,a),i.push(n+=a.length+1)}),t.c=i,t},Kr=function(e,t,i){var n="",s=(e+n).match(ft),a=t?"hsla(":"rgba(",o=0,u,l,c,d;if(!s)return e;if(s=s.map(function(h){return(h=Zs(h,t,1))&&a+(t?h[0]+","+h[1]+"%,"+h[2]+"%,"+h[3]:h.join(","))+")"}),i&&(c=eo(e),u=i.c,u.join(n)!==c.c.join(n)))for(l=e.replace(ft,"1").split(Jt),d=l.length-1;o<d;o++)n+=l[o]+(~u.indexOf(o)?s.shift()||a+"0,0,0,0)":(c.length?c:s.length?s:i).shift());if(!l)for(l=e.split(ft),d=l.length-1;o<d;o++)n+=l[o]+s[o];return n+l[d]},ft=function(){var r="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in Ti)r+="|"+e+"\\b";return new RegExp(r+")","gi")}(),wa=/hsl[a]?\(/,to=function(e){var t=e.join(" "),i;if(ft.lastIndex=0,ft.test(t))return i=wa.test(t),e[1]=Kr(e[1],i),e[0]=Kr(e[0],i,eo(e[1])),!0},Oi,ye=function(){var r=Date.now,e=500,t=33,i=r(),n=i,s=1e3/240,a=s,o=[],u,l,c,d,h,p,_=function f(g){var m=r()-n,D=g===!0,T,A,S,C;if((m>e||m<0)&&(i+=m-t),n+=m,S=n-i,T=S-a,(T>0||D)&&(C=++d.frame,h=S-d.time*1e3,d.time=S=S/1e3,a+=T+(T>=s?4:s-T),A=1),D||(u=l(f)),A)for(p=0;p<o.length;p++)o[p](S,h,C,g)};return d={time:0,frame:0,tick:function(){_(!0)},deltaRatio:function(g){return h/(1e3/(g||60))},wake:function(){Rs&&(!Mn&&dr()&&(Ue=Mn=window,hr=Ue.document||{},Ie.gsap=Se,(Ue.gsapVersions||(Ue.gsapVersions=[])).push(Se.version),ws(Qi||Ue.GreenSockGlobals||!Ue.gsap&&Ue||{}),Qs.forEach(Js)),c=typeof requestAnimationFrame<"u"&&requestAnimationFrame,u&&d.sleep(),l=c||function(g){return setTimeout(g,a-d.time*1e3+1|0)},Oi=1,_(2))},sleep:function(){(c?cancelAnimationFrame:clearTimeout)(u),Oi=0,l=Ni},lagSmoothing:function(g,m){e=g||1/0,t=Math.min(m||33,e)},fps:function(g){s=1e3/(g||240),a=d.time*1e3+s},add:function(g,m,D){var T=m?function(A,S,C,I){g(A,S,C,I),d.remove(T)}:g;return d.remove(g),o[D?"unshift":"push"](T),di(),T},remove:function(g,m){~(m=o.indexOf(g))&&o.splice(m,1)&&p>=m&&p--},_listeners:o},d}(),di=function(){return!Oi&&ye.wake()},R={},Fa=/^[\d.\-M][\d.\-,\s]/,Ma=/["']/g,xa=function(e){for(var t={},i=e.substr(1,e.length-3).split(":"),n=i[0],s=1,a=i.length,o,u,l;s<a;s++)u=i[s],o=s!==a-1?u.lastIndexOf(","):u.length,l=u.substr(0,o),t[n]=isNaN(l)?l.replace(Ma,"").trim():+l,n=u.substr(o+1).trim();return t},Ba=function(e){var t=e.indexOf("(")+1,i=e.indexOf(")"),n=e.indexOf("(",t);return e.substring(t,~n&&n<i?e.indexOf(")",i+1):i)},ka=function(e){var t=(e+"").split("("),i=R[t[0]];return i&&t.length>1&&i.config?i.config.apply(null,~e.indexOf("{")?[xa(t[1])]:Ba(e).split(",").map(ks)):R._CE&&Fa.test(e)?R._CE("",e):i},io=function(e){return function(t){return 1-e(1-t)}},no=function r(e,t){for(var i=e._first,n;i;)i instanceof fe?r(i,t):i.vars.yoyoEase&&(!i._yoyo||!i._repeat)&&i._yoyo!==t&&(i.timeline?r(i.timeline,t):(n=i._ease,i._ease=i._yEase,i._yEase=n,i._yoyo=t)),i=i._next},wt=function(e,t){return e&&(W(e)?e:R[e]||ka(e))||t},Ht=function(e,t,i,n){i===void 0&&(i=function(u){return 1-t(1-u)}),n===void 0&&(n=function(u){return u<.5?t(u*2)/2:1-t((1-u)*2)/2});var s={easeIn:t,easeOut:i,easeInOut:n},a;return me(e,function(o){R[o]=Ie[o]=s,R[a=o.toLowerCase()]=i;for(var u in s)R[a+(u==="easeIn"?".in":u==="easeOut"?".out":".inOut")]=R[o+"."+u]=s[u]}),s},ro=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},An=function r(e,t,i){var n=t>=1?t:1,s=(i||(e?.3:.45))/(t<1?t:1),a=s/wn*(Math.asin(1/n)||0),o=function(c){return c===1?1:n*Math.pow(2,-10*c)*ha((c-a)*s)+1},u=e==="out"?o:e==="in"?function(l){return 1-o(1-l)}:ro(o);return s=wn/s,u.config=function(l,c){return r(e,l,c)},u},Cn=function r(e,t){t===void 0&&(t=1.70158);var i=function(a){return a?--a*a*((t+1)*a+t)+1:0},n=e==="out"?i:e==="in"?function(s){return 1-i(1-s)}:ro(i);return n.config=function(s){return r(e,s)},n};me("Linear,Quad,Cubic,Quart,Quint,Strong",function(r,e){var t=e<5?e+1:e;Ht(r+",Power"+(t-1),e?function(i){return Math.pow(i,t)}:function(i){return i},function(i){return 1-Math.pow(1-i,t)},function(i){return i<.5?Math.pow(i*2,t)/2:1-Math.pow((1-i)*2,t)/2})});R.Linear.easeNone=R.none=R.Linear.easeIn;Ht("Elastic",An("in"),An("out"),An());(function(r,e){var t=1/e,i=2*t,n=2.5*t,s=function(o){return o<t?r*o*o:o<i?r*Math.pow(o-1.5/e,2)+.75:o<n?r*(o-=2.25/e)*o+.9375:r*Math.pow(o-2.625/e,2)+.984375};Ht("Bounce",function(a){return 1-s(1-a)},s)})(7.5625,2.75);Ht("Expo",function(r){return Math.pow(2,10*(r-1))*r+r*r*r*r*r*r*(1-r)});Ht("Circ",function(r){return-(vs(1-r*r)-1)});Ht("Sine",function(r){return r===1?1:-da(r*la)+1});Ht("Back",Cn("in"),Cn("out"),Cn());R.SteppedEase=R.steps=Ie.SteppedEase={config:function(e,t){e===void 0&&(e=1);var i=1/e,n=e+(t?0:1),s=t?1:0,a=1-le;return function(o){return((n*Bi(0,a,o)|0)+s)*i}}};ai.ease=R["quad.out"];me("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(r){return _r+=r+","+r+"Params,"});var so=function(e,t){this.id=ca++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:xs,this.set=t?t.getSetter:Tr},bi=function(){function r(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,ci(this,+t.duration,1,1),this.data=t.data,$&&(this._ctx=$,$.data.push(this)),Oi||ye.wake()}var e=r.prototype;return e.delay=function(i){return i||i===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+i-this._delay),this._delay=i,this):this._delay},e.duration=function(i){return arguments.length?this.totalDuration(this._repeat>0?i+(i+this._rDelay)*this._repeat:i):this.totalDuration()&&this._dur},e.totalDuration=function(i){return arguments.length?(this._dirty=0,ci(this,this._repeat<0?i:(i-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(i,n){if(di(),!arguments.length)return this._tTime;var s=this._dp;if(s&&s.smoothChildTiming&&this._ts){for(_n(this,i),!s._dp||s.parent||Hs(s,this);s&&s.parent;)s.parent._time!==s._start+(s._ts>=0?s._tTime/s._ts:(s.totalDuration()-s._tTime)/-s._ts)&&s.totalTime(s._tTime,!0),s=s.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&i<this._tDur||this._ts<0&&i>0||!this._tDur&&!i)&&He(this._dp,this,this._start-this._delay)}return(this._tTime!==i||!this._dur&&!n||this._initted&&Math.abs(this._zTime)===le||!i&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=i),Bs(this,i,n)),this},e.time=function(i,n){return arguments.length?this.totalTime(Math.min(this.totalDuration(),i+jr(this))%(this._dur+this._rDelay)||(i?this._dur:0),n):this._time},e.totalProgress=function(i,n){return arguments.length?this.totalTime(this.totalDuration()*i,n):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},e.progress=function(i,n){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-i:i)+jr(this),n):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(i,n){var s=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(i-1)*s,n):this._repeat?li(this._tTime,s)+1:1},e.timeScale=function(i,n){if(!arguments.length)return this._rts===-1e-8?0:this._rts;if(this._rts===i)return this;var s=this.parent&&this._ts?en(this.parent._time,this):this._tTime;return this._rts=+i||0,this._ts=this._ps||i===-1e-8?0:this._rts,this.totalTime(Bi(-Math.abs(this._delay),this.totalDuration(),s),n!==!1),pn(this),Ea(this)},e.paused=function(i){return arguments.length?(this._ps!==i&&(this._ps=i,i?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(di(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==le&&(this._tTime-=le)))),this):this._ps},e.startTime=function(i){if(arguments.length){this._start=i;var n=this.parent||this._dp;return n&&(n._sort||!this.parent)&&He(n,this,i-this._delay),this}return this._start},e.endTime=function(i){return this._start+(ge(i)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(i){var n=this.parent||this._dp;return n?i&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?en(n.rawTime(i),this):this._tTime:this._tTime},e.revert=function(i){i===void 0&&(i=_a);var n=se;return se=i,mr(this)&&(this.timeline&&this.timeline.revert(i),this.totalTime(-.01,i.suppressEvents)),this.data!=="nested"&&i.kill!==!1&&this.kill(),se=n,this},e.globalTime=function(i){for(var n=this,s=arguments.length?i:n.rawTime();n;)s=n._start+s/(Math.abs(n._ts)||1),n=n._dp;return!this.parent&&this._sat?this._sat.globalTime(i):s},e.repeat=function(i){return arguments.length?(this._repeat=i===1/0?-2:i,qr(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(i){if(arguments.length){var n=this._time;return this._rDelay=i,qr(this),n?this.time(n):this}return this._rDelay},e.yoyo=function(i){return arguments.length?(this._yoyo=i,this):this._yoyo},e.seek=function(i,n){return this.totalTime(Le(this,i),ge(n))},e.restart=function(i,n){return this.play().totalTime(i?-this._delay:0,ge(n)),this._dur||(this._zTime=-1e-8),this},e.play=function(i,n){return i!=null&&this.seek(i,n),this.reversed(!1).paused(!1)},e.reverse=function(i,n){return i!=null&&this.seek(i||this.totalDuration(),n),this.reversed(!0).paused(!1)},e.pause=function(i,n){return i!=null&&this.seek(i,n),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(i){return arguments.length?(!!i!==this.reversed()&&this.timeScale(-this._rts||(i?-1e-8:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},e.isActive=function(){var i=this.parent||this._dp,n=this._start,s;return!!(!i||this._ts&&this._initted&&i.isActive()&&(s=i.rawTime(!0))>=n&&s<this.endTime(!0)-le)},e.eventCallback=function(i,n,s){var a=this.vars;return arguments.length>1?(n?(a[i]=n,s&&(a[i+"Params"]=s),i==="onUpdate"&&(this._onUpdate=n)):delete a[i],this):a[i]},e.then=function(i){var n=this;return new Promise(function(s){var a=W(i)?i:Us,o=function(){var l=n.then;n.then=null,W(a)&&(a=a(n))&&(a.then||a===n)&&(n.then=l),s(a),n.then=l};n._initted&&n.totalProgress()===1&&n._ts>=0||!n._tTime&&n._ts<0?o():n._prom=o})},e.kill=function(){Si(this)},r}();Pe(bi.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var fe=function(r){Ps(e,r);function e(i,n){var s;return i===void 0&&(i={}),s=r.call(this,i)||this,s.labels={},s.smoothChildTiming=!!i.smoothChildTiming,s.autoRemoveChildren=!!i.autoRemoveChildren,s._sort=ge(i.sortChildren),V&&He(i.parent||V,qe(s),n),i.reversed&&s.reverse(),i.paused&&s.paused(!0),i.scrollTrigger&&$s(qe(s),i.scrollTrigger),s}var t=e.prototype;return t.to=function(n,s,a){return Ci(0,arguments,this),this},t.from=function(n,s,a){return Ci(1,arguments,this),this},t.fromTo=function(n,s,a,o){return Ci(2,arguments,this),this},t.set=function(n,s,a){return s.duration=0,s.parent=this,Ai(s).repeatDelay||(s.repeat=0),s.immediateRender=!!s.immediateRender,new K(n,s,Le(this,a),1),this},t.call=function(n,s,a){return He(this,K.delayedCall(0,n,s),a)},t.staggerTo=function(n,s,a,o,u,l,c){return a.duration=s,a.stagger=a.stagger||o,a.onComplete=l,a.onCompleteParams=c,a.parent=this,new K(n,a,Le(this,u)),this},t.staggerFrom=function(n,s,a,o,u,l,c){return a.runBackwards=1,Ai(a).immediateRender=ge(a.immediateRender),this.staggerTo(n,s,a,o,u,l,c)},t.staggerFromTo=function(n,s,a,o,u,l,c,d){return o.startAt=a,Ai(o).immediateRender=ge(o.immediateRender),this.staggerTo(n,s,o,u,l,c,d)},t.render=function(n,s,a){var o=this._time,u=this._dirty?this.totalDuration():this._tDur,l=this._dur,c=n<=0?0:Q(n),d=this._zTime<0!=n<0&&(this._initted||!l),h,p,_,f,g,m,D,T,A,S,C,I;if(this!==V&&c>u&&n>=0&&(c=u),c!==this._tTime||a||d){if(o!==this._time&&l&&(c+=this._time-o,n+=this._time-o),h=c,A=this._start,T=this._ts,m=!T,d&&(l||(o=this._zTime),(n||!s)&&(this._zTime=n)),this._repeat){if(C=this._yoyo,g=l+this._rDelay,this._repeat<-1&&n<0)return this.totalTime(g*100+n,s,a);if(h=Q(c%g),c===u?(f=this._repeat,h=l):(S=Q(c/g),f=~~S,f&&f===S&&(h=l,f--),h>l&&(h=l)),S=li(this._tTime,g),!o&&this._tTime&&S!==f&&this._tTime-S*g-this._dur<=0&&(S=f),C&&f&1&&(h=l-h,I=1),f!==S&&!this._lock){var E=C&&S&1,y=E===(C&&f&1);if(f<S&&(E=!E),o=E?0:c%l?l:c,this._lock=1,this.render(o||(I?0:Q(f*g)),s,!l)._lock=0,this._tTime=c,!s&&this.parent&&Ae(this,"onRepeat"),this.vars.repeatRefresh&&!I&&(this.invalidate()._lock=1),o&&o!==this._time||m!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(l=this._dur,u=this._tDur,y&&(this._lock=2,o=E?l:-1e-4,this.render(o,!0),this.vars.repeatRefresh&&!I&&this.invalidate()),this._lock=0,!this._ts&&!m)return this;no(this,I)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(D=Aa(this,Q(o),Q(h)),D&&(c-=h-(h=D._start))),this._tTime=c,this._time=h,this._act=!T,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=n,o=0),!o&&c&&!s&&!S&&(Ae(this,"onStart"),this._tTime!==c))return this;if(h>=o&&n>=0)for(p=this._first;p;){if(_=p._next,(p._act||h>=p._start)&&p._ts&&D!==p){if(p.parent!==this)return this.render(n,s,a);if(p.render(p._ts>0?(h-p._start)*p._ts:(p._dirty?p.totalDuration():p._tDur)+(h-p._start)*p._ts,s,a),h!==this._time||!this._ts&&!m){D=0,_&&(c+=this._zTime=-1e-8);break}}p=_}else{p=this._last;for(var N=n<0?n:h;p;){if(_=p._prev,(p._act||N<=p._end)&&p._ts&&D!==p){if(p.parent!==this)return this.render(n,s,a);if(p.render(p._ts>0?(N-p._start)*p._ts:(p._dirty?p.totalDuration():p._tDur)+(N-p._start)*p._ts,s,a||se&&mr(p)),h!==this._time||!this._ts&&!m){D=0,_&&(c+=this._zTime=N?-1e-8:le);break}}p=_}}if(D&&!s&&(this.pause(),D.render(h>=o?0:-1e-8)._zTime=h>=o?1:-1,this._ts))return this._start=A,pn(this),this.render(n,s,a);this._onUpdate&&!s&&Ae(this,"onUpdate",!0),(c===u&&this._tTime>=this.totalDuration()||!c&&o)&&(A===this._start||Math.abs(T)!==Math.abs(this._ts))&&(this._lock||((n||!l)&&(c===u&&this._ts>0||!c&&this._ts<0)&&_t(this,1),!s&&!(n<0&&!o)&&(c||o||!u)&&(Ae(this,c===u&&n>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(c<u&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(n,s){var a=this;if(tt(s)||(s=Le(this,s,n)),!(n instanceof bi)){if(ce(n))return n.forEach(function(o){return a.add(o,s)}),this;if(ie(n))return this.addLabel(n,s);if(W(n))n=K.delayedCall(0,n);else return this}return this!==n?He(this,n,s):this},t.getChildren=function(n,s,a,o){n===void 0&&(n=!0),s===void 0&&(s=!0),a===void 0&&(a=!0),o===void 0&&(o=-1e8);for(var u=[],l=this._first;l;)l._start>=o&&(l instanceof K?s&&u.push(l):(a&&u.push(l),n&&u.push.apply(u,l.getChildren(!0,s,a)))),l=l._next;return u},t.getById=function(n){for(var s=this.getChildren(1,1,1),a=s.length;a--;)if(s[a].vars.id===n)return s[a]},t.remove=function(n){return ie(n)?this.removeLabel(n):W(n)?this.killTweensOf(n):(n.parent===this&&fn(this,n),n===this._recent&&(this._recent=this._last),Rt(this))},t.totalTime=function(n,s){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Q(ye.time-(this._ts>0?n/this._ts:(this.totalDuration()-n)/-this._ts))),r.prototype.totalTime.call(this,n,s),this._forcing=0,this):this._tTime},t.addLabel=function(n,s){return this.labels[n]=Le(this,s),this},t.removeLabel=function(n){return delete this.labels[n],this},t.addPause=function(n,s,a){var o=K.delayedCall(0,s||Ni,a);return o.data="isPause",this._hasPause=1,He(this,o,Le(this,n))},t.removePause=function(n){var s=this._first;for(n=Le(this,n);s;)s._start===n&&s.data==="isPause"&&_t(s),s=s._next},t.killTweensOf=function(n,s,a){for(var o=this.getTweensOf(n,a),u=o.length;u--;)ut!==o[u]&&o[u].kill(n,s);return this},t.getTweensOf=function(n,s){for(var a=[],o=be(n),u=this._first,l=tt(s),c;u;)u instanceof K?ga(u._targets,o)&&(l?(!ut||u._initted&&u._ts)&&u.globalTime(0)<=s&&u.globalTime(u.totalDuration())>s:!s||u.isActive())&&a.push(u):(c=u.getTweensOf(o,s)).length&&a.push.apply(a,c),u=u._next;return a},t.tweenTo=function(n,s){s=s||{};var a=this,o=Le(a,n),u=s,l=u.startAt,c=u.onStart,d=u.onStartParams,h=u.immediateRender,p,_=K.to(a,Pe({ease:s.ease||"none",lazy:!1,immediateRender:!1,time:o,overwrite:"auto",duration:s.duration||Math.abs((o-(l&&"time"in l?l.time:a._time))/a.timeScale())||le,onStart:function(){if(a.pause(),!p){var g=s.duration||Math.abs((o-(l&&"time"in l?l.time:a._time))/a.timeScale());_._dur!==g&&ci(_,g,0,1).render(_._time,!0,!0),p=1}c&&c.apply(_,d||[])}},s));return h?_.render(0):_},t.tweenFromTo=function(n,s,a){return this.tweenTo(s,Pe({startAt:{time:Le(this,n)}},a))},t.recent=function(){return this._recent},t.nextLabel=function(n){return n===void 0&&(n=this._time),Xr(this,Le(this,n))},t.previousLabel=function(n){return n===void 0&&(n=this._time),Xr(this,Le(this,n),1)},t.currentLabel=function(n){return arguments.length?this.seek(n,!0):this.previousLabel(this._time+le)},t.shiftChildren=function(n,s,a){a===void 0&&(a=0);for(var o=this._first,u=this.labels,l;o;)o._start>=a&&(o._start+=n,o._end+=n),o=o._next;if(s)for(l in u)u[l]>=a&&(u[l]+=n);return Rt(this)},t.invalidate=function(n){var s=this._first;for(this._lock=0;s;)s.invalidate(n),s=s._next;return r.prototype.invalidate.call(this,n)},t.clear=function(n){n===void 0&&(n=!0);for(var s=this._first,a;s;)a=s._next,this.remove(s),s=a;return this._dp&&(this._time=this._tTime=this._pTime=0),n&&(this.labels={}),Rt(this)},t.totalDuration=function(n){var s=0,a=this,o=a._last,u=ze,l,c,d;if(arguments.length)return a.timeScale((a._repeat<0?a.duration():a.totalDuration())/(a.reversed()?-n:n));if(a._dirty){for(d=a.parent;o;)l=o._prev,o._dirty&&o.totalDuration(),c=o._start,c>u&&a._sort&&o._ts&&!a._lock?(a._lock=1,He(a,o,c-o._delay,1)._lock=0):u=c,c<0&&o._ts&&(s-=c,(!d&&!a._dp||d&&d.smoothChildTiming)&&(a._start+=c/a._ts,a._time-=c,a._tTime-=c),a.shiftChildren(-c,!1,-1/0),u=0),o._end>s&&o._ts&&(s=o._end),o=l;ci(a,a===V&&a._time>s?a._time:s,1,1),a._dirty=0}return a._tDur},e.updateRoot=function(n){if(V._ts&&(Bs(V,en(n,V)),Ms=ye.frame),ye.frame>=Yr){Yr+=Ce.autoSleep||120;var s=V._first;if((!s||!s._ts)&&Ce.autoSleep&&ye._listeners.length<2){for(;s&&!s._ts;)s=s._next;s||ye.sleep()}}},e}(bi);Pe(fe.prototype,{_lock:0,_hasPause:0,_forcing:0});var Ua=function(e,t,i,n,s,a,o){var u=new De(this._pt,e,t,0,1,ho,null,s),l=0,c=0,d,h,p,_,f,g,m,D;for(u.b=i,u.e=n,i+="",n+="",(m=~n.indexOf("random("))&&(n=Li(n)),a&&(D=[i,n],a(D,e,t),i=D[0],n=D[1]),h=i.match(Sn)||[];d=Sn.exec(n);)_=d[0],f=n.substring(l,d.index),p?p=(p+1)%5:f.substr(-5)==="rgba("&&(p=1),_!==h[c++]&&(g=parseFloat(h[c-1])||0,u._pt={_next:u._pt,p:f||c===1?f:",",s:g,c:_.charAt(1)==="="?ni(g,_)-g:parseFloat(_)-g,m:p&&p<4?Math.round:0},l=Sn.lastIndex);return u.c=l<n.length?n.substring(l,n.length):"",u.fp=o,(Os.test(n)||m)&&(u.e=0),this._pt=u,u},Dr=function(e,t,i,n,s,a,o,u,l,c){W(n)&&(n=n(s||0,e,a));var d=e[t],h=i!=="get"?i:W(d)?l?e[t.indexOf("set")||!W(e["get"+t.substr(3)])?t:"get"+t.substr(3)](l):e[t]():d,p=W(d)?l?za:lo:Sr,_;if(ie(n)&&(~n.indexOf("random(")&&(n=Li(n)),n.charAt(1)==="="&&(_=ni(h,n)+(ue(h)||0),(_||_===0)&&(n=_))),!c||h!==n||$n)return!isNaN(h*n)&&n!==""?(_=new De(this._pt,e,t,+h||0,n-(h||0),typeof d=="boolean"?Wa:co,0,p),l&&(_.fp=l),o&&_.modifier(o,this,e),this._pt=_):(!d&&!(t in e)&&fr(t,n),Ua.call(this,e,t,h,n,p,u||Ce.stringFilter,l))},Ga=function(e,t,i,n,s){if(W(e)&&(e=Ii(e,s,t,i,n)),!Ye(e)||e.style&&e.nodeType||ce(e)||Ns(e))return ie(e)?Ii(e,s,t,i,n):e;var a={},o;for(o in e)a[o]=Ii(e[o],s,t,i,n);return a},oo=function(e,t,i,n,s,a){var o,u,l,c;if(Te[e]&&(o=new Te[e]).init(s,o.rawVars?t[e]:Ga(t[e],n,s,a,i),i,n,a)!==!1&&(i._pt=u=new De(i._pt,s,e,0,1,o.render,o,0,o.priority),i!==Zt))for(l=i._ptLookup[i._targets.indexOf(s)],c=o._props.length;c--;)l[o._props[c]]=u;return o},ut,$n,Er=function r(e,t,i){var n=e.vars,s=n.ease,a=n.startAt,o=n.immediateRender,u=n.lazy,l=n.onUpdate,c=n.runBackwards,d=n.yoyoEase,h=n.keyframes,p=n.autoRevert,_=e._dur,f=e._startAt,g=e._targets,m=e.parent,D=m&&m.data==="nested"?m.vars.targets:g,T=e._overwrite==="auto"&&!lr,A=e.timeline,S,C,I,E,y,N,w,F,M,X,k,Y,U;if(A&&(!h||!s)&&(s="none"),e._ease=wt(s,ai.ease),e._yEase=d?io(wt(d===!0?s:d,ai.ease)):0,d&&e._yoyo&&!e._repeat&&(d=e._yEase,e._yEase=e._ease,e._ease=d),e._from=!A&&!!n.runBackwards,!A||h&&!n.stagger){if(F=g[0]?bt(g[0]).harness:0,Y=F&&n[F.prop],S=Zi(n,pr),f&&(f._zTime<0&&f.progress(1),t<0&&c&&o&&!p?f.render(-1,!0):f.revert(c&&_?Wi:pa),f._lazy=0),a){if(_t(e._startAt=K.set(g,Pe({data:"isStart",overwrite:!1,parent:m,immediateRender:!0,lazy:!f&&ge(u),startAt:null,delay:0,onUpdate:l&&function(){return Ae(e,"onUpdate")},stagger:0},a))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(se||!o&&!p)&&e._startAt.revert(Wi),o&&_&&t<=0&&i<=0){t&&(e._zTime=t);return}}else if(c&&_&&!f){if(t&&(o=!1),I=Pe({overwrite:!1,data:"isFromStart",lazy:o&&!f&&ge(u),immediateRender:o,stagger:0,parent:m},S),Y&&(I[F.prop]=Y),_t(e._startAt=K.set(g,I)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(se?e._startAt.revert(Wi):e._startAt.render(-1,!0)),e._zTime=t,!o)r(e._startAt,le,le);else if(!t)return}for(e._pt=e._ptCache=0,u=_&&ge(u)||u&&!_,C=0;C<g.length;C++){if(y=g[C],w=y._gsap||gr(g)[C]._gsap,e._ptLookup[C]=X={},xn[w.id]&&ht.length&&Ji(),k=D===g?C:D.indexOf(y),F&&(M=new F).init(y,Y||S,e,k,D)!==!1&&(e._pt=E=new De(e._pt,y,M.name,0,1,M.render,M,0,M.priority),M._props.forEach(function(de){X[de]=E}),M.priority&&(N=1)),!F||Y)for(I in S)Te[I]&&(M=oo(I,S,e,k,y,D))?M.priority&&(N=1):X[I]=E=Dr.call(e,y,I,"get",S[I],k,D,0,n.stringFilter);e._op&&e._op[C]&&e.kill(y,e._op[C]),T&&e._pt&&(ut=e,V.killTweensOf(y,X,e.globalTime(t)),U=!e.parent,ut=0),e._pt&&u&&(xn[w.id]=1)}N&&fo(e),e._onInit&&e._onInit(e)}e._onUpdate=l,e._initted=(!e._op||e._pt)&&!U,h&&t<=0&&A.render(ze,!0,!0)},Ha=function(e,t,i,n,s,a,o,u){var l=(e._pt&&e._ptCache||(e._ptCache={}))[t],c,d,h,p;if(!l)for(l=e._ptCache[t]=[],h=e._ptLookup,p=e._targets.length;p--;){if(c=h[p][t],c&&c.d&&c.d._pt)for(c=c.d._pt;c&&c.p!==t&&c.fp!==t;)c=c._next;if(!c)return $n=1,e.vars[t]="+=0",Er(e,o),$n=0,u?vi(t+" not eligible for reset"):1;l.push(c)}for(p=l.length;p--;)d=l[p],c=d._pt||d,c.s=(n||n===0)&&!s?n:c.s+(n||0)+a*c.c,c.c=i-c.s,d.e&&(d.e=q(i)+ue(d.e)),d.b&&(d.b=c.s+ue(d.b))},$a=function(e,t){var i=e[0]?bt(e[0]).harness:0,n=i&&i.aliases,s,a,o,u;if(!n)return t;s=ui({},t);for(a in n)if(a in s)for(u=n[a].split(","),o=u.length;o--;)s[u[o]]=s[a];return s},Va=function(e,t,i,n){var s=t.ease||n||"power1.inOut",a,o;if(ce(t))o=i[e]||(i[e]=[]),t.forEach(function(u,l){return o.push({t:l/(t.length-1)*100,v:u,e:s})});else for(a in t)o=i[a]||(i[a]=[]),a==="ease"||o.push({t:parseFloat(e),v:t[a],e:s})},Ii=function(e,t,i,n,s){return W(e)?e.call(t,i,n,s):ie(e)&&~e.indexOf("random(")?Li(e):e},ao=_r+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",uo={};me(ao+",id,stagger,delay,duration,paused,scrollTrigger",function(r){return uo[r]=1});var K=function(r){Ps(e,r);function e(i,n,s,a){var o;typeof n=="number"&&(s.duration=n,n=s,s=null),o=r.call(this,a?n:Ai(n))||this;var u=o.vars,l=u.duration,c=u.delay,d=u.immediateRender,h=u.stagger,p=u.overwrite,_=u.keyframes,f=u.defaults,g=u.scrollTrigger,m=u.yoyoEase,D=n.parent||V,T=(ce(i)||Ns(i)?tt(i[0]):"length"in n)?[i]:be(i),A,S,C,I,E,y,N,w;if(o._targets=T.length?gr(T):vi("GSAP target "+i+" not found. https://gsap.com",!Ce.nullTargetWarn)||[],o._ptLookup=[],o._overwrite=p,_||h||Gi(l)||Gi(c)){if(n=o.vars,A=o.timeline=new fe({data:"nested",defaults:f||{},targets:D&&D.data==="nested"?D.vars.targets:T}),A.kill(),A.parent=A._dp=qe(o),A._start=0,h||Gi(l)||Gi(c)){if(I=T.length,N=h&&Ws(h),Ye(h))for(E in h)~ao.indexOf(E)&&(w||(w={}),w[E]=h[E]);for(S=0;S<I;S++)C=Zi(n,uo),C.stagger=0,m&&(C.yoyoEase=m),w&&ui(C,w),y=T[S],C.duration=+Ii(l,qe(o),S,y,T),C.delay=(+Ii(c,qe(o),S,y,T)||0)-o._delay,!h&&I===1&&C.delay&&(o._delay=c=C.delay,o._start+=c,C.delay=0),A.to(y,C,N?N(S,y,T):0),A._ease=R.none;A.duration()?l=c=0:o.timeline=0}else if(_){Ai(Pe(A.vars.defaults,{ease:"none"})),A._ease=wt(_.ease||n.ease||"none");var F=0,M,X,k;if(ce(_))_.forEach(function(Y){return A.to(T,Y,">")}),A.duration();else{C={};for(E in _)E==="ease"||E==="easeEach"||Va(E,_[E],C,_.easeEach);for(E in C)for(M=C[E].sort(function(Y,U){return Y.t-U.t}),F=0,S=0;S<M.length;S++)X=M[S],k={ease:X.e,duration:(X.t-(S?M[S-1].t:0))/100*l},k[E]=X.v,A.to(T,k,F),F+=k.duration;A.duration()<l&&A.to({},{duration:l-A.duration()})}}l||o.duration(l=A.duration())}else o.timeline=0;return p===!0&&!lr&&(ut=qe(o),V.killTweensOf(T),ut=0),He(D,qe(o),s),n.reversed&&o.reverse(),n.paused&&o.paused(!0),(d||!l&&!_&&o._start===Q(D._time)&&ge(d)&&Sa(qe(o))&&D.data!=="nested")&&(o._tTime=-1e-8,o.render(Math.max(0,-c)||0)),g&&$s(qe(o),g),o}var t=e.prototype;return t.render=function(n,s,a){var o=this._time,u=this._tDur,l=this._dur,c=n<0,d=n>u-le&&!c?u:n<le?0:n,h,p,_,f,g,m,D,T,A;if(!l)ya(this,n,s,a);else if(d!==this._tTime||!n||a||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==c||this._lazy){if(h=d,T=this.timeline,this._repeat){if(f=l+this._rDelay,this._repeat<-1&&c)return this.totalTime(f*100+n,s,a);if(h=Q(d%f),d===u?(_=this._repeat,h=l):(g=Q(d/f),_=~~g,_&&_===g?(h=l,_--):h>l&&(h=l)),m=this._yoyo&&_&1,m&&(A=this._yEase,h=l-h),g=li(this._tTime,f),h===o&&!a&&this._initted&&_===g)return this._tTime=d,this;_!==g&&(T&&this._yEase&&no(T,m),this.vars.repeatRefresh&&!m&&!this._lock&&h!==f&&this._initted&&(this._lock=a=1,this.render(Q(f*_),!0).invalidate()._lock=0))}if(!this._initted){if(Vs(this,c?n:h,a,s,d))return this._tTime=0,this;if(o!==this._time&&!(a&&this.vars.repeatRefresh&&_!==g))return this;if(l!==this._dur)return this.render(n,s,a)}if(this._tTime=d,this._time=h,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=D=(A||this._ease)(h/l),this._from&&(this.ratio=D=1-D),!o&&d&&!s&&!g&&(Ae(this,"onStart"),this._tTime!==d))return this;for(p=this._pt;p;)p.r(D,p.d),p=p._next;T&&T.render(n<0?n:T._dur*T._ease(h/this._dur),s,a)||this._startAt&&(this._zTime=n),this._onUpdate&&!s&&(c&&Bn(this,n,s,a),Ae(this,"onUpdate")),this._repeat&&_!==g&&this.vars.onRepeat&&!s&&this.parent&&Ae(this,"onRepeat"),(d===this._tDur||!d)&&this._tTime===d&&(c&&!this._onUpdate&&Bn(this,n,!0,!0),(n||!l)&&(d===this._tDur&&this._ts>0||!d&&this._ts<0)&&_t(this,1),!s&&!(c&&!o)&&(d||o||m)&&(Ae(this,d===u?"onComplete":"onReverseComplete",!0),this._prom&&!(d<u&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(n){return(!n||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(n),r.prototype.invalidate.call(this,n)},t.resetTo=function(n,s,a,o,u){Oi||ye.wake(),this._ts||this.play();var l=Math.min(this._dur,(this._dp._time-this._start)*this._ts),c;return this._initted||Er(this,l),c=this._ease(l/this._dur),Ha(this,n,s,a,o,c,l,u)?this.resetTo(n,s,a,o,1):(_n(this,0),this.parent||Gs(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(n,s){if(s===void 0&&(s="all"),!n&&(!s||s==="all"))return this._lazy=this._pt=0,this.parent?Si(this):this.scrollTrigger&&this.scrollTrigger.kill(!!se),this;if(this.timeline){var a=this.timeline.totalDuration();return this.timeline.killTweensOf(n,s,ut&&ut.vars.overwrite!==!0)._first||Si(this),this.parent&&a!==this.timeline.totalDuration()&&ci(this,this._dur*this.timeline._tDur/a,0,1),this}var o=this._targets,u=n?be(n):o,l=this._ptLookup,c=this._pt,d,h,p,_,f,g,m;if((!s||s==="all")&&Da(o,u))return s==="all"&&(this._pt=0),Si(this);for(d=this._op=this._op||[],s!=="all"&&(ie(s)&&(f={},me(s,function(D){return f[D]=1}),s=f),s=$a(o,s)),m=o.length;m--;)if(~u.indexOf(o[m])){h=l[m],s==="all"?(d[m]=s,_=h,p={}):(p=d[m]=d[m]||{},_=s);for(f in _)g=h&&h[f],g&&((!("kill"in g.d)||g.d.kill(f)===!0)&&fn(this,g,"_pt"),delete h[f]),p!=="all"&&(p[f]=1)}return this._initted&&!this._pt&&c&&Si(this),this},e.to=function(n,s){return new e(n,s,arguments[2])},e.from=function(n,s){return Ci(1,arguments)},e.delayedCall=function(n,s,a,o){return new e(s,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:n,onComplete:s,onReverseComplete:s,onCompleteParams:a,onReverseCompleteParams:a,callbackScope:o})},e.fromTo=function(n,s,a){return Ci(2,arguments)},e.set=function(n,s){return s.duration=0,s.repeatDelay||(s.repeat=0),new e(n,s)},e.killTweensOf=function(n,s,a){return V.killTweensOf(n,s,a)},e}(bi);Pe(K.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});me("staggerTo,staggerFrom,staggerFromTo",function(r){K[r]=function(){var e=new fe,t=Un.call(arguments,0);return t.splice(r==="staggerFromTo"?5:4,0,0),e[r].apply(e,t)}});var Sr=function(e,t,i){return e[t]=i},lo=function(e,t,i){return e[t](i)},za=function(e,t,i,n){return e[t](n.fp,i)},Ya=function(e,t,i){return e.setAttribute(t,i)},Tr=function(e,t){return W(e[t])?lo:cr(e[t])&&e.setAttribute?Ya:Sr},co=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},Wa=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},ho=function(e,t){var i=t._pt,n="";if(!e&&t.b)n=t.b;else if(e===1&&t.e)n=t.e;else{for(;i;)n=i.p+(i.m?i.m(i.s+i.c*e):Math.round((i.s+i.c*e)*1e4)/1e4)+n,i=i._next;n+=t.c}t.set(t.t,t.p,n,t)},yr=function(e,t){for(var i=t._pt;i;)i.r(e,i.d),i=i._next},ja=function(e,t,i,n){for(var s=this._pt,a;s;)a=s._next,s.p===n&&s.modifier(e,t,i),s=a},qa=function(e){for(var t=this._pt,i,n;t;)n=t._next,t.p===e&&!t.op||t.op===e?fn(this,t,"_pt"):t.dep||(i=1),t=n;return!i},Xa=function(e,t,i,n){n.mSet(e,t,n.m.call(n.tween,i,n.mt),n)},fo=function(e){for(var t=e._pt,i,n,s,a;t;){for(i=t._next,n=s;n&&n.pr>t.pr;)n=n._next;(t._prev=n?n._prev:a)?t._prev._next=t:s=t,(t._next=n)?n._prev=t:a=t,t=i}e._pt=s},De=function(){function r(t,i,n,s,a,o,u,l,c){this.t=i,this.s=s,this.c=a,this.p=n,this.r=o||co,this.d=u||this,this.set=l||Sr,this.pr=c||0,this._next=t,t&&(t._prev=this)}var e=r.prototype;return e.modifier=function(i,n,s){this.mSet=this.mSet||this.set,this.set=Xa,this.m=i,this.mt=s,this.tween=n},r}();me(_r+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(r){return pr[r]=1});Ie.TweenMax=Ie.TweenLite=K;Ie.TimelineLite=Ie.TimelineMax=fe;V=new fe({sortChildren:!1,defaults:ai,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});Ce.stringFilter=to;var Ft=[],qi={},Ka=[],Qr=0,Qa=0,In=function(e){return(qi[e]||Ka).map(function(t){return t()})},Vn=function(){var e=Date.now(),t=[];e-Qr>2&&(In("matchMediaInit"),Ft.forEach(function(i){var n=i.queries,s=i.conditions,a,o,u,l;for(o in n)a=Ue.matchMedia(n[o]).matches,a&&(u=1),a!==s[o]&&(s[o]=a,l=1);l&&(i.revert(),u&&t.push(i))}),In("matchMediaRevert"),t.forEach(function(i){return i.onMatch(i,function(n){return i.add(null,n)})}),Qr=e,In("matchMedia"))},po=function(){function r(t,i){this.selector=i&&Gn(i),this.data=[],this._r=[],this.isReverted=!1,this.id=Qa++,t&&this.add(t)}var e=r.prototype;return e.add=function(i,n,s){W(i)&&(s=n,n=i,i=W);var a=this,o=function(){var l=$,c=a.selector,d;return l&&l!==a&&l.data.push(a),s&&(a.selector=Gn(s)),$=a,d=n.apply(a,arguments),W(d)&&a._r.push(d),$=l,a.selector=c,a.isReverted=!1,d};return a.last=o,i===W?o(a,function(u){return a.add(null,u)}):i?a[i]=o:o},e.ignore=function(i){var n=$;$=null,i(this),$=n},e.getTweens=function(){var i=[];return this.data.forEach(function(n){return n instanceof r?i.push.apply(i,n.getTweens()):n instanceof K&&!(n.parent&&n.parent.data==="nested")&&i.push(n)}),i},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(i,n){var s=this;if(i?function(){for(var o=s.getTweens(),u=s.data.length,l;u--;)l=s.data[u],l.data==="isFlip"&&(l.revert(),l.getChildren(!0,!0,!1).forEach(function(c){return o.splice(o.indexOf(c),1)}));for(o.map(function(c){return{g:c._dur||c._delay||c._sat&&!c._sat.vars.immediateRender?c.globalTime(0):-1/0,t:c}}).sort(function(c,d){return d.g-c.g||-1/0}).forEach(function(c){return c.t.revert(i)}),u=s.data.length;u--;)l=s.data[u],l instanceof fe?l.data!=="nested"&&(l.scrollTrigger&&l.scrollTrigger.revert(),l.kill()):!(l instanceof K)&&l.revert&&l.revert(i);s._r.forEach(function(c){return c(i,s)}),s.isReverted=!0}():this.data.forEach(function(o){return o.kill&&o.kill()}),this.clear(),n)for(var a=Ft.length;a--;)Ft[a].id===this.id&&Ft.splice(a,1)},e.revert=function(i){this.kill(i||{})},r}(),Ja=function(){function r(t){this.contexts=[],this.scope=t,$&&$.data.push(this)}var e=r.prototype;return e.add=function(i,n,s){Ye(i)||(i={matches:i});var a=new po(0,s||this.scope),o=a.conditions={},u,l,c;$&&!a.selector&&(a.selector=$.selector),this.contexts.push(a),n=a.add("onMatch",n),a.queries=i;for(l in i)l==="all"?c=1:(u=Ue.matchMedia(i[l]),u&&(Ft.indexOf(a)<0&&Ft.push(a),(o[l]=u.matches)&&(c=1),u.addListener?u.addListener(Vn):u.addEventListener("change",Vn)));return c&&n(a,function(d){return a.add(null,d)}),this},e.revert=function(i){this.kill(i||{})},e.kill=function(i){this.contexts.forEach(function(n){return n.kill(i,!0)})},r}(),tn={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(function(n){return Js(n)})},timeline:function(e){return new fe(e)},getTweensOf:function(e,t){return V.getTweensOf(e,t)},getProperty:function(e,t,i,n){ie(e)&&(e=be(e)[0]);var s=bt(e||{}).get,a=i?Us:ks;return i==="native"&&(i=""),e&&(t?a((Te[t]&&Te[t].get||s)(e,t,i,n)):function(o,u,l){return a((Te[o]&&Te[o].get||s)(e,o,u,l))})},quickSetter:function(e,t,i){if(e=be(e),e.length>1){var n=e.map(function(c){return Se.quickSetter(c,t,i)}),s=n.length;return function(c){for(var d=s;d--;)n[d](c)}}e=e[0]||{};var a=Te[t],o=bt(e),u=o.harness&&(o.harness.aliases||{})[t]||t,l=a?function(c){var d=new a;Zt._pt=0,d.init(e,i?c+i:c,Zt,0,[e]),d.render(1,d),Zt._pt&&yr(1,Zt)}:o.set(e,u);return a?l:function(c){return l(e,u,i?c+i:c,o,1)}},quickTo:function(e,t,i){var n,s=Se.to(e,Pe((n={},n[t]="+=0.1",n.paused=!0,n.stagger=0,n),i||{})),a=function(u,l,c){return s.resetTo(t,u,l,c)};return a.tween=s,a},isTweening:function(e){return V.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=wt(e.ease,ai.ease)),Wr(ai,e||{})},config:function(e){return Wr(Ce,e||{})},registerEffect:function(e){var t=e.name,i=e.effect,n=e.plugins,s=e.defaults,a=e.extendTimeline;(n||"").split(",").forEach(function(o){return o&&!Te[o]&&!Ie[o]&&vi(t+" effect requires "+o+" plugin.")}),Tn[t]=function(o,u,l){return i(be(o),Pe(u||{},s),l)},a&&(fe.prototype[t]=function(o,u,l){return this.add(Tn[t](o,Ye(u)?u:(l=u)&&{},this),l)})},registerEase:function(e,t){R[e]=wt(t)},parseEase:function(e,t){return arguments.length?wt(e,t):R},getById:function(e){return V.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var i=new fe(e),n,s;for(i.smoothChildTiming=ge(e.smoothChildTiming),V.remove(i),i._dp=0,i._time=i._tTime=V._time,n=V._first;n;)s=n._next,(t||!(!n._dur&&n instanceof K&&n.vars.onComplete===n._targets[0]))&&He(i,n,n._start-n._delay),n=s;return He(V,i,0),i},context:function(e,t){return e?new po(e,t):$},matchMedia:function(e){return new Ja(e)},matchMediaRefresh:function(){return Ft.forEach(function(e){var t=e.conditions,i,n;for(n in t)t[n]&&(t[n]=!1,i=1);i&&e.revert()})||Vn()},addEventListener:function(e,t){var i=qi[e]||(qi[e]=[]);~i.indexOf(t)||i.push(t)},removeEventListener:function(e,t){var i=qi[e],n=i&&i.indexOf(t);n>=0&&i.splice(n,1)},utils:{wrap:Oa,wrapYoyo:ba,distribute:Ws,random:qs,snap:js,normalize:La,getUnit:ue,clamp:Ia,splitColor:Zs,toArray:be,selector:Gn,mapRange:Ks,pipe:va,unitize:Na,interpolate:Ra,shuffle:Ys},install:ws,effects:Tn,ticker:ye,updateRoot:fe.updateRoot,plugins:Te,globalTimeline:V,core:{PropTween:De,globals:Fs,Tween:K,Timeline:fe,Animation:bi,getCache:bt,_removeLinkedListItem:fn,reverting:function(){return se},context:function(e){return e&&$&&($.data.push(e),e._ctx=$),$},suppressOverwrites:function(e){return lr=e}}};me("to,from,fromTo,delayedCall,set,killTweensOf",function(r){return tn[r]=K[r]});ye.add(fe.updateRoot);Zt=tn.to({},{duration:0});var Za=function(e,t){for(var i=e._pt;i&&i.p!==t&&i.op!==t&&i.fp!==t;)i=i._next;return i},eu=function(e,t){var i=e._targets,n,s,a;for(n in t)for(s=i.length;s--;)a=e._ptLookup[s][n],a&&(a=a.d)&&(a._pt&&(a=Za(a,n)),a&&a.modifier&&a.modifier(t[n],e,i[s],n))},Pn=function(e,t){return{name:e,headless:1,rawVars:1,init:function(n,s,a){a._onInit=function(o){var u,l;if(ie(s)&&(u={},me(s,function(c){return u[c]=1}),s=u),t){u={};for(l in s)u[l]=t(s[l]);s=u}eu(o,s)}}}},Se=tn.registerPlugin({name:"attr",init:function(e,t,i,n,s){var a,o,u;this.tween=i;for(a in t)u=e.getAttribute(a)||"",o=this.add(e,"setAttribute",(u||0)+"",t[a],n,s,0,0,a),o.op=a,o.b=u,this._props.push(a)},render:function(e,t){for(var i=t._pt;i;)se?i.set(i.t,i.p,i.b,i):i.r(e,i.d),i=i._next}},{name:"endArray",headless:1,init:function(e,t){for(var i=t.length;i--;)this.add(e,i,e[i]||0,t[i],0,0,0,0,0,1)}},Pn("roundProps",Hn),Pn("modifiers"),Pn("snap",js))||tn;K.version=fe.version=Se.version="3.13.0";Rs=1;dr()&&di();R.Power0;R.Power1;R.Power2;R.Power3;R.Power4;R.Linear;R.Quad;R.Cubic;R.Quart;R.Quint;R.Strong;R.Elastic;R.Back;R.SteppedEase;R.Bounce;R.Sine;R.Expo;R.Circ;/*!
 * CSSPlugin 3.13.0
 * https://gsap.com
 *
 * Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var Jr,lt,ri,Ar,Lt,Zr,Cr,tu=function(){return typeof window<"u"},it={},Ct=180/Math.PI,si=Math.PI/180,Vt=Math.atan2,es=1e8,Ir=/([A-Z])/g,iu=/(left|right|width|margin|padding|x)/i,nu=/[\s,\(]\S/,$e={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},zn=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},ru=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},su=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},ou=function(e,t){var i=t.s+t.c*e;t.set(t.t,t.p,~~(i+(i<0?-.5:.5))+t.u,t)},_o=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},go=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},au=function(e,t,i){return e.style[t]=i},uu=function(e,t,i){return e.style.setProperty(t,i)},lu=function(e,t,i){return e._gsap[t]=i},cu=function(e,t,i){return e._gsap.scaleX=e._gsap.scaleY=i},du=function(e,t,i,n,s){var a=e._gsap;a.scaleX=a.scaleY=i,a.renderTransform(s,a)},hu=function(e,t,i,n,s){var a=e._gsap;a[t]=i,a.renderTransform(s,a)},z="transform",Ee=z+"Origin",fu=function r(e,t){var i=this,n=this.target,s=n.style,a=n._gsap;if(e in it&&s){if(this.tfm=this.tfm||{},e!=="transform")e=$e[e]||e,~e.indexOf(",")?e.split(",").forEach(function(o){return i.tfm[o]=Xe(n,o)}):this.tfm[e]=a.x?a[e]:Xe(n,e),e===Ee&&(this.tfm.zOrigin=a.zOrigin);else return $e.transform.split(",").forEach(function(o){return r.call(i,o,t)});if(this.props.indexOf(z)>=0)return;a.svg&&(this.svgo=n.getAttribute("data-svg-origin"),this.props.push(Ee,t,"")),e=z}(s||t)&&this.props.push(e,t,s[e])},mo=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},pu=function(){var e=this.props,t=this.target,i=t.style,n=t._gsap,s,a;for(s=0;s<e.length;s+=3)e[s+1]?e[s+1]===2?t[e[s]](e[s+2]):t[e[s]]=e[s+2]:e[s+2]?i[e[s]]=e[s+2]:i.removeProperty(e[s].substr(0,2)==="--"?e[s]:e[s].replace(Ir,"-$1").toLowerCase());if(this.tfm){for(a in this.tfm)n[a]=this.tfm[a];n.svg&&(n.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),s=Cr(),(!s||!s.isStart)&&!i[z]&&(mo(i),n.zOrigin&&i[Ee]&&(i[Ee]+=" "+n.zOrigin+"px",n.zOrigin=0,n.renderTransform()),n.uncache=1)}},Do=function(e,t){var i={target:e,props:[],revert:pu,save:fu};return e._gsap||Se.core.getCache(e),t&&e.style&&e.nodeType&&t.split(",").forEach(function(n){return i.save(n)}),i},Eo,Yn=function(e,t){var i=lt.createElementNS?lt.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):lt.createElement(e);return i&&i.style?i:lt.createElement(e)},Re=function r(e,t,i){var n=getComputedStyle(e);return n[t]||n.getPropertyValue(t.replace(Ir,"-$1").toLowerCase())||n.getPropertyValue(t)||!i&&r(e,hi(t)||t,1)||""},ts="O,Moz,ms,Ms,Webkit".split(","),hi=function(e,t,i){var n=t||Lt,s=n.style,a=5;if(e in s&&!i)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);a--&&!(ts[a]+e in s););return a<0?null:(a===3?"ms":a>=0?ts[a]:"")+e},Wn=function(){tu()&&window.document&&(Jr=window,lt=Jr.document,ri=lt.documentElement,Lt=Yn("div")||{style:{}},Yn("div"),z=hi(z),Ee=z+"Origin",Lt.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Eo=!!hi("perspective"),Cr=Se.core.reverting,Ar=1)},is=function(e){var t=e.ownerSVGElement,i=Yn("svg",t&&t.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),n=e.cloneNode(!0),s;n.style.display="block",i.appendChild(n),ri.appendChild(i);try{s=n.getBBox()}catch{}return i.removeChild(n),ri.removeChild(i),s},ns=function(e,t){for(var i=t.length;i--;)if(e.hasAttribute(t[i]))return e.getAttribute(t[i])},So=function(e){var t,i;try{t=e.getBBox()}catch{t=is(e),i=1}return t&&(t.width||t.height)||i||(t=is(e)),t&&!t.width&&!t.x&&!t.y?{x:+ns(e,["x","cx","x1"])||0,y:+ns(e,["y","cy","y1"])||0,width:0,height:0}:t},To=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&So(e))},Bt=function(e,t){if(t){var i=e.style,n;t in it&&t!==Ee&&(t=z),i.removeProperty?(n=t.substr(0,2),(n==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),i.removeProperty(n==="--"?t:t.replace(Ir,"-$1").toLowerCase())):i.removeAttribute(t)}},ct=function(e,t,i,n,s,a){var o=new De(e._pt,t,i,0,1,a?go:_o);return e._pt=o,o.b=n,o.e=s,e._props.push(i),o},rs={deg:1,rad:1,turn:1},_u={grid:1,flex:1},gt=function r(e,t,i,n){var s=parseFloat(i)||0,a=(i+"").trim().substr((s+"").length)||"px",o=Lt.style,u=iu.test(t),l=e.tagName.toLowerCase()==="svg",c=(l?"client":"offset")+(u?"Width":"Height"),d=100,h=n==="px",p=n==="%",_,f,g,m;if(n===a||!s||rs[n]||rs[a])return s;if(a!=="px"&&!h&&(s=r(e,t,i,"px")),m=e.getCTM&&To(e),(p||a==="%")&&(it[t]||~t.indexOf("adius")))return _=m?e.getBBox()[u?"width":"height"]:e[c],q(p?s/_*d:s/100*_);if(o[u?"width":"height"]=d+(h?a:n),f=n!=="rem"&&~t.indexOf("adius")||n==="em"&&e.appendChild&&!l?e:e.parentNode,m&&(f=(e.ownerSVGElement||{}).parentNode),(!f||f===lt||!f.appendChild)&&(f=lt.body),g=f._gsap,g&&p&&g.width&&u&&g.time===ye.time&&!g.uncache)return q(s/g.width*d);if(p&&(t==="height"||t==="width")){var D=e.style[t];e.style[t]=d+n,_=e[c],D?e.style[t]=D:Bt(e,t)}else(p||a==="%")&&!_u[Re(f,"display")]&&(o.position=Re(e,"position")),f===e&&(o.position="static"),f.appendChild(Lt),_=Lt[c],f.removeChild(Lt),o.position="absolute";return u&&p&&(g=bt(f),g.time=ye.time,g.width=f[c]),q(h?_*s/d:_&&s?d/_*s:0)},Xe=function(e,t,i,n){var s;return Ar||Wn(),t in $e&&t!=="transform"&&(t=$e[t],~t.indexOf(",")&&(t=t.split(",")[0])),it[t]&&t!=="transform"?(s=wi(e,n),s=t!=="transformOrigin"?s[t]:s.svg?s.origin:rn(Re(e,Ee))+" "+s.zOrigin+"px"):(s=e.style[t],(!s||s==="auto"||n||~(s+"").indexOf("calc("))&&(s=nn[t]&&nn[t](e,t,i)||Re(e,t)||xs(e,t)||(t==="opacity"?1:0))),i&&!~(s+"").trim().indexOf(" ")?gt(e,t,s,i)+i:s},gu=function(e,t,i,n){if(!i||i==="none"){var s=hi(t,e,1),a=s&&Re(e,s,1);a&&a!==i?(t=s,i=a):t==="borderColor"&&(i=Re(e,"borderTopColor"))}var o=new De(this._pt,e.style,t,0,1,ho),u=0,l=0,c,d,h,p,_,f,g,m,D,T,A,S;if(o.b=i,o.e=n,i+="",n+="",n.substring(0,6)==="var(--"&&(n=Re(e,n.substring(4,n.indexOf(")")))),n==="auto"&&(f=e.style[t],e.style[t]=n,n=Re(e,t)||n,f?e.style[t]=f:Bt(e,t)),c=[i,n],to(c),i=c[0],n=c[1],h=i.match(Jt)||[],S=n.match(Jt)||[],S.length){for(;d=Jt.exec(n);)g=d[0],D=n.substring(u,d.index),_?_=(_+1)%5:(D.substr(-5)==="rgba("||D.substr(-5)==="hsla(")&&(_=1),g!==(f=h[l++]||"")&&(p=parseFloat(f)||0,A=f.substr((p+"").length),g.charAt(1)==="="&&(g=ni(p,g)+A),m=parseFloat(g),T=g.substr((m+"").length),u=Jt.lastIndex-T.length,T||(T=T||Ce.units[t]||A,u===n.length&&(n+=T,o.e+=T)),A!==T&&(p=gt(e,t,f,T)||0),o._pt={_next:o._pt,p:D||l===1?D:",",s:p,c:m-p,m:_&&_<4||t==="zIndex"?Math.round:0});o.c=u<n.length?n.substring(u,n.length):""}else o.r=t==="display"&&n==="none"?go:_o;return Os.test(n)&&(o.e=0),this._pt=o,o},ss={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},mu=function(e){var t=e.split(" "),i=t[0],n=t[1]||"50%";return(i==="top"||i==="bottom"||n==="left"||n==="right")&&(e=i,i=n,n=e),t[0]=ss[i]||i,t[1]=ss[n]||n,t.join(" ")},Du=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var i=t.t,n=i.style,s=t.u,a=i._gsap,o,u,l;if(s==="all"||s===!0)n.cssText="",u=1;else for(s=s.split(","),l=s.length;--l>-1;)o=s[l],it[o]&&(u=1,o=o==="transformOrigin"?Ee:z),Bt(i,o);u&&(Bt(i,z),a&&(a.svg&&i.removeAttribute("transform"),n.scale=n.rotate=n.translate="none",wi(i,1),a.uncache=1,mo(n)))}},nn={clearProps:function(e,t,i,n,s){if(s.data!=="isFromStart"){var a=e._pt=new De(e._pt,t,i,0,0,Du);return a.u=n,a.pr=-10,a.tween=s,e._props.push(i),1}}},Ri=[1,0,0,1,0,0],yo={},Ao=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},os=function(e){var t=Re(e,z);return Ao(t)?Ri:t.substr(7).match(Ls).map(q)},Pr=function(e,t){var i=e._gsap||bt(e),n=e.style,s=os(e),a,o,u,l;return i.svg&&e.getAttribute("transform")?(u=e.transform.baseVal.consolidate().matrix,s=[u.a,u.b,u.c,u.d,u.e,u.f],s.join(",")==="1,0,0,1,0,0"?Ri:s):(s===Ri&&!e.offsetParent&&e!==ri&&!i.svg&&(u=n.display,n.display="block",a=e.parentNode,(!a||!e.offsetParent&&!e.getBoundingClientRect().width)&&(l=1,o=e.nextElementSibling,ri.appendChild(e)),s=os(e),u?n.display=u:Bt(e,"display"),l&&(o?a.insertBefore(e,o):a?a.appendChild(e):ri.removeChild(e))),t&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s)},jn=function(e,t,i,n,s,a){var o=e._gsap,u=s||Pr(e,!0),l=o.xOrigin||0,c=o.yOrigin||0,d=o.xOffset||0,h=o.yOffset||0,p=u[0],_=u[1],f=u[2],g=u[3],m=u[4],D=u[5],T=t.split(" "),A=parseFloat(T[0])||0,S=parseFloat(T[1])||0,C,I,E,y;i?u!==Ri&&(I=p*g-_*f)&&(E=A*(g/I)+S*(-f/I)+(f*D-g*m)/I,y=A*(-_/I)+S*(p/I)-(p*D-_*m)/I,A=E,S=y):(C=So(e),A=C.x+(~T[0].indexOf("%")?A/100*C.width:A),S=C.y+(~(T[1]||T[0]).indexOf("%")?S/100*C.height:S)),n||n!==!1&&o.smooth?(m=A-l,D=S-c,o.xOffset=d+(m*p+D*f)-m,o.yOffset=h+(m*_+D*g)-D):o.xOffset=o.yOffset=0,o.xOrigin=A,o.yOrigin=S,o.smooth=!!n,o.origin=t,o.originIsAbsolute=!!i,e.style[Ee]="0px 0px",a&&(ct(a,o,"xOrigin",l,A),ct(a,o,"yOrigin",c,S),ct(a,o,"xOffset",d,o.xOffset),ct(a,o,"yOffset",h,o.yOffset)),e.setAttribute("data-svg-origin",A+" "+S)},wi=function(e,t){var i=e._gsap||new so(e);if("x"in i&&!t&&!i.uncache)return i;var n=e.style,s=i.scaleX<0,a="px",o="deg",u=getComputedStyle(e),l=Re(e,Ee)||"0",c,d,h,p,_,f,g,m,D,T,A,S,C,I,E,y,N,w,F,M,X,k,Y,U,de,$t,ve,st,pe,zr,We,Tt;return c=d=h=f=g=m=D=T=A=0,p=_=1,i.svg=!!(e.getCTM&&To(e)),u.translate&&((u.translate!=="none"||u.scale!=="none"||u.rotate!=="none")&&(n[z]=(u.translate!=="none"?"translate3d("+(u.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(u.rotate!=="none"?"rotate("+u.rotate+") ":"")+(u.scale!=="none"?"scale("+u.scale.split(" ").join(",")+") ":"")+(u[z]!=="none"?u[z]:"")),n.scale=n.rotate=n.translate="none"),I=Pr(e,i.svg),i.svg&&(i.uncache?(de=e.getBBox(),l=i.xOrigin-de.x+"px "+(i.yOrigin-de.y)+"px",U=""):U=!t&&e.getAttribute("data-svg-origin"),jn(e,U||l,!!U||i.originIsAbsolute,i.smooth!==!1,I)),S=i.xOrigin||0,C=i.yOrigin||0,I!==Ri&&(w=I[0],F=I[1],M=I[2],X=I[3],c=k=I[4],d=Y=I[5],I.length===6?(p=Math.sqrt(w*w+F*F),_=Math.sqrt(X*X+M*M),f=w||F?Vt(F,w)*Ct:0,D=M||X?Vt(M,X)*Ct+f:0,D&&(_*=Math.abs(Math.cos(D*si))),i.svg&&(c-=S-(S*w+C*M),d-=C-(S*F+C*X))):(Tt=I[6],zr=I[7],ve=I[8],st=I[9],pe=I[10],We=I[11],c=I[12],d=I[13],h=I[14],E=Vt(Tt,pe),g=E*Ct,E&&(y=Math.cos(-E),N=Math.sin(-E),U=k*y+ve*N,de=Y*y+st*N,$t=Tt*y+pe*N,ve=k*-N+ve*y,st=Y*-N+st*y,pe=Tt*-N+pe*y,We=zr*-N+We*y,k=U,Y=de,Tt=$t),E=Vt(-M,pe),m=E*Ct,E&&(y=Math.cos(-E),N=Math.sin(-E),U=w*y-ve*N,de=F*y-st*N,$t=M*y-pe*N,We=X*N+We*y,w=U,F=de,M=$t),E=Vt(F,w),f=E*Ct,E&&(y=Math.cos(E),N=Math.sin(E),U=w*y+F*N,de=k*y+Y*N,F=F*y-w*N,Y=Y*y-k*N,w=U,k=de),g&&Math.abs(g)+Math.abs(f)>359.9&&(g=f=0,m=180-m),p=q(Math.sqrt(w*w+F*F+M*M)),_=q(Math.sqrt(Y*Y+Tt*Tt)),E=Vt(k,Y),D=Math.abs(E)>2e-4?E*Ct:0,A=We?1/(We<0?-We:We):0),i.svg&&(U=e.getAttribute("transform"),i.forceCSS=e.setAttribute("transform","")||!Ao(Re(e,z)),U&&e.setAttribute("transform",U))),Math.abs(D)>90&&Math.abs(D)<270&&(s?(p*=-1,D+=f<=0?180:-180,f+=f<=0?180:-180):(_*=-1,D+=D<=0?180:-180)),t=t||i.uncache,i.x=c-((i.xPercent=c&&(!t&&i.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-c)?-50:0)))?e.offsetWidth*i.xPercent/100:0)+a,i.y=d-((i.yPercent=d&&(!t&&i.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-d)?-50:0)))?e.offsetHeight*i.yPercent/100:0)+a,i.z=h+a,i.scaleX=q(p),i.scaleY=q(_),i.rotation=q(f)+o,i.rotationX=q(g)+o,i.rotationY=q(m)+o,i.skewX=D+o,i.skewY=T+o,i.transformPerspective=A+a,(i.zOrigin=parseFloat(l.split(" ")[2])||!t&&i.zOrigin||0)&&(n[Ee]=rn(l)),i.xOffset=i.yOffset=0,i.force3D=Ce.force3D,i.renderTransform=i.svg?Su:Eo?Co:Eu,i.uncache=0,i},rn=function(e){return(e=e.split(" "))[0]+" "+e[1]},vn=function(e,t,i){var n=ue(t);return q(parseFloat(t)+parseFloat(gt(e,"x",i+"px",n)))+n},Eu=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,Co(e,t)},yt="0deg",gi="0px",At=") ",Co=function(e,t){var i=t||this,n=i.xPercent,s=i.yPercent,a=i.x,o=i.y,u=i.z,l=i.rotation,c=i.rotationY,d=i.rotationX,h=i.skewX,p=i.skewY,_=i.scaleX,f=i.scaleY,g=i.transformPerspective,m=i.force3D,D=i.target,T=i.zOrigin,A="",S=m==="auto"&&e&&e!==1||m===!0;if(T&&(d!==yt||c!==yt)){var C=parseFloat(c)*si,I=Math.sin(C),E=Math.cos(C),y;C=parseFloat(d)*si,y=Math.cos(C),a=vn(D,a,I*y*-T),o=vn(D,o,-Math.sin(C)*-T),u=vn(D,u,E*y*-T+T)}g!==gi&&(A+="perspective("+g+At),(n||s)&&(A+="translate("+n+"%, "+s+"%) "),(S||a!==gi||o!==gi||u!==gi)&&(A+=u!==gi||S?"translate3d("+a+", "+o+", "+u+") ":"translate("+a+", "+o+At),l!==yt&&(A+="rotate("+l+At),c!==yt&&(A+="rotateY("+c+At),d!==yt&&(A+="rotateX("+d+At),(h!==yt||p!==yt)&&(A+="skew("+h+", "+p+At),(_!==1||f!==1)&&(A+="scale("+_+", "+f+At),D.style[z]=A||"translate(0, 0)"},Su=function(e,t){var i=t||this,n=i.xPercent,s=i.yPercent,a=i.x,o=i.y,u=i.rotation,l=i.skewX,c=i.skewY,d=i.scaleX,h=i.scaleY,p=i.target,_=i.xOrigin,f=i.yOrigin,g=i.xOffset,m=i.yOffset,D=i.forceCSS,T=parseFloat(a),A=parseFloat(o),S,C,I,E,y;u=parseFloat(u),l=parseFloat(l),c=parseFloat(c),c&&(c=parseFloat(c),l+=c,u+=c),u||l?(u*=si,l*=si,S=Math.cos(u)*d,C=Math.sin(u)*d,I=Math.sin(u-l)*-h,E=Math.cos(u-l)*h,l&&(c*=si,y=Math.tan(l-c),y=Math.sqrt(1+y*y),I*=y,E*=y,c&&(y=Math.tan(c),y=Math.sqrt(1+y*y),S*=y,C*=y)),S=q(S),C=q(C),I=q(I),E=q(E)):(S=d,E=h,C=I=0),(T&&!~(a+"").indexOf("px")||A&&!~(o+"").indexOf("px"))&&(T=gt(p,"x",a,"px"),A=gt(p,"y",o,"px")),(_||f||g||m)&&(T=q(T+_-(_*S+f*I)+g),A=q(A+f-(_*C+f*E)+m)),(n||s)&&(y=p.getBBox(),T=q(T+n/100*y.width),A=q(A+s/100*y.height)),y="matrix("+S+","+C+","+I+","+E+","+T+","+A+")",p.setAttribute("transform",y),D&&(p.style[z]=y)},Tu=function(e,t,i,n,s){var a=360,o=ie(s),u=parseFloat(s)*(o&&~s.indexOf("rad")?Ct:1),l=u-n,c=n+l+"deg",d,h;return o&&(d=s.split("_")[1],d==="short"&&(l%=a,l!==l%(a/2)&&(l+=l<0?a:-360)),d==="cw"&&l<0?l=(l+a*es)%a-~~(l/a)*a:d==="ccw"&&l>0&&(l=(l-a*es)%a-~~(l/a)*a)),e._pt=h=new De(e._pt,t,i,n,l,ru),h.e=c,h.u="deg",e._props.push(i),h},as=function(e,t){for(var i in t)e[i]=t[i];return e},yu=function(e,t,i){var n=as({},i._gsap),s="perspective,force3D,transformOrigin,svgOrigin",a=i.style,o,u,l,c,d,h,p,_;n.svg?(l=i.getAttribute("transform"),i.setAttribute("transform",""),a[z]=t,o=wi(i,1),Bt(i,z),i.setAttribute("transform",l)):(l=getComputedStyle(i)[z],a[z]=t,o=wi(i,1),a[z]=l);for(u in it)l=n[u],c=o[u],l!==c&&s.indexOf(u)<0&&(p=ue(l),_=ue(c),d=p!==_?gt(i,u,l,_):parseFloat(l),h=parseFloat(c),e._pt=new De(e._pt,o,u,d,h-d,zn),e._pt.u=_||0,e._props.push(u));as(o,n)};me("padding,margin,Width,Radius",function(r,e){var t="Top",i="Right",n="Bottom",s="Left",a=(e<3?[t,i,n,s]:[t+s,t+i,n+i,n+s]).map(function(o){return e<2?r+o:"border"+o+r});nn[e>1?"border"+r:r]=function(o,u,l,c,d){var h,p;if(arguments.length<4)return h=a.map(function(_){return Xe(o,_,l)}),p=h.join(" "),p.split(h[0]).length===5?h[0]:p;h=(c+"").split(" "),p={},a.forEach(function(_,f){return p[_]=h[f]=h[f]||h[(f-1)/2|0]}),o.init(u,p,d)}});var Io={name:"css",register:Wn,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,i,n,s){var a=this._props,o=e.style,u=i.vars.startAt,l,c,d,h,p,_,f,g,m,D,T,A,S,C,I,E;Ar||Wn(),this.styles=this.styles||Do(e),E=this.styles.props,this.tween=i;for(f in t)if(f!=="autoRound"&&(c=t[f],!(Te[f]&&oo(f,t,i,n,e,s)))){if(p=typeof c,_=nn[f],p==="function"&&(c=c.call(i,n,e,s),p=typeof c),p==="string"&&~c.indexOf("random(")&&(c=Li(c)),_)_(this,e,f,c,i)&&(I=1);else if(f.substr(0,2)==="--")l=(getComputedStyle(e).getPropertyValue(f)+"").trim(),c+="",ft.lastIndex=0,ft.test(l)||(g=ue(l),m=ue(c)),m?g!==m&&(l=gt(e,f,l,m)+m):g&&(c+=g),this.add(o,"setProperty",l,c,n,s,0,0,f),a.push(f),E.push(f,0,o[f]);else if(p!=="undefined"){if(u&&f in u?(l=typeof u[f]=="function"?u[f].call(i,n,e,s):u[f],ie(l)&&~l.indexOf("random(")&&(l=Li(l)),ue(l+"")||l==="auto"||(l+=Ce.units[f]||ue(Xe(e,f))||""),(l+"").charAt(1)==="="&&(l=Xe(e,f))):l=Xe(e,f),h=parseFloat(l),D=p==="string"&&c.charAt(1)==="="&&c.substr(0,2),D&&(c=c.substr(2)),d=parseFloat(c),f in $e&&(f==="autoAlpha"&&(h===1&&Xe(e,"visibility")==="hidden"&&d&&(h=0),E.push("visibility",0,o.visibility),ct(this,o,"visibility",h?"inherit":"hidden",d?"inherit":"hidden",!d)),f!=="scale"&&f!=="transform"&&(f=$e[f],~f.indexOf(",")&&(f=f.split(",")[0]))),T=f in it,T){if(this.styles.save(f),p==="string"&&c.substring(0,6)==="var(--"&&(c=Re(e,c.substring(4,c.indexOf(")"))),d=parseFloat(c)),A||(S=e._gsap,S.renderTransform&&!t.parseTransform||wi(e,t.parseTransform),C=t.smoothOrigin!==!1&&S.smooth,A=this._pt=new De(this._pt,o,z,0,1,S.renderTransform,S,0,-1),A.dep=1),f==="scale")this._pt=new De(this._pt,S,"scaleY",S.scaleY,(D?ni(S.scaleY,D+d):d)-S.scaleY||0,zn),this._pt.u=0,a.push("scaleY",f),f+="X";else if(f==="transformOrigin"){E.push(Ee,0,o[Ee]),c=mu(c),S.svg?jn(e,c,0,C,0,this):(m=parseFloat(c.split(" ")[2])||0,m!==S.zOrigin&&ct(this,S,"zOrigin",S.zOrigin,m),ct(this,o,f,rn(l),rn(c)));continue}else if(f==="svgOrigin"){jn(e,c,1,C,0,this);continue}else if(f in yo){Tu(this,S,f,h,D?ni(h,D+c):c);continue}else if(f==="smoothOrigin"){ct(this,S,"smooth",S.smooth,c);continue}else if(f==="force3D"){S[f]=c;continue}else if(f==="transform"){yu(this,c,e);continue}}else f in o||(f=hi(f)||f);if(T||(d||d===0)&&(h||h===0)&&!nu.test(c)&&f in o)g=(l+"").substr((h+"").length),d||(d=0),m=ue(c)||(f in Ce.units?Ce.units[f]:g),g!==m&&(h=gt(e,f,l,m)),this._pt=new De(this._pt,T?S:o,f,h,(D?ni(h,D+d):d)-h,!T&&(m==="px"||f==="zIndex")&&t.autoRound!==!1?ou:zn),this._pt.u=m||0,g!==m&&m!=="%"&&(this._pt.b=l,this._pt.r=su);else if(f in o)gu.call(this,e,f,l,D?D+c:c);else if(f in e)this.add(e,f,l||e[f],D?D+c:c,n,s);else if(f!=="parseTransform"){fr(f,c);continue}T||(f in o?E.push(f,0,o[f]):typeof e[f]=="function"?E.push(f,2,e[f]()):E.push(f,1,l||e[f])),a.push(f)}}I&&fo(this)},render:function(e,t){if(t.tween._time||!Cr())for(var i=t._pt;i;)i.r(e,i.d),i=i._next;else t.styles.revert()},get:Xe,aliases:$e,getSetter:function(e,t,i){var n=$e[t];return n&&n.indexOf(",")<0&&(t=n),t in it&&t!==Ee&&(e._gsap.x||Xe(e,"x"))?i&&Zr===i?t==="scale"?cu:lu:(Zr=i||{})&&(t==="scale"?du:hu):e.style&&!cr(e.style[t])?au:~t.indexOf("-")?uu:Tr(e,t)},core:{_removeProperty:Bt,_getMatrix:Pr}};Se.utils.checkPrefix=hi;Se.core.getStyleSaver=Do;(function(r,e,t,i){var n=me(r+","+e+","+t,function(s){it[s]=1});me(e,function(s){Ce.units[s]="deg",yo[s]=1}),$e[n[13]]=r+","+e,me(i,function(s){var a=s.split(":");$e[a[1]]=n[a[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");me("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(r){Ce.units[r]="px"});Se.registerPlugin(Io);var he=Se.registerPlugin(Io)||Se;he.core.Tween;/*!
 * strings: 3.13.0
 * https://gsap.com
 *
 * Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var Au=/(?:^\s+|\s+$)/g,Cu=/([\uD800-\uDBFF][\uDC00-\uDFFF](?:[\u200D\uFE0F][\uD800-\uDBFF][\uDC00-\uDFFF]){2,}|\uD83D\uDC69(?:\u200D(?:(?:\uD83D\uDC69\u200D)?\uD83D\uDC67|(?:\uD83D\uDC69\u200D)?\uD83D\uDC66)|\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC69\u200D(?:\uD83D\uDC69\u200D)?\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC69\u200D(?:\uD83D\uDC69\u200D)?\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2642\u2640]\uFE0F|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDD27\uDCBC\uDD2C\uDE80\uDE92])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC6F\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3C-\uDD3E\uDDD6-\uDDDF])\u200D[\u2640\u2642]\uFE0F|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF6\uD83C\uDDE6|\uD83C\uDDF4\uD83C\uDDF2|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|(?:\u26F9|\uD83C[\uDFCC\uDFCB]|\uD83D\uDD75)(?:\uFE0F\u200D[\u2640\u2642]|(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642])\uFE0F|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|\uD83D\uDC69\u200D[\u2695\u2696\u2708]|\uD83D\uDC68(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708]))\uFE0F|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83D\uDC69\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D[\uDC68\uDC69]))|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|[#\*0-9]\uFE0F\u20E3|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDFF4\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74|\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67)\uDB40\uDC7F|\uD83D\uDC68(?:\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83D\uDC68|(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC66\u200D\uD83D\uDC66|(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92])|(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]))|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u270A-\u270D]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC70\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDCAA\uDD74\uDD7A\uDD90\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD30-\uDD36\uDDD1-\uDDD5])(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC68(?:\u200D(?:(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC67|(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC66)|\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC69\uDC6E\uDC70-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD26\uDD30-\uDD39\uDD3D\uDD3E\uDDD1-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])?|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDEEB\uDEEC\uDEF4-\uDEF8]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD4C\uDD50-\uDD6B\uDD80-\uDD97\uDDC0\uDDD0-\uDDE6])|(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267B\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEF8]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD4C\uDD50-\uDD6B\uDD80-\uDD97\uDDC0\uDDD0-\uDDE6])\uFE0F)/;function Po(r){var e=r.nodeType,t="";if(e===1||e===9||e===11){if(typeof r.textContent=="string")return r.textContent;for(r=r.firstChild;r;r=r.nextSibling)t+=Po(r)}else if(e===3||e===4)return r.nodeValue;return t}function qn(r,e,t,i,n){for(var s=r.firstChild,a=[],o;s;)s.nodeType===3?(o=(s.nodeValue+"").replace(/^\n+/g,""),i||(o=o.replace(/\s+/g," ")),a.push.apply(a,vo(o,e,t,i,n))):(s.nodeName+"").toLowerCase()==="br"?a[a.length-1]+="<br>":a.push(s.outerHTML),s=s.nextSibling;if(!n)for(o=a.length;o--;)a[o]==="&"&&a.splice(o,1,"&amp;");return a}function vo(r,e,t,i,n){if(r+="",t&&(r=r.trim?r.trim():r.replace(Au,"")),e&&e!=="")return r.replace(/>/g,"&gt;").replace(/</g,"&lt;").split(e);for(var s=[],a=r.length,o=0,u,l;o<a;o++)l=r.charAt(o),(l.charCodeAt(0)>=55296&&l.charCodeAt(0)<=56319||r.charCodeAt(o+1)>=65024&&r.charCodeAt(o+1)<=65039)&&(u=((r.substr(o,12).split(Cu)||[])[1]||"").length||2,l=r.substr(o,u),s.emoji=1,o+=u-1),s.push(n?l:l===">"?"&gt;":l==="<"?"&lt;":i&&l===" "&&(r.charAt(o-1)===" "||r.charAt(o+1)===" ")?"&nbsp;":l);return s}/*!
 * TextPlugin 3.13.0
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var yi,Hi,Iu=function(){return yi||typeof window<"u"&&(yi=window.gsap)&&yi.registerPlugin&&yi},ki={version:"3.13.0",name:"text",init:function(e,t,i){typeof t!="object"&&(t={value:t});var n=e.nodeName.toUpperCase(),s=this,a=t,o=a.newClass,u=a.oldClass,l=a.preserveSpaces,c=a.rtl,d=s.delimiter=t.delimiter||"",h=s.fillChar=t.fillChar||(t.padSpace?"&nbsp;":""),p,_,f,g,m,D,T,A;if(s.svg=e.getBBox&&(n==="TEXT"||n==="TSPAN"),!("innerHTML"in e)&&!s.svg)return!1;if(s.target=e,!("value"in t)){s.text=s.original=[""];return}for(f=qn(e,d,!1,l,s.svg),Hi||(Hi=document.createElement("div")),Hi.innerHTML=t.value,_=qn(Hi,d,!1,l,s.svg),s.from=i._from,(s.from||c)&&!(c&&s.from)&&(n=f,f=_,_=n),s.hasClass=!!(o||u),s.newClass=c?u:o,s.oldClass=c?o:u,n=f.length-_.length,p=n<0?f:_,n<0&&(n=-n);--n>-1;)p.push(h);if(t.type==="diff"){for(g=0,m=[],D=[],T="",n=0;n<_.length;n++)A=_[n],A===f[n]?T+=A:(m[g]=T+A,D[g++]=T+f[n],T="");_=m,f=D,T&&(_.push(T),f.push(T))}t.speed&&i.duration(Math.min(.05/t.speed*p.length,t.maxDuration||9999)),s.rtl=c,s.original=f,s.text=_,s._props.push("text")},render:function(e,t){e>1?e=1:e<0&&(e=0),t.from&&(e=1-e);var i=t.text,n=t.hasClass,s=t.newClass,a=t.oldClass,o=t.delimiter,u=t.target,l=t.fillChar,c=t.original,d=t.rtl,h=i.length,p=(d?1-e:e)*h+.5|0,_,f,g;n&&e?(_=s&&p,f=a&&p!==h,g=(_?"<span class='"+s+"'>":"")+i.slice(0,p).join(o)+(_?"</span>":"")+(f?"<span class='"+a+"'>":"")+o+c.slice(p).join(o)+(f?"</span>":"")):g=i.slice(0,p).join(o)+o+c.slice(p).join(o),t.svg?u.textContent=g:u.innerHTML=l==="&nbsp;"&&~g.indexOf("  ")?g.split("  ").join("&nbsp;&nbsp;"):g}};ki.splitInnerHTML=qn;ki.emojiSafeSplit=vo;ki.getText=Po;Iu()&&yi.registerPlugin(ki);const Pu=1.3,vu=1.3,Nu=.1,No=150,Lu=32,Ou=1.6,bu=.15,Ru=.8,wu=2,kt=40.6,Fu=.4,Mu="power1.out",xu=1.7,Bu=2.6,ku="sine.inOut",ee=[0,246,278.727,311.455,344.182,16.909,49.636,82.364,115.091,147.818,180.545,213.273],ke={env:1,lcd:0,logo:1,btn:0},Uu=.75,Gu=.3,Hu=.3,$u=25,Lo=1500,Vu=Lo/1e3,zu=.04,Yu=.05,Wu=.03,ju=1,qu=.1,Xu=.05,Ku=.3,Qu={P0:.4,P1:.39,P2:.35,P3:.325,P4:.6,P5:.275,P6:.225,P7:.075,P8:0},Ju=1,Zu=["body",".panel-bezel",".panel-section",".control-block",".button-unit",".button-unit .light",".button-unit .button-text","#logo-container","#logo-container svg.logo-svg","#logo-container svg.logo-svg .logo-dynamic-bg","#logo-container svg.logo-svg .logo-panel-bg-rect",".dial-canvas-container",".hue-lcd-display",".actual-lcd-screen-element","#lens-container","#color-lens",".grill-placeholder",".color-chip",".control-group-label",".block-label-bottom"],el=.7,tl=.2,il=250,nl=.005,rl=.045,sl=9,ol=1.8,al=75,qt=.85,ul=0,ll=.33,cl=.66,dl=1,hl=1.05,mi=(r,e)=>r.map(t=>({...t,pos:t.pos*e})),Oo=[{power:ul,stops:mi([{l:.976,c:.079,type:"hotspot",pos:0},{l:.941,c:.149,type:"hotspot",pos:0},{l:.604,c:.321,type:"main",pos:0},{l:.551,c:.301,type:"main",pos:.0264},{l:.461,c:.251,type:"main",pos:.0366},{l:.416,c:.226,type:"main",pos:.0425},{l:.351,c:.191,type:"main",pos:.0594},{l:.291,c:.121,type:"main",pos:.0739},{l:.074,c:0,type:"darkedge",pos:.4266},{l:0,c:0,type:"blackedge",pos:1}],qt)},{power:ll,stops:mi([{l:.976,c:.079,type:"hotspot",pos:0},{l:.941,c:.149,type:"hotspot",pos:.01},{l:.604,c:.321,type:"main",pos:.0495},{l:.551,c:.301,type:"main",pos:.0943},{l:.461,c:.251,type:"main",pos:.1503},{l:.416,c:.226,type:"main",pos:.1793},{l:.351,c:.191,type:"main",pos:.2321},{l:.291,c:.121,type:"main",pos:.447},{l:.074,c:0,type:"darkedge",pos:.8361},{l:0,c:0,type:"blackedge",pos:1}],qt)},{power:cl,stops:mi([{l:.976,c:.079,type:"hotspot",pos:.01},{l:.941,c:.149,type:"hotspot",pos:.04},{l:.604,c:.321,type:"main",pos:.08},{l:.551,c:.301,type:"main",pos:.2533},{l:.461,c:.251,type:"main",pos:.35},{l:.416,c:.226,type:"main",pos:.4},{l:.351,c:.191,type:"main",pos:.57},{l:.291,c:.121,type:"main",pos:.67},{l:.074,c:0,type:"darkedge",pos:.93},{l:0,c:0,type:"blackedge",pos:1}],qt)},{power:dl,stops:mi([{l:.976,c:.079,type:"hotspot",pos:.01},{l:.941,c:.149,type:"hotspot",pos:.06},{l:.604,c:.321,type:"main",pos:.1006},{l:.551,c:.301,type:"main",pos:.3011},{l:.461,c:.251,type:"main",pos:.4498},{l:.416,c:.226,type:"main",pos:.5834},{l:.351,c:.191,type:"main",pos:.7228},{l:.291,c:.121,type:"main",pos:.8371},{l:.074,c:0,type:"darkedge",pos:.9626},{l:0,c:0,type:"blackedge",pos:1}],qt)},{power:hl,stops:mi([{l:.976,c:.079,type:"hotspot",pos:.01},{l:.941,c:.149,type:"hotspot",pos:.0665},{l:.604,c:.321,type:"main",pos:.1248},{l:.551,c:.301,type:"main",pos:.3302},{l:.461,c:.251,type:"main",pos:.4823},{l:.416,c:.226,type:"main",pos:.6383},{l:.351,c:.191,type:"main",pos:.7547},{l:.291,c:.121,type:"main",pos:.8908},{l:.074,c:0,type:"darkedge",pos:.9775},{l:0,c:0,type:"blackedge",pos:1}],qt)}],fl=Oo[0].stops.length,pl=150,_l=40,gl=15,ml=20,Dl=50,El=150,Sl=530,Tl=370,O={DIMLY_LIT:{amplitudeEnd:.8,glowFinalOpacity:.2,glowFinalSize:"2px"},FULLY_LIT_UNSELECTED:{amplitudeEnd:.95,glowFinalOpacity:.6,glowFinalSize:"9px"},FULLY_LIT_SELECTED:{amplitudeEnd:1,glowFinalOpacity:.8,glowFinalSize:"13px"}},vr={textFlickerToDimlyLit:{numCycles:8,periodStart:.15,periodEnd:.05,onDurationRatio:.45,amplitudeStart:0,amplitudeEnd:O.DIMLY_LIT.amplitudeEnd,glow:{initialOpacity:0,peakOpacity:.4,finalOpacity:O.DIMLY_LIT.glowFinalOpacity,initialSize:"0px",peakSize:"3px",finalSize:O.DIMLY_LIT.glowFinalSize,colorVar:"--terminal-text-glow-color",scaleWithAmplitude:!0,animatedProperties:{opacity:"--terminal-text-glow-opacity",blur:"--terminal-text-bloom-size"}},targetProperty:"text-shadow-opacity-and-blur"},lcdScreenFlickerToDimlyLit:{numCycles:8,periodStart:.15,periodEnd:.05,onDurationRatio:.45,amplitudeStart:0,amplitudeEnd:O.DIMLY_LIT.amplitudeEnd,glow:{initialOpacity:0,peakOpacity:.4,finalOpacity:O.DIMLY_LIT.glowFinalOpacity,initialSize:"0px",peakSize:"9px",finalSize:O.DIMLY_LIT.glowFinalSize,colorVar:"--lcd-glow-color",sizeVar:"--lcd-glow-size",opacityVar:"--lcd-glow-opacity",scaleWithAmplitude:!0},targetProperty:"element-opacity-and-box-shadow"},buttonFlickerToDimlyLit:{numCycles:8,periodStart:.15,periodEnd:.05,onDurationRatio:.45,amplitudeStart:0,amplitudeEnd:O.DIMLY_LIT.amplitudeEnd,glow:{initialOpacity:0,peakOpacity:.35,finalOpacity:O.DIMLY_LIT.glowFinalOpacity,initialSize:"0px",peakSize:"6px",finalSize:O.DIMLY_LIT.glowFinalSize,colorVar:"--btn-dimly-lit-glow-color",sizeVar:"--btn-dimly-lit-glow-size",opacityVar:"--btn-dimly-lit-glow-opacity",scaleWithAmplitude:!0},targetProperty:"button-lights-and-frame"},buttonFlickerFromDimlyLitToFullyLitUnselected:{numCycles:7,periodStart:.1,periodEnd:.04,onDurationRatio:.4,amplitudeStart:O.DIMLY_LIT.amplitudeEnd,amplitudeEnd:O.FULLY_LIT_UNSELECTED.amplitudeEnd,glow:{initialOpacity:O.DIMLY_LIT.glowFinalOpacity,peakOpacity:.8,finalOpacity:O.FULLY_LIT_UNSELECTED.glowFinalOpacity,initialSize:O.DIMLY_LIT.glowFinalSize,peakSize:"12px",finalSize:O.FULLY_LIT_UNSELECTED.glowFinalSize,colorVar:"--btn-glow-color",sizeVar:"--btn-glow-size",opacityVar:"--btn-glow-opacity",scaleWithAmplitude:!1},targetProperty:"button-lights-and-frame"},buttonFlickerFromDimlyLitToFullyLitSelected:{numCycles:7,periodStart:.1,periodEnd:.04,onDurationRatio:.4,amplitudeStart:O.DIMLY_LIT.amplitudeEnd,amplitudeEnd:O.FULLY_LIT_SELECTED.amplitudeEnd,glow:{initialOpacity:O.DIMLY_LIT.glowFinalOpacity,peakOpacity:1,finalOpacity:O.FULLY_LIT_SELECTED.glowFinalOpacity,initialSize:O.DIMLY_LIT.glowFinalSize,peakSize:"20px",finalSize:O.FULLY_LIT_SELECTED.glowFinalSize,colorVar:"--btn-glow-color",sizeVar:"--btn-glow-size",opacityVar:"--btn-glow-opacity",scaleWithAmplitude:!1},targetProperty:"button-lights-and-frame"},buttonFlickerFromDimlyLitToFullyLitUnselectedFast:{numCycles:5,periodStart:.08,periodEnd:.03,onDurationRatio:.4,amplitudeStart:O.DIMLY_LIT.amplitudeEnd,amplitudeEnd:O.FULLY_LIT_UNSELECTED.amplitudeEnd,glow:{initialOpacity:O.DIMLY_LIT.glowFinalOpacity,peakOpacity:.8,finalOpacity:O.FULLY_LIT_UNSELECTED.glowFinalOpacity,initialSize:O.DIMLY_LIT.glowFinalSize,peakSize:"10px",finalSize:O.FULLY_LIT_UNSELECTED.glowFinalSize,colorVar:"--btn-glow-color",sizeVar:"--btn-glow-size",opacityVar:"--btn-glow-opacity",scaleWithAmplitude:!1},targetProperty:"button-lights-and-frame"},buttonFlickerFromDimlyLitToFullyLitSelectedFast:{numCycles:5,periodStart:.08,periodEnd:.03,onDurationRatio:.4,amplitudeStart:O.DIMLY_LIT.amplitudeEnd,amplitudeEnd:O.FULLY_LIT_SELECTED.amplitudeEnd,glow:{initialOpacity:O.DIMLY_LIT.glowFinalOpacity,peakOpacity:.9,finalOpacity:O.FULLY_LIT_SELECTED.glowFinalOpacity,initialSize:O.DIMLY_LIT.glowFinalSize,peakSize:"18px",finalSize:O.FULLY_LIT_SELECTED.glowFinalSize,colorVar:"--btn-glow-color",sizeVar:"--btn-glow-size",opacityVar:"--btn-glow-opacity",scaleWithAmplitude:!1},targetProperty:"button-lights-and-frame"},buttonFlickerFromUnlitToFullyLitUnselected:{numCycles:9,periodStart:.18,periodEnd:.07,onDurationRatio:.35,amplitudeStart:0,amplitudeEnd:O.FULLY_LIT_UNSELECTED.amplitudeEnd,glow:{initialOpacity:0,peakOpacity:.9,finalOpacity:O.FULLY_LIT_UNSELECTED.glowFinalOpacity,initialSize:"0px",peakSize:"16px",finalSize:O.FULLY_LIT_UNSELECTED.glowFinalSize,colorVar:"--btn-glow-color",sizeVar:"--btn-glow-size",opacityVar:"--btn-glow-opacity",scaleWithAmplitude:!1},targetProperty:"button-lights-and-frame"},buttonFlickerFromUnlitToFullyLitSelected:{numCycles:9,periodStart:.18,periodEnd:.07,onDurationRatio:.35,amplitudeStart:0,amplitudeEnd:O.FULLY_LIT_SELECTED.amplitudeEnd,glow:{initialOpacity:0,peakOpacity:1,finalOpacity:O.FULLY_LIT_SELECTED.glowFinalOpacity,initialSize:"0px",peakSize:"20px",finalSize:O.FULLY_LIT_SELECTED.glowFinalSize,colorVar:"--btn-glow-color",sizeVar:"--btn-glow-size",opacityVar:"--btn-glow-opacity",scaleWithAmplitude:!1},targetProperty:"button-lights-and-frame"}};function yl(r){const e=vr[r];if(!e)return .2;let t=0;for(let n=0;n<e.numCycles;n++){const s=e.numCycles>1?n/(e.numCycles-1):1,a=e.periodStart+s*(e.periodEnd-e.periodStart);t+=a}const i=Math.max(.15,e.periodEnd*1.5);return t+=i,t}const zt=Object.freeze(Object.defineProperty({__proto__:null,ADVANCED_FLICKER_PROFILES:vr,APP_LOAD_FADE_IN_DURATION:Gu,AUTO_PLAY_START_DELAY:Uu,BODY_FADE_IN_DURATION:Hu,DEBOUNCE_DELAY:No,DEFAULT_ASSIGNMENT_SELECTIONS:ke,DEFAULT_DIAL_A_HUE:kt,DIAL_B_VISUAL_ROTATION_PER_HUE_DEGREE_CONFIG:wu,DIAL_GRADIENT_SCALE_FACTOR:Ru,GSAP_BUTTON_IDLE_DURATION_MAX:Bu,GSAP_BUTTON_IDLE_DURATION_MIN:xu,GSAP_BUTTON_IDLE_EASE:ku,GSAP_TWEEN_DURATION:Fu,GSAP_TWEEN_EASE:Mu,HIGHLIGHT_WIDTH_FACTOR:bu,HUE_ASSIGNMENT_ROW_HUES:ee,HUE_UPDATE_THRESHOLD:Nu,LCD_TEXT_FADE_IN_DURATION:Ku,LENS_GRADIENT_BREAKPOINTS:Oo,LENS_GRADIENT_POSITION_SCALE:qt,LENS_HOTSPOT_HUE_OFFSET:al,LENS_OSCILLATION_AMPLITUDE_MAX_ADDITION:rl,LENS_OSCILLATION_AMPLITUDE_MIN:nl,LENS_OSCILLATION_PERIOD_AT_MAX_POWER:ol,LENS_OSCILLATION_PERIOD_AT_THRESHOLD:sl,LENS_OSCILLATION_RESTART_DELAY:il,LENS_OSCILLATION_SMOOTHING_DURATION:tl,LENS_OSCILLATION_THRESHOLD:el,LENS_STARTUP_RAMP_DURATION:Lo,LENS_STARTUP_TARGET_POWER:$u,MIN_PHASE_DURATION_FOR_STEPPING:Xu,NUM_LENS_GRADIENT_STOPS:fl,NUM_RIDGES:Lu,P3_LENS_RAMP_DURATION_S:Vu,P4_BUTTON_FADE_STAGGER:zu,P4_LCD_FADE_STAGGER:Yu,P6_BUTTON_ENERGIZE_FLICKER_STAGGER:Wu,PIXELS_PER_DEGREE_HUE:vu,PIXELS_PER_DEGREE_ROTATION:Pu,RIDGE_WIDTH_FACTOR:Ou,STARTUP_DIM_FACTORS_ANIMATION_DURATION:Ju,STARTUP_L_REDUCTION_FACTORS:Qu,SYSTEM_READY_PHASE_DURATION:qu,TERMINAL_CURSOR_BLINK_OFF_MS:Tl,TERMINAL_CURSOR_BLINK_ON_MS:Sl,TERMINAL_MAX_LINES_IN_DOM:pl,TERMINAL_NEW_LINE_DELAY_MAX_MS:El,TERMINAL_NEW_LINE_DELAY_MIN_MS:Dl,TERMINAL_TYPING_SPEED_BLOCK_MS_PER_CHAR:gl,TERMINAL_TYPING_SPEED_STARTUP_MS_PER_CHAR:ml,TERMINAL_TYPING_SPEED_STATUS_MS_PER_CHAR:_l,THEME_TRANSITION_DURATION:ju,estimateFlickerDuration:yl,selectorsForDimExitAnimation:Zu},Symbol.toStringTag,{value:"Module"}));function bo(r,e){let t;return function(...n){const s=this,a=()=>{t=null,r.apply(s,n)};clearTimeout(t),t=setTimeout(a,e)}}function Al(r,e,t,i,n){return(r-e)*(n-i)/(t-e)+i}function Cl(r){for(let e=r.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[r[e],r[t]]=[r[t],r[e]]}return r}class Il{constructor(){this.events={}}on(e,t){return this.events[e]||(this.events[e]=[]),this.events[e].push(t),()=>{this.off(e,t)}}off(e,t){this.events[e]&&(this.events[e]=this.events[e].filter(i=>i!==t))}}const Xn=new Il;function St(r,e){let t=e;e&&typeof e=="object"&&Object.keys(e).length>3&&(t=`{ ${Object.keys(e).join(", ")}, ... }`),console.log(`[AppState EMIT] Event: '${r}'. Payload:`,t!==void 0?t:"N/A",e!==void 0&&t!==e?{fullPayload:e}:""),Xn.events[r]&&Xn.events[r].forEach(i=>{try{i(e)}catch(n){console.error(`[AppState EMIT] Error in listener for '${r}':`,n,{payload:e})}})}let J={A:{id:"A",hue:kt,rotation:0,targetHue:kt,targetRotation:0,isDragging:!1},B:{id:"B",hue:0,rotation:0,targetHue:0,targetRotation:0,isDragging:!1}},sn={env:{hue:ee[ke.env],isColorless:ee[ke.env]===ee[0]},lcd:{hue:ee[ke.lcd],isColorless:ee[ke.lcd]===ee[0]},logo:{hue:ee[ke.logo],isColorless:ee[ke.logo]===ee[0]},btn:{hue:ee[ke.btn],isColorless:ee[ke.btn]===ee[0]}},It="dim",Xt=0,Kt="idle",Pt="loading";function nt(r){const e=J[r];if(!e){console.warn(`[AppState GET] Target: Dial '${r}'. Requested: State. Actual: Undefined (not initialized).`);return}return{...e}}function Nr(r){const e=sn[r];if(!e){console.warn(`[AppState GET] Target: TargetColor '${r}'. Requested: Properties. Actual: Undefined (invalid key).`);return}return{...e}}function Lr(){return It}function rt(){return Xt}function gn(){return Kt}function j(){return Pt}function mn(r,e){const t=!J[r]||Object.keys(J[r]).length===0;t&&(r==="A"||r==="B")&&(J[r]={id:r,hue:r==="A"?kt:0,rotation:0,targetHue:r==="A"?kt:0,targetRotation:0,isDragging:!1},console.log(`[AppState SET] Target: Dial '${r}'. Requested: Initialization. Actual (New State):`,JSON.parse(JSON.stringify(J[r]))));const i={...J[r]};Object.assign(J[r],e),(t||i.hue!==J[r].hue||i.rotation!==J[r].rotation||i.isDragging!==J[r].isDragging||i.targetHue!==J[r].targetHue||i.targetRotation!==J[r].targetRotation)&&(console.log(`[AppState SET] Target: Dial '${r}'. Requested (Changes):`,JSON.parse(JSON.stringify(e)),"Old State:",JSON.parse(JSON.stringify(i)),"Actual (New State):",JSON.parse(JSON.stringify(J[r]))),St("dialUpdated",{id:r,state:{...J[r]}}))}function Kn(r,e){if(sn.hasOwnProperty(r)){const t=(Number(e)%360+360)%360,i=ee.length>0&&t===ee[0],n=sn[r];if(n.hue!==t||n.isColorless!==i){const s={...n};n.hue=t,n.isColorless=i,console.log(`[AppState SET] Target: TargetColor '${r}'. Requested Hue: ${e}, Normalized: ${t}. Old Props:`,s,"Actual (New Props):",{...n}),St("targetColorChanged",{targetKey:r,hue:t,isColorless:i})}}else console.warn(`[AppState SET] Target: TargetColor '${r}'. Requested Hue: ${e}. Error: Invalid targetKey.`)}function Ro(r){if(["dim","dark","light"].includes(r)&&It!==r){const e=It;It=r,console.log(`[AppState SET] Target: Theme. Requested: '${r}'. Old: '${e}', Actual (New): '${It}'`),St("themeChanged",It)}}function Qn(r){const e=Math.max(0,Math.min(r/100,1));if(Math.abs(Xt-e)>1e-4){const t=Xt;Xt=e,console.log(`[AppState SET] Target: TrueLensPower. Requested: ${r}%. Old: ${t.toFixed(3)}, Actual (New): ${Xt.toFixed(3)} (0-1 scale)`),St("trueLensPowerChanged",Xt)}}function Pl(r){if(["idle","dragging","settling"].includes(r)&&Kt!==r){const e=Kt;Kt=r,console.log(`[AppState SET] Target: DialBInteractionState. Requested: '${r}'. Old: '${e}', Actual (New): '${Kt}'`),St("dialBInteractionChange",Kt)}}function wo(r){if(["loading","starting-up","interactive","error"].includes(r)&&Pt!==r){const e=Pt;Pt=r,console.log(`[AppState SET] Target: AppStatus. Requested: '${r}'. Old: '${e}', Actual (New): '${Pt}'`),St("appStatusChanged",Pt)}}function Oe(r,e){return typeof e!="function"?(console.error(`[AppState Subscribe] Listener for event '${r}' is not a function.`),()=>{}):Xn.on(r,e)}(!J.A||Object.keys(J.A).length===0)&&mn("A",{hue:kt,rotation:0,targetHue:kt,targetRotation:0,isDragging:!1});(!J.B||Object.keys(J.B).length===0)&&mn("B",{hue:0,rotation:0,targetHue:0,targetRotation:0,isDragging:!1});console.log("[AppState INIT] Initialized with default states:",{dials:JSON.parse(JSON.stringify(J)),targetColorProps:JSON.parse(JSON.stringify(sn)),currentTheme:It,appStatus:Pt});const Di=Object.freeze(Object.defineProperty({__proto__:null,emit:St,getAppStatus:j,getCurrentTheme:Lr,getDialBInteractionState:gn,getDialState:nt,getTargetColorProperties:Nr,getTrueLensPower:rt,setAppStatus:wo,setDialBInteractionState:Pl,setTargetColorProperties:Kn,setTheme:Ro,setTrueLensPower:Qn,subscribe:Oe,updateDialState:mn},Symbol.toStringTag,{value:"Module"}));class vl{constructor(e,t,i,n,s,a){if(this.element=e,this.config=t,this.gsap=i,this.appState=n,this.configModule=s,this.uiUpdater=a,!this.gsap)throw new Error(`[Button CONSTRUCTOR ${this.getIdentifier()}] GSAP instance is not available.`);this.currentClasses=new Set,this.currentFlickerAnim=null,this._pressTimeoutId=null,this._isSelected=t.isSelectedByDefault||!1,console.log(`[Button CONSTRUCTOR - ${this.getIdentifier()}] ID: ${this.element.id}, AriaLabel: ${this.element.ariaLabel}, Group: ${this.config.groupId}, Value: ${this.config.value}, isSelectedByDefault: ${t.isSelectedByDefault}, Initial _isSelected: ${this._isSelected}`),this._updateAriaAttributes()}getIdentifier(){return this.element.ariaLabel||this.element.id||this.config.value||`UnnamedButton_${this.config.groupId}_${this.config.type}`}setState(e,t={}){const{skipAria:i=!1,internalFlickerCall:n=!1,forceState:s=!1,phaseContext:a}=t,o=a||"UnknownPhase_ButtonSetState",u=this.getIdentifier(),l=e?e.split(" ").filter(_=>_):[],c=new Set(l);console.log(`[Button setState - ${u}] ENTER. Requested state string: '${e}'. Current _isSelected: ${this._isSelected}. PhaseContext: ${o}. Current DOM classes: '${this.element.className}'`);let d=s;if(!d){const _=new Set;Object.values(b).flatMap(g=>g.split(" ")).forEach(g=>{this.element.classList.contains(g)&&_.add(g)});const f=new Set(l);if(this._isSelected?f.add("is-selected"):f.delete("is-selected"),_.size!==f.size)d=!0;else for(const g of f)if(!_.has(g)){d=!0;break}}if(!d&&!s){console.log(`[Button setState - ${u}] No actual class change needed for '${e}', _isSelected: ${this._isSelected}. DOM classes already reflect target. Skipping full update.`),i||this._updateAriaAttributes();return}if(console.log(`[Button setState - ${u}] Proceeding with state update. stateChanged: ${d}, forceState: ${s}`),!n&&this.currentFlickerAnim&&this.currentFlickerAnim.isActive()&&(console.log(`[Button setState - ${u}] Killing active flicker animation.`),this.currentFlickerAnim.kill(),this.currentFlickerAnim=null),!n){this.element.classList.remove(b.FLICKERING);const _=Array.from(this.element.querySelectorAll(".light"));_.length>0&&this.gsap.set(_,{clearProps:"all"}),this.gsap.set(this.element,{clearProps:"css"}),console.log(`[Button setState - ${u}] Cleared GSAP props (not internal flicker call).`)}const h=Object.values(b).flatMap(_=>_.split(" ")).filter(_=>_&&_!=="is-selected");[...new Set(h)].forEach(_=>{this.element.classList.contains(_)&&this.element.classList.remove(_)}),c.forEach(_=>{_!=="is-selected"&&this.element.classList.add(_)}),console.log(`[Button setState - ${u}] BEFORE managing 'is-selected' class. _isSelected: ${this._isSelected}. Element has 'is-selected': ${this.element.classList.contains("is-selected")}`),this._isSelected?this.element.classList.add("is-selected"):this.element.classList.remove("is-selected"),console.log(`[Button setState - ${u}] AFTER managing 'is-selected' class. Element has 'is-selected': ${this.element.classList.contains("is-selected")}`),this.currentClasses.clear(),this.element.classList.forEach(_=>this.currentClasses.add(_)),console.log(`[Button setState - ${u}] Final DOM classes: '${this.element.className}'. Final internal currentClasses: '${Array.from(this.currentClasses).join(" ")}'`),i||this._updateAriaAttributes()}_updateAriaAttributes(){const e=this._isSelected;this.config.type==="toggle"?this.element.setAttribute("aria-pressed",e.toString()):this.config.type==="radio"&&this.element.setAttribute("aria-checked",e.toString());const t=Array.from(this.currentClasses).some(i=>i===b.ENERGIZED_UNSELECTED.split(" ")[0]||i===b.DIMLY_LIT.split(" ")[0]);this.element.setAttribute("tabindex",t?"0":"-1")}getElement(){return this.element}getGroupId(){return this.config.groupId}getValue(){return this.config.value}getCurrentClasses(){return new Set(this.element.classList)}getCurrentStateClasses(){return Array.from(this.element.classList).join(" ")}isSelected(){return this._isSelected}setSelected(e,t={}){const{skipAnimation:i=!1,themeContext:n="theme-dark",phaseContext:s="ButtonSetSelected"}=t,a=this.getIdentifier();if(console.log(`[Button setSelected - ${a}] ENTER. Target selected: ${e}. Current _isSelected: ${this._isSelected}. PhaseContext: ${s}. Current DOM classes: '${this.element.className}'`),this._isSelected===e){console.log(`[Button setSelected - ${a}] _isSelected already matches target (${e}). Checking if DOM class 'is-selected' needs update.`);let l=!1;if(e&&!this.element.classList.contains("is-selected")&&(l=!0,console.log(`[Button setSelected - ${a}] DOM needs 'is-selected' added.`)),!e&&this.element.classList.contains("is-selected")&&(l=!0,console.log(`[Button setSelected - ${a}] DOM needs 'is-selected' removed.`)),!l){console.log(`[Button setSelected - ${a}] No change to _isSelected or DOM 'is-selected' class needed. Returning.`);return}}else this._isSelected=e,console.log(`[Button setSelected - ${a}] Updated _isSelected to: ${this._isSelected}`);let o=b.ENERGIZED_UNSELECTED;this.element.classList.contains(b.DIMLY_LIT.split(" ")[0])?o=b.DIMLY_LIT_UNSELECTED:this.element.classList.contains(b.UNLIT.split(" ")[0])?o=b.UNLIT:this.element.classList.contains(b.ENERGIZED_UNSELECTED.split(" ")[0])&&(o=b.ENERGIZED_UNSELECTED);let u=o;this._isSelected?o===b.DIMLY_LIT_UNSELECTED?u=b.DIMLY_LIT_SELECTED:(o===b.ENERGIZED_UNSELECTED||o===b.UNLIT)&&(u=b.ENERGIZED_SELECTED):o===b.DIMLY_LIT_SELECTED?u=b.DIMLY_LIT_UNSELECTED:o===b.ENERGIZED_SELECTED&&(u=b.ENERGIZED_UNSELECTED),console.log(`[Button setSelected - ${a}] Determined targetStateClasses for setState: '${u}' based on new _isSelected: ${this._isSelected} and base: '${o}'`),this.setState(u,{skipAnimation:i,themeContext:n,phaseContext:s,forceState:!0})}handleInteraction(e){const t=this.getIdentifier();console.log(`[Button handleInteraction - ${t}] Event: ${e}, Type: ${this.config.type}, Current _isSelected: ${this._isSelected}`),this.config.type==="toggle"?this.setSelected(!this._isSelected,{themeContext:this.appState.getCurrentTheme(),phaseContext:`ToggleInteract_${t}`}):this.config.type==="radio"?this._isSelected||this.setSelected(!0,{themeContext:this.appState.getCurrentTheme(),phaseContext:`RadioInteract_${t}`}):this.config.type==="action"&&console.log(`[Button handleInteraction - ${t}] Action triggered.`)}setPressedVisuals(e){if(this.getIdentifier(),this._pressTimeoutId&&this.element.classList.contains(b.PRESSING)&&!e&&(clearTimeout(this._pressTimeoutId),this._pressTimeoutId=null),e){this.element.classList.add(b.PRESSING);const t=getComputedStyle(this.element).getPropertyValue("--button-unit-pressed-effect-duration-css").trim()||"0.12s",i=parseFloat(t)*(t.endsWith("ms")?1:1e3);this._pressTimeoutId=setTimeout(()=>{this.element.classList.remove(b.PRESSING),this._pressTimeoutId=null},i+50)}else this.element.classList.remove(b.PRESSING)}destroy(){const e=this.getIdentifier();this.currentFlickerAnim&&this.currentFlickerAnim.isActive()&&this.currentFlickerAnim.kill(),this._pressTimeoutId&&clearTimeout(this._pressTimeoutId),console.log(`[Button DESTROY - ${e}] Destroyed.`)}}function ot(r,e,t=0){if(!r)return t;const i=r[e];return typeof i=="object"&&i!==null&&r.hasOwnProperty("isButtonSelected")&&(Object.prototype.hasOwnProperty.call(i,"selected")||Object.prototype.hasOwnProperty.call(i,"unselected"))?r.isButtonSelected?i.selected:i.unselected:i!==void 0?i:t}function on(r,e,t={}){var T,A,S,C,I;const i=typeof e=="string"?e:"CustomProfile",n=r&&r.length>0&&r[0]?r[0].id||r[0].className.split(" ")[0]||r[0].tagName:"unknownTarget",a={...{lightTargetSelector:".light",overrideGlowParams:{},onStart:null,onTimelineComplete:null,onUpdate:null},...t};let o=typeof e=="string"?{...vr[e]}:{...e};const u=new Promise(E=>{a.gsapInternalOnComplete=()=>{E()}});if(!o||Object.keys(o).length===0){console.warn(`[CAF - ${i} for ${n}] Profile not found or empty. Returning empty, resolved flicker.`);const E=he.timeline();return E.eventCallback("onComplete",()=>{a.onTimelineComplete&&a.onTimelineComplete(),a.gsapInternalOnComplete()}),E.to({},{duration:.001}),{timeline:E,completionPromise:u}}o.glow={...o.glow||{}},a.overrideGlowParams.hasOwnProperty("isButtonSelected")&&(o.glow.isButtonSelected=a.overrideGlowParams.isButtonSelected);const l=Array.isArray(r)?r.filter(E=>E):r?[r]:[];if(l.length===0){console.warn(`[CAF - ${i}] No valid target elements. Returning empty, resolved flicker.`);const E=he.timeline();return E.eventCallback("onComplete",()=>{a.onTimelineComplete&&a.onTimelineComplete(),a.gsapInternalOnComplete()}),E.to({},{duration:.001}),{timeline:E,completionPromise:u}}const c=he.timeline({onStart:()=>{a.onStart&&a.onStart()},onComplete:()=>{a.onTimelineComplete&&a.onTimelineComplete(),a.gsapInternalOnComplete()},onUpdate:a.onUpdate});let d=l;if(o.targetProperty==="button-lights-and-frame"){const E=[];l.forEach(y=>{const N=y.querySelectorAll(a.lightTargetSelector);N.length>0&&E.push(...Array.from(N))}),E.length>0&&(d=E,he.killTweensOf(d),he.set(d,{clearProps:"all",overwrite:!0}))}else(o.targetProperty==="text-shadow-opacity-and-blur"||o.targetProperty==="element-opacity-and-box-shadow")&&(d=l,he.killTweensOf(d));if(o.amplitudeStart!==void 0&&o.amplitudeStart<=.01&&(!o.glow||o.glow.initialOpacity===void 0||o.glow.initialOpacity<=.01)){if(d.length>0&&c.set(d,{autoAlpha:0,immediateRender:!0}),o.glow&&(o.glow.opacityVar||(T=o.glow.animatedProperties)!=null&&T.opacity)){const E={};o.glow.opacityVar&&(E[o.glow.opacityVar]=0),(A=o.glow.animatedProperties)!=null&&A.opacity&&(E[o.glow.animatedProperties.opacity]=0),o.glow.sizeVar&&(E[o.glow.sizeVar]="0px"),(S=o.glow.animatedProperties)!=null&&S.blur&&(E[o.glow.animatedProperties.blur]="0px"),Object.keys(E).length>0&&c.set(l,{css:E,immediateRender:!0})}}else{if(d.length>0){const E=o.amplitudeStart!==void 0?o.amplitudeStart:0;c.set(d,{autoAlpha:E,immediateRender:!0})}if(o.glow&&(o.glow.colorVar||o.glow.animatedProperties)){const E={},y=ot(o.glow,"initialOpacity",0),N=ot(o.glow,"initialSize","0px");o.glow.opacityVar&&(E[o.glow.opacityVar]=y),o.glow.sizeVar&&(E[o.glow.sizeVar]=typeof N=="number"?`${N}px`:N),(C=o.glow.animatedProperties)!=null&&C.opacity&&(E[o.glow.animatedProperties.opacity]=y),(I=o.glow.animatedProperties)!=null&&I.blur&&(E[o.glow.animatedProperties.blur]=typeof N=="number"?`${N}px`:N),Object.keys(E).length>0&&c.set(l,{css:E,immediateRender:!0})}}let p=0,_=.01;for(let E=0;E<o.numCycles;E++){const y=o.numCycles>1?E/(o.numCycles-1):1,N=o.periodStart+y*(o.periodEnd-o.periodStart),w=Math.max(.01,N*o.onDurationRatio),F=Math.max(.01,N*(1-o.onDurationRatio)),M=o.amplitudeStart+y*(o.amplitudeEnd-o.amplitudeStart);_=w;const X=ot(o.glow,"peakOpacity",1),k=ot(o.glow,"peakSize","5px"),Y={autoAlpha:M,duration:w,ease:"power1.inOut"},U={};if(o.glow&&(o.glow.colorVar||o.glow.animatedProperties)){const de=o.glow.scaleWithAmplitude?X*M:X;o.glow.opacityVar&&(U[o.glow.opacityVar]=de),o.glow.sizeVar&&(U[o.glow.sizeVar]=typeof k=="number"?`${k}px`:k),o.glow.animatedProperties&&(o.glow.animatedProperties.opacity&&(U[o.glow.animatedProperties.opacity]=de),o.glow.animatedProperties.blur&&(U[o.glow.animatedProperties.blur]=typeof k=="number"?`${k}px`:k))}if(d.length>0&&c.to(d,Y,p),Object.keys(U).length>0&&c.to(l,{css:U,duration:w,ease:"power1.inOut"},p),p+=w,E<o.numCycles-1){const $t={autoAlpha:o.amplitudeStart>0?o.amplitudeStart*.3:0,duration:F,ease:"power1.inOut"},ve={},st=ot(o.glow,"initialOpacity",0),pe=ot(o.glow,"initialSize","0px");o.glow&&(o.glow.colorVar||o.glow.animatedProperties)&&(o.glow.opacityVar&&(ve[o.glow.opacityVar]=st),o.glow.sizeVar&&(ve[o.glow.sizeVar]=typeof pe=="number"?`${pe}px`:pe),o.glow.animatedProperties&&(o.glow.animatedProperties.opacity&&(ve[o.glow.animatedProperties.opacity]=st),o.glow.animatedProperties.blur&&(ve[o.glow.animatedProperties.blur]=typeof pe=="number"?`${pe}px`:pe))),d.length>0&&c.to(d,$t,p),Object.keys(ve).length>0&&c.to(l,{css:ve,duration:F,ease:"power1.inOut"},p),p+=F}}const f=Math.max(.15,o.periodEnd*1.5),g={autoAlpha:o.amplitudeEnd,duration:f,ease:"sine.out"},m={};if(o.glow&&(o.glow.colorVar||o.glow.animatedProperties)){const E=ot(o.glow,"finalOpacity",0),y=ot(o.glow,"finalSize","0px");o.glow.opacityVar&&(m[o.glow.opacityVar]=E),o.glow.sizeVar&&(m[o.glow.sizeVar]=typeof y=="number"?`${y}px`:y),o.glow.animatedProperties&&(o.glow.animatedProperties.opacity&&(m[o.glow.animatedProperties.opacity]=E),o.glow.animatedProperties.blur&&(m[o.glow.animatedProperties.blur]=typeof y=="number"?`${y}px`:y))}const D=_*.3;return d.length>0&&c.to(d,g,`>-=${D}`),Object.keys(m).length>0&&c.to(l,{css:m,duration:f,ease:"sine.out"},"<"),c.duration()===0&&c.to({},{duration:.001}),{timeline:c,completionPromise:u}}const b={UNLIT:"is-unlit",DIMLY_LIT:"is-dimly-lit",ENERGIZED_UNSELECTED:"is-energized",ENERGIZED_SELECTED:"is-energized is-selected",DIMLY_LIT_UNSELECTED:"is-dimly-lit",DIMLY_LIT_SELECTED:"is-dimly-lit is-selected",PRESSING:"is-pressing",FLICKERING:"is-flickering"};class Nl{constructor(e,t,i,n){this.gsap=e,this.appState=t,this.config=i,this.uiUpdater=n,this._buttons=new Map,this._buttonGroups=new Map,this.debug=!0}init(e,t){this.gsap=t||this.gsap,this.debug&&console.log("[ButtonManager INIT] Initializing buttons:",e==null?void 0:e.length),e&&e.length>0&&e.forEach(i=>{this.addButton(i)}),this.setInitialDimStates()}addButton(e,t=null){if(!e||this._buttons.has(e))return;const i=this._generateButtonConfig(e,t),n=new vl(e,i,this.gsap,this.appState,this.config,this.uiUpdater);this._buttons.set(e,n);const s=n.getGroupId();s&&(this._buttonGroups.has(s)||this._buttonGroups.set(s,new Set),this._buttonGroups.get(s).add(n))}_generateButtonConfig(e,t=null){var o;const i=e.classList.contains("button-unit--toggle")?"toggle":e.classList.contains("button-unit--action")?"action":e.classList.contains("button-unit--radio")?"radio":"default";let n=t;if(!n&&(n=((o=e.closest("[data-group-id]"))==null?void 0:o.dataset.groupId)||null,!n&&i==="radio")){const u=e.closest('[role="radiogroup"]');u&&(n=u.dataset.assignmentTarget||u.id||`radio-group-${[...this._buttonGroups.keys()].length}`)}const s=e.dataset.toggleValue||e.dataset.value||null,a=e.classList.contains("is-selected");return{type:i,groupId:n,value:s,isSelectedByDefault:a}}getButtonInstance(e){return this._buttons.get(e)}setInitialDimStates(){this.debug&&console.log("[BM setInitialDimStates] Setting initial states for all buttons to UNLIT."),this._buttons.forEach(e=>{const t=e.getIdentifier();e.isSelected()&&e.setSelected(!1,{skipAnimation:!0,phaseContext:`P0_ForceUnselect_${t}`}),e.setState(b.UNLIT,{skipAnimation:!0,themeContext:"theme-dim",phaseContext:`P0_InitialUnlit_BM_${t}`,forceState:!0})})}handleButtonInteraction(e,t="click"){const i=this._buttons.get(e);if(!i)return;const n=i.getIdentifier();if(this.debug&&console.log(`[BM INTERACTION] Event: ${t} on ${n}, AppStatus: ${this.appState.getAppStatus()}`),this.appState.getAppStatus()!=="interactive"&&i.getGroupId()!=="system-power"){this.debug&&console.log(`[BM INTERACTION] Blocked, app not interactive for ${n}`);return}i.handleInteraction(t);const s=i.getGroupId();s&&(i.config.type==="toggle"||i.config.type==="radio")&&i.isSelected()&&this._buttonGroups.get(s).forEach(a=>{a!==i&&a.isSelected()&&(this.debug&&console.log(`[BM INTERACTION] Deselecting other member ${a.getIdentifier()} in group ${s}`),a.setSelected(!1,{themeContext:this.appState.getCurrentTheme(),phaseContext:`GroupAutoDeselect_${a.getIdentifier()}`}))}),this.appState.emit("buttonInteracted",{buttonIdentifier:n,newState:i.getCurrentStateClasses()})}setGroupSelected(e,t){const i=this._buttonGroups.get(e);if(!i){console.warn(`[BM setGroupSelected] Group not found: ${e}`);return}this.debug&&console.log(`[BM setGroupSelected] Group: ${e}, Target: ${typeof t=="string"?t:t.ariaLabel}`),i.forEach(n=>{let s=!1;typeof t=="string"?s=n.config.value===t:s=n.element===t,n.setSelected(s,{skipAnimation:!0,themeContext:this.appState.getCurrentTheme(),phaseContext:`setGroupSelected_${e}_${n.getIdentifier()}`,forceState:!0})})}playFlickerToState(e,t,i){const n=this._buttons.get(e);if(!n)return console.warn(`[BM playFlickerToState - ${i.phaseContext}] Button instance NOT FOUND for element:`,e),{timeline:null,completionPromise:Promise.resolve()};const{profileName:s,phaseContext:a="UnknownPhase",isButtonSelectedOverride:o=null}=i,u=n.getIdentifier();let l=b.UNLIT;s.toLowerCase().includes("fromdimlylit")&&(l=b.DIMLY_LIT);let c=l;l===b.DIMLY_LIT?c=b.DIMLY_LIT_UNSELECTED:l===b.ENERGIZED_UNSELECTED&&(c=b.ENERGIZED_UNSELECTED),(c===b.DIMLY_LIT_UNSELECTED||c===b.UNLIT)&&n.isSelected()&&n.setSelected(!1,{skipAnimation:!0,phaseContext:`PreFlickerTempUnselect_${a}_${u}`,forceState:!0}),n.setState(c,{skipAnimation:!0,phaseContext:`PreFlickerForceBaseState_${a}_${u}`,forceState:!0});const d=t.includes("is-selected");let h=d;n.isSelected()!==d&&n.setSelected(d,{skipAnimation:!0,phaseContext:`PreFlickerSetFinalSelected_${a}_${u}`,forceState:!0}),typeof o=="boolean"&&(h=o);const p={...i,overrideGlowParams:{...i.overrideGlowParams||{},isButtonSelected:h},onTimelineComplete:()=>{n.setState(t,{skipAnimation:!0,themeContext:this.appState.getCurrentTheme(),phaseContext:`FlickerEnd_${a}_${u}`,forceState:!0}),i.onComplete&&i.onComplete()}};delete p.onComplete;const{timeline:_,completionPromise:f}=on(e,s,p);return{timeline:_,completionPromise:f}}flickerDimlyLitToEnergizedStartup(e){const{profileNameUnselected:t,profileNameSelected:i,stagger:n,phaseContext:s,specificGroups:a=null,targetThemeContext:o}=e,u=[];if(this._buttons.forEach(h=>{h.getCurrentClasses().has(b.DIMLY_LIT.split(" ")[0])&&(a&&Array.isArray(a)?a.includes(h.getGroupId())&&u.push(h):u.push(h))}),this.debug&&console.log(`[BM flickerDimlyLitToEnergizedStartup - ${s}] Total buttons to energize from DIMLY_LIT: ${u.length}`),u.length===0)return{masterTimeline:null,masterCompletionPromise:Promise.resolve()};Cl(u);const l=this.gsap.timeline(),c=[];u.forEach((h,p)=>{let _=b.ENERGIZED_UNSELECTED,f=t,g=!1;const m=h.getGroupId(),D=h.config.value,T=h.getIdentifier();this.config.DEFAULT_ASSIGNMENT_SELECTIONS.hasOwnProperty(m)?this.config.DEFAULT_ASSIGNMENT_SELECTIONS[m].toString()===D&&(_=b.ENERGIZED_SELECTED,f=i,g=!0):h.config.type==="toggle"&&h.config.isSelectedByDefault;const{timeline:A,completionPromise:S}=this.playFlickerToState(h.element,_,{profileName:f,phaseContext:`${s}_${T}`,isButtonSelectedOverride:g});A&&l.add(A,n*p),c.push(S)});const d=Promise.all(c).then(()=>{this.debug&&console.log(`[BM flickerDimlyLitToEnergizedStartup - ${s}] All ${u.length} button flickers completed.`)}).catch(h=>{console.error(`[BM flickerDimlyLitToEnergizedStartup - ${s}] Error during grouped flicker completion: ${h}`,h)});return{masterTimeline:l,masterCompletionPromise:d}}setButtonsToState(e,t,i={}){const{staggerTime:n=.05,phaseContext:s="BatchSetState"}=i,a=this.gsap.timeline();return e.forEach((o,u)=>{const l=this._buttons.get(o);if(l){const c=l.getIdentifier();a.call(()=>{const d=t.includes("is-selected");l.isSelected()!==d&&l.setSelected(d,{skipAnimation:!0,phaseContext:`BatchSetSelected_${s}_${c}`,forceState:!0}),l.setState(t,{themeContext:this.appState.getCurrentTheme(),phaseContext:`${s}_${c}`,forceState:!0})},null,u*n)}}),{timeline:a,completionPromise:Promise.resolve()}}setPressedVisuals(e,t){const i=this._buttons.get(e);i&&i.setPressedVisuals(t)}}class Ll{constructor(e,t,i,n,s){if(this.containerElement=e,this.dialId=t,this.appState=i,this.configModule=n,this.gsap=s,this.canvas=this.containerElement.querySelector(`#dial-canvas-${this.dialId}`),!this.canvas){console.error(`[Dial ${this.dialId} CONSTRUCTOR] Canvas element not found!`);return}if(this.ctx=this.canvas.getContext("2d"),!this.ctx){console.error(`[Dial ${this.dialId} CONSTRUCTOR] Failed to get 2D context!`);return}this.computedStyleVars={},this.isDragging=!1,this.currentPointerX=0,this.gsapValueTween=null,this.isActiveDim=!1,this.dialBSettleTimer=null,this.unsubscribers=[],this._updateAndCacheComputedStyles();let a=this.appState.getDialState(this.dialId);if(!a||Object.keys(a).length===0){const o=this.dialId==="B"?0:this.configModule.DEFAULT_DIAL_A_HUE,u=this.dialId==="B"?o*this.configModule.DIAL_B_VISUAL_ROTATION_PER_HUE_DEGREE_CONFIG:0;a={id:this.dialId,hue:o,rotation:u,targetHue:o,targetRotation:u,isDragging:!1},this.appState.updateDialState(this.dialId,a)}this.resizeCanvas(!0),this._addDragListeners(),this._subscribeToAppStateEvents()}_subscribeToAppStateEvents(){this.unsubscribers.push(this.appState.subscribe("dialUpdated",this._onAppStateDialUpdate.bind(this))),this.unsubscribers.push(this.appState.subscribe("themeChanged",this._onThemeChange.bind(this))),this.unsubscribers.push(this.appState.subscribe("appStatusChanged",this._onAppStatusChange.bind(this)))}resizeCanvas(e=!1){if(!this.canvas||!this.ctx)return!1;const t=window.devicePixelRatio||1,i=this.canvas.offsetWidth,n=this.canvas.offsetHeight;if(i===0||n===0)return!1;const s=Math.round(i*t),a=Math.round(n*t);let o=!1;return(this.canvas.width!==s||this.canvas.height!==a)&&(this.canvas.width=s,this.canvas.height=a,o=!0),(o||e)&&(this.ctx.setTransform(t,0,0,t,0,0),this._draw()),o}setActiveDimState(e){this.isActiveDim!==e&&(this.isActiveDim=e,document.body.classList.contains("theme-dim")?this.containerElement.classList.toggle("js-active-dim-dial",e):this.containerElement.classList.remove("js-active-dim-dial"),this._updateAndCacheComputedStyles(),this._draw())}_handleInteractionStart(e){if(this.appState.getAppStatus()!=="interactive"||this.isDragging)return;e.type==="touchstart"&&e.cancelable&&e.preventDefault(),this.isDragging=!0,this.gsapValueTween&&this.gsapValueTween.kill(),this.gsapValueTween=null,this.currentPointerX=e.touches?e.touches[0].clientX:e.clientX;const t=this.appState.getDialState(this.dialId);this.appState.updateDialState(this.dialId,{isDragging:!0,targetHue:t.hue,targetRotation:t.rotation}),this.dialId==="B"&&(this.dialBSettleTimer&&clearTimeout(this.dialBSettleTimer),this.appState.setDialBInteractionState("dragging")),this.containerElement.style.cursor="grabbing",document.body.style.cursor="grabbing"}_handleInteractionMove(e){if(!this.isDragging||this.appState.getAppStatus()!=="interactive")return;e.type==="touchmove"&&e.cancelable&&e.preventDefault();let t=e.touches?e.touches[0].clientX:e.clientX;const i=t-this.currentPointerX,n=this.appState.getDialState(this.dialId);let s=n.targetHue+i/this.configModule.PIXELS_PER_DEGREE_HUE;const a=n.targetRotation+i/this.configModule.PIXELS_PER_DEGREE_ROTATION;this.dialId==="B"&&(s=Math.max(0,Math.min(s,359.999))),this.currentPointerX=t,this.gsapValueTween&&this.gsapValueTween.kill();const o={hue:n.hue,rotation:n.rotation};this.gsapValueTween=this.gsap.to(o,{rotation:a,hue:s,duration:this.configModule.GSAP_TWEEN_DURATION,ease:this.configModule.GSAP_TWEEN_EASE,overwrite:"auto",onUpdate:()=>{if(!this.isDragging&&this.gsapValueTween){this.gsapValueTween.kill(),this.gsapValueTween=null;return}this.appState.updateDialState(this.dialId,{hue:o.hue,rotation:o.rotation,targetHue:s,targetRotation:a}),this.dialId==="B"&&this.appState.setTrueLensPower(o.hue/359.999*100)},onComplete:()=>{this.gsapValueTween=null}})}_handleInteractionEnd(e){if(!this.isDragging){document.body.style.cursor==="grabbing"&&(document.body.style.cursor="default");return}const t=this.dialId;this.isDragging=!1;const i=this.appState.getDialState(t);this.appState.updateDialState(t,{isDragging:!1}),this.gsapValueTween&&this.gsapValueTween.isActive()?(this.gsapValueTween.kill(),this.gsapValueTween=null,this.appState.updateDialState(t,{hue:i.targetHue,rotation:i.targetRotation}),t==="B"&&this.appState.setTrueLensPower(i.targetHue/359.999*100)):(Math.abs(i.hue-i.targetHue)>.01||Math.abs(i.rotation-i.targetRotation)>.01)&&(this.appState.updateDialState(t,{hue:i.targetHue,rotation:i.targetRotation}),t==="B"&&this.appState.setTrueLensPower(i.targetHue/359.999*100)),t==="B"&&(this.appState.setDialBInteractionState("settling"),this.dialBSettleTimer&&clearTimeout(this.dialBSettleTimer),this.dialBSettleTimer=setTimeout(()=>{this.appState.setDialBInteractionState("idle"),this.dialBSettleTimer=null},this.configModule.LENS_OSCILLATION_RESTART_DELAY)),this.containerElement.style.cursor="grab",document.body.style.cursor="default"}_addDragListeners(){this.boundHandleInteractionStart=this._handleInteractionStart.bind(this),this.boundHandleInteractionMove=this._handleInteractionMove.bind(this),this.boundHandleInteractionEnd=this._handleInteractionEnd.bind(this),this.containerElement.addEventListener("mousedown",this.boundHandleInteractionStart),this.containerElement.addEventListener("touchstart",this.boundHandleInteractionStart,{passive:!1}),window.addEventListener("mousemove",this.boundHandleInteractionMove),window.addEventListener("touchmove",this.boundHandleInteractionMove,{passive:!1}),window.addEventListener("mouseup",this.boundHandleInteractionEnd),window.addEventListener("touchend",this.boundHandleInteractionEnd),window.addEventListener("mouseleave",this.boundHandleInteractionEnd),window.addEventListener("touchcancel",this.boundHandleInteractionEnd)}_removeDragListeners(){this.containerElement.removeEventListener("mousedown",this.boundHandleInteractionStart),this.containerElement.removeEventListener("touchstart",this.boundHandleInteractionStart),window.removeEventListener("mousemove",this.boundHandleInteractionMove),window.removeEventListener("touchmove",this.boundHandleInteractionMove),window.removeEventListener("mouseup",this.boundHandleInteractionEnd),window.removeEventListener("touchend",this.boundHandleInteractionEnd),window.removeEventListener("mouseleave",this.boundHandleInteractionEnd),window.removeEventListener("touchcancel",this.boundHandleInteractionEnd)}_updateAndCacheComputedStyles(){if(!this.ctx)return;const e=getComputedStyle(document.documentElement),t=document.body.classList.contains("theme-dim");t&&this.isActiveDim?this.computedStyleVars={faceBgL:e.getPropertyValue("--dial-dim-active-face-bg-l").trim()||"0.12",faceBgC:e.getPropertyValue("--dial-dim-active-face-bg-c").trim()||"0.003",faceBgH:e.getPropertyValue("--dial-dim-active-face-bg-h").trim()||"240",ridgeL:e.getPropertyValue("--dial-dim-active-ridge-l").trim()||"0.25",ridgeC:e.getPropertyValue("--dial-dim-active-face-bg-c").trim()||"0.003",ridgeH:e.getPropertyValue("--dial-dim-active-face-bg-h").trim()||"240",ridgeHighlightL:e.getPropertyValue("--dial-dim-active-ridge-highlight-l").trim()||"0.60",ridgeHighlightA:e.getPropertyValue("--dial-dim-active-ridge-highlight-a").trim()||"0.4",shadingStart:e.getPropertyValue("--dial-dim-active-shading-start-color").trim()||"oklch(0% 0 0 / 0.1)",shadingEnd:e.getPropertyValue("--dial-dim-active-shading-end-color").trim()||"oklch(0% 0 0 / 0.15)"}:t&&!this.isActiveDim?this.computedStyleVars={faceBgL:e.getPropertyValue("--dial-face-bg-l").trim()||"0.01",faceBgC:e.getPropertyValue("--dial-face-bg-c").trim()||"0",faceBgH:e.getPropertyValue("--dial-face-bg-h").trim()||"0",ridgeL:e.getPropertyValue("--dial-ridge-l").trim()||"0.01",ridgeC:e.getPropertyValue("--dial-ridge-c").trim()||"0",ridgeH:e.getPropertyValue("--dial-ridge-h").trim()||"0",ridgeHighlightL:"0",ridgeHighlightA:"0",shadingStart:"oklch(0 0 0 / 0)",shadingEnd:"oklch(0 0 0 / 0)"}:this.computedStyleVars={faceBgL:e.getPropertyValue("--dial-face-bg-l").trim()||"0.20",faceBgC:e.getPropertyValue("--dial-face-bg-c").trim()||"0.005",faceBgH:e.getPropertyValue("--dial-face-bg-h").trim()||"240",ridgeL:e.getPropertyValue("--dial-ridge-l").trim()||"0.45",ridgeC:e.getPropertyValue("--dial-ridge-c").trim()||e.getPropertyValue("--dial-face-bg-c").trim()||"0.005",ridgeH:e.getPropertyValue("--dial-ridge-h").trim()||e.getPropertyValue("--dial-face-bg-h").trim()||"240",ridgeHighlightL:e.getPropertyValue("--dial-ridge-highlight-l").trim()||"0.95",ridgeHighlightA:e.getPropertyValue("--dial-ridge-highlight-a").trim()||"0.85",shadingStart:e.getPropertyValue("--dial-shading-start-color").trim()||"oklch(0% 0 0 / 0.35)",shadingEnd:e.getPropertyValue("--dial-shading-end-color").trim()||"oklch(0% 0 0 / 0.4)"}}_draw(){if(!this.ctx||!this.canvas||!this.configModule)return;if(!this.computedStyleVars.faceBgL&&(this._updateAndCacheComputedStyles(),!this.computedStyleVars.faceBgL)){console.error(`[Dial ${this.dialId} _draw] computedStyleVars.faceBgL still undefined after update. Bailing draw.`);return}const e=this.appState.getDialState(this.dialId);if(!e)return;const{rotation:t}=e,i=this.canvas.width/(window.devicePixelRatio||1),n=this.canvas.height/(window.devicePixelRatio||1);if(i===0||n===0)return;this.ctx.clearRect(0,0,i,n);const s=this.appState.getAppStatus(),a=document.body.classList.contains("theme-dim"),o=document.body.classList.contains("is-transitioning-from-dim");let u;if(a&&!o?u=this.isActiveDim:u=this.isActiveDim||s==="interactive",this.ctx.fillStyle=`oklch(${this.computedStyleVars.faceBgL} ${this.computedStyleVars.faceBgC} ${this.computedStyleVars.faceBgH})`,this.ctx.fillRect(0,0,i,n),u){const l=2*Math.PI/this.configModule.NUM_RIDGES,c=-Math.PI/4,d=t*Math.PI/180,h=this.configModule.DIAL_GRADIENT_SCALE_FACTOR;for(let p=0;p<this.configModule.NUM_RIDGES;p++){const _=p*l+d,f=Math.cos(_),g=Math.sin(_);if(f>.03){const m=i/this.configModule.NUM_RIDGES*this.configModule.RIDGE_WIDTH_FACTOR*f,D=m*h,T=(m-D)/2,C=i/2+g*i/2-m/2+T;if(this.ctx.fillStyle=`oklch(${this.computedStyleVars.ridgeL} ${this.computedStyleVars.ridgeC} ${this.computedStyleVars.ridgeH})`,this.ctx.fillRect(C,0,D,n),parseFloat(this.computedStyleVars.ridgeHighlightA)>0){const I=Math.max(0,Math.cos(_-c)),E=Math.pow(I,10)*Math.pow(f,1.5);if(E>.05){const y=Math.min(1,parseFloat(this.computedStyleVars.ridgeHighlightA)*E*1.5);this.ctx.fillStyle=`oklch(${this.computedStyleVars.ridgeHighlightL} ${this.computedStyleVars.ridgeC} ${this.computedStyleVars.ridgeH} / ${y.toFixed(3)})`;const N=C+D*.1,w=D*this.configModule.HIGHLIGHT_WIDTH_FACTOR;this.ctx.fillRect(N,0,w,n)}}}}if(this.computedStyleVars.shadingStart!=="oklch(0 0 0 / 0)"){const p=this.ctx.createLinearGradient(0,0,0,n);p.addColorStop(0,this.computedStyleVars.shadingStart),p.addColorStop(.2,"oklch(0 0 0 / 0)"),p.addColorStop(.8,"oklch(0 0 0 / 0)"),p.addColorStop(1,this.computedStyleVars.shadingEnd),this.ctx.fillStyle=p,this.ctx.fillRect(0,0,i,n)}}}_onAppStateDialUpdate(e){e&&e.id===this.dialId&&this._draw()}_onThemeChange(){this._updateAndCacheComputedStyles(),requestAnimationFrame(()=>{const e=window.devicePixelRatio||1;this.ctx&&this.ctx.setTransform(e,0,0,e,0,0),this._draw()})}_onAppStatusChange(e){this._updateAndCacheComputedStyles(),this._draw()}destroy(){this._removeDragListeners(),this.unsubscribers.forEach(e=>e()),this.unsubscribers=[],this.gsapValueTween&&this.gsapValueTween.kill(),this.dialBSettleTimer&&clearTimeout(this.dialBSettleTimer)}}const re={};let us=null,ls=null,cs=null;function Ol(r,e,t,i){if(!r||r.length===0){console.error("[DialManager INIT] No dial container elements provided.");return}if(!e||!t||!i){console.error("[DialManager INIT] CRITICAL: Missing appState, configModule, or gsap dependencies.");return}us=e,ls=t,cs=i;for(const n in re)re[n]&&typeof re[n].destroy=="function"&&re[n].destroy(),delete re[n];r.forEach(n=>{const s=n.dataset.dialId;if(!s){console.error("[DialManager INIT] Could not find dialId for container:",n);return}re[s]&&re[s].destroy(),re[s]=new Ll(n,s,us,ls,cs)}),console.log("[DialManager INIT] Initialization complete. Dial instances created:",Object.keys(re))}function bl(r){for(const e in re)re.hasOwnProperty(e)&&re[e]&&re[e].setActiveDimState(r)}function Rl(r=!1){for(const e in re)re.hasOwnProperty(e)&&re[e]&&re[e].resizeCanvas(r)}const wl=Object.freeze(Object.defineProperty({__proto__:null,init:Ol,resizeAllCanvases:Rl,setDialsActiveState:bl},Symbol.toStringTag,{value:"Module"}));let Be=null;function Fl(r,e){if(!e){console.error("[GridManager INIT] CRITICAL: ButtonManager instance not provided.");return}if(Be=e,!r||r.length===0){console.error("[GridManager INIT] No hue assignment column elements provided.");return}r.forEach(t=>{const i=t.dataset.assignmentTarget;if(!i){console.warn("[GridManager INIT] Column found without 'data-assignment-target'. Skipping.",t);return}const n=ke[i],s=t.querySelector(".control-group-label.label-top");t.innerHTML="",s&&t.appendChild(s);for(let a=0;a<12;a++){const o=document.createElement("div");o.classList.add("button-unit","button-unit--toggle","button-unit--s"),o.dataset.toggleValue=a.toString(),o.dataset.rowIndex=a.toString(),o.setAttribute("role","radio"),o.setAttribute("aria-label",`Assign ${i.toUpperCase()} to Hue from Row ${a+1}`);const u=document.createElement("div");u.classList.add("light-container"),u.setAttribute("aria-hidden","true");const l=document.createElement("div");l.classList.add("light"),u.appendChild(l),o.appendChild(u);const c=document.createElement("div");c.classList.add("button-bg-frame"),o.appendChild(c),t.appendChild(o),Be.addButton(o,i),o.addEventListener("mousedown",d=>{d.button===0&&Be.setPressedVisuals(d.currentTarget,!0)}),o.addEventListener("mouseup",d=>{d.button===0&&Be.setPressedVisuals(d.currentTarget,!1)}),o.addEventListener("mouseleave",d=>{d.currentTarget.classList.contains("is-pressing")&&Be.setPressedVisuals(d.currentTarget,!1)}),o.addEventListener("touchstart",d=>{Be.setPressedVisuals(d.currentTarget,!0)},{passive:!0}),o.addEventListener("touchend",d=>{Be.setPressedVisuals(d.currentTarget,!1)}),o.addEventListener("touchcancel",d=>{Be.setPressedVisuals(d.currentTarget,!1)}),o.addEventListener("click",d=>{const h=d.currentTarget,p=j();if(p!=="interactive"){console.log(`[GridManager Click] Interaction blocked for ${i}-${a}, app not interactive. Status: ${p}`);return}const _=Be._buttons.get(h);if(!_){console.error("[GridManager Click] Clicked button not managed by ButtonManager:",h);return}const f=_.getGroupId();if(!f){console.error("[GridManager Click] Clicked button instance missing groupId:",h);return}Be.setGroupSelected(f,h.dataset.toggleValue);const g=parseInt(h.dataset.rowIndex,10),m=ee[g];Kn(f,m)})}n>=0&&n<ee.length&&Kn(i,ee[n])})}const Ml=Object.freeze(Object.defineProperty({__proto__:null,init:Fl},Symbol.toStringTag,{value:"Module"}));let vt={},Me=null;function xl(r,e){if(!e){console.error("[ToggleManager INIT] CRITICAL: ButtonManager instance not provided.");return}Me=e,(!r||r.length===0)&&console.warn("[ToggleManager INIT] No static toggle button elements provided."),vt={},r.forEach(t=>{const i=t.closest("[data-group-id]"),n=(i==null?void 0:i.dataset.groupId)||t.dataset.groupId;if(!n){console.warn("[ToggleManager INIT] Button found without a group ID:",t);return}vt[n]||(vt[n]=[]),vt[n].find(s=>s.element===t)||vt[n].push({element:t,value:t.dataset.toggleValue}),Me._buttons.has(t)||Me.addButton(t,n),t.dataset.clickListenerAdded||(t.addEventListener("mousedown",s=>{s.button===0&&Me.setPressedVisuals(s.currentTarget,!0)}),t.addEventListener("mouseup",s=>{s.button===0&&Me.setPressedVisuals(s.currentTarget,!1)}),t.addEventListener("mouseleave",s=>{s.currentTarget.classList.contains("is-pressing")&&Me.setPressedVisuals(s.currentTarget,!1)}),t.addEventListener("touchstart",s=>{Me.setPressedVisuals(s.currentTarget,!0)},{passive:!0}),t.addEventListener("touchend",s=>{Me.setPressedVisuals(s.currentTarget,!1)}),t.addEventListener("touchcancel",s=>{Me.setPressedVisuals(s.currentTarget,!1)}),t.addEventListener("click",function(s){Fo(this,n)}),t.dataset.clickListenerAdded="true")}),Oe("themeChanged",t=>{(j()==="interactive"||document.body.classList.contains("is-transitioning-from-dim"))&&Jn()}),j()==="interactive"&&Jn()}function Fo(r,e){const t=j();if(t!=="interactive"){console.log(`[ToggleManager Click] Interaction blocked for group '${e}', app not interactive. Status: ${t}`);return}if(Me.setGroupSelected(e,r.dataset.toggleValue),e==="system-power")r.dataset.toggleValue;else if(e==="light"){const i=Lr(),n=r.dataset.toggleValue==="on"?"light":"dark";i!==n&&Ro(n)}}function Jn(){const r=Lr(),e="light";if(vt[e]&&vt[e].length>0){const t=r==="light"?"on":"off";Me.setGroupSelected(e,t)}}const Bl=Object.freeze(Object.defineProperty({__proto__:null,handleToggleClick:Fo,init:xl,syncLightToggleToThemeVisuals:Jn},Symbol.toStringTag,{value:"Module"})),v={root:document.documentElement,body:document.body,logoContainer:null,lcdA:null,lcdB:null,terminalLcdContentElement:null};let Ut=null,ae=null;const $i=["lcd--unlit","js-active-dim-lcd","lcd--dimly-lit"];function kl(r,e,t){console.log("[UIUpdater INIT] Initializing..."),Object.assign(v,r),Ut=e,ae=t,ae||console.error("[UIUpdater INIT] CRITICAL: GSAP instance not provided."),Ut||console.error("[UIUpdater INIT] CRITICAL: configModule not provided.");const i=["logoContainer","lcdA","lcdB","terminalLcdContentElement"];for(const n of i)if(!v[n]){console.error(`[UIUpdater INIT] CRITICAL ERROR: Required element reference "${n}" was not provided.`);return}try{Oe("themeChanged",zl),Oe("dialUpdated",$l),Oe("dialUpdated",jl),Oe("targetColorChanged",Vl),Oe("trueLensPowerChanged",Yl),Oe("appStatusChanged",Wl)}catch(n){console.error("[UIUpdater INIT] Error subscribing to appState events.",n);return}Mo(),br(),Zn(),console.log("[UIUpdater INIT] Initialization complete.")}function oi(r,e,t={}){var c;const{skipClassChange:i=!1,useFlicker:n=!1,flickerProfileName:s="lcdScreenFlickerToDimlyLit",onComplete:a}=t;if(!r)return console.warn(`[UIUpdater setLcdState] Attempted to set state on null element. Requested state: ${e}`),a&&ae&&ae.delayedCall(0,a),{timeline:ae?ae.timeline().to({},{duration:.001}):null,completionPromise:Promise.resolve()};let o=r,u=null;r.classList.contains("hue-lcd-display")?u=r.querySelector(".lcd-value"):r.classList.contains("actual-lcd-screen-element")||(r.id==="terminal-lcd-content"?o=r.parentElement.classList.contains("actual-lcd-screen-element")?r.parentElement:r:(console.warn("[UIUpdater setLcdState] Unknown LCD element structure for:",r),u=r.querySelector(".lcd-value")||r)),o.id||o.classList[0];let l={timeline:ae?ae.timeline().to({},{duration:.001}):null,completionPromise:Promise.resolve()};if(i||($i.forEach(d=>{e!==d&&o.classList.remove(d)}),e&&e!=="active"&&$i.includes(e)&&(o.classList.contains(e)||o.classList.add(e))),n&&(e==="lcd--dimly-lit"||e==="js-active-dim-lcd"))u&&(o===v.lcdA||o===v.lcdB)&&ae.set(u,{opacity:0,immediateRender:!0}),l=on(o,s,{onTimelineComplete:()=>{if(i||($i.forEach(d=>o.classList.remove(d)),e&&e!=="active"&&$i.includes(e)&&o.classList.add(e)),o===v.lcdA||o===v.lcdB){const d=o===v.lcdA?"A":"B";let h="";if(d==="A"){const p=nt("A");h=p?Math.round((p.hue%360+360)%360).toString():String(Math.round(Ut.DEFAULT_DIAL_A_HUE))}else d==="B"&&(h=`${Math.round(rt()*100)}%`);mt(o,h,d),u&&ae.to(u,{opacity:1,duration:Ut.LCD_TEXT_FADE_IN_DURATION||.3,ease:"power1.inOut"})}else o.classList.contains("actual-lcd-screen-element")&&v.terminalLcdContentElement&&ae.set(v.terminalLcdContentElement,{opacity:1,visibility:"visible"});a&&a()}});else{if(e==="active"||e==="lcd--unlit")if(o===v.lcdA||o===v.lcdB){const d=o===v.lcdA?"A":"B";let h="";e==="active"?(d==="A"?h=Math.round((((c=nt("A"))==null?void 0:c.hue)%360+360)%360).toString():d==="B"&&(h=`${Math.round(rt()*100)}%`),u&&ae.set(u,{opacity:1})):u&&ae.set(u,{opacity:0}),mt(o,h,d)}else o.classList.contains("actual-lcd-screen-element")&&v.terminalLcdContentElement&&ae.set(v.terminalLcdContentElement,{opacity:e==="active"?1:0});a&&ae&&ae.delayedCall(0,a)}return l}function Ul(r){const e=j(),t=Or(),i=nt("A"),n=Ut.DEFAULT_DIAL_A_HUE;let s="";(r||e==="interactive"||e==="starting-up"&&t>=6)&&(s=i?Math.round((i.hue%360+360)%360).toString():String(Math.round(n))),mt(v.lcdA,s,"A"),v.lcdA.querySelector(".lcd-value")&&(v.lcdA.querySelector(".lcd-value").style.opacity=s===""?"0":"1");let a="";(r||e==="interactive"||e==="starting-up"&&t>=6)&&(a=`${Math.round(rt()*100)}%`),mt(v.lcdB,a,"B"),v.lcdB.querySelector(".lcd-value")&&(v.lcdB.querySelector(".lcd-value").style.opacity=a===""?"0":"1")}function Or(){const r=document.getElementById("debug-phase-status");if(r){const t=r.textContent;if(t.includes("Idle"))return-1;if(t.includes("All Complete"))return 99;const i=t.match(/Phase (\d+):/i);if(i&&i[1])return parseInt(i[1],10);if(t.includes("startupPhaseP0"))return 0;if(t.includes("startupPhaseP1"))return 1}const e=j();return e==="interactive"?99:e==="loading"?-2:e==="starting-up"&&!(r!=null&&r.textContent.includes("Phase"))?-.5:0}function Gl(){var e;const r=(e=v.logoContainer)==null?void 0:e.querySelector("svg.logo-svg");r&&(r.style.opacity="")}function Hl(){br()}function Fi(r,e,t){const i=v.root;if(!i)return;const n=(Number(e)%360+360)%360;let s;const a=`--dynamic-${r}-chroma`,o={env:.039,logo:.099,"ui-accent":.2,btn:.15,lcd:.08},l=((d,h)=>{try{const p=getComputedStyle(i).getPropertyValue(d).trim();return p===""?h:parseFloat(p)||h}catch{return h}})(`--dynamic-${r}-chroma-base`,o[r]||.1);s=t?0:l;const c=`--dynamic-${r}-hue`;i.style.setProperty(c,n.toFixed(1)),i.style.setProperty(a,s.toFixed(4))}function mt(r,e,t){if(!r||t==="Terminal")return;const i=r.querySelector(".lcd-value");if(!i)return;const n=j();let s=!1;const a=Or();(n==="loading"||n==="starting-up"&&(a<6||r.classList.contains("lcd--unlit")))&&(s=!0);const o=s?"":e;i.textContent!==o&&(i.textContent=o),!s&&i.style.opacity==="0"&&n==="interactive"&&(i.style.opacity="1")}function $l(r){if(!r||r.id!=="A"||!r.state)return;const{state:e}=r,t=(e.hue%360+360)%360;v.lcdA&&mt(v.lcdA,Math.round(t).toString(),"A")}function Vl(r){!r||!r.targetKey||typeof r.hue!="number"||typeof r.isColorless!="boolean"||Fi(r.targetKey,r.hue,r.isColorless)}function zl(r){v.body&&(v.body.classList.remove("theme-dim","theme-dark","theme-light"),v.body.classList.add(`theme-${r}`))}function Yl(r){v.lcdB&&mt(v.lcdB,`${Math.round(r*100)}%`,"B")}function Wl(r){var e,t;if(r==="interactive")oi(v.lcdA,"active"),oi(v.lcdB,"active"),(e=v.terminalLcdContentElement)!=null&&e.parentElement&&v.terminalLcdContentElement.parentElement.classList.contains("actual-lcd-screen-element")&&oi(v.terminalLcdContentElement.parentElement,"active"),br();else if(r==="starting-up"){const i=(t=v.logoContainer)==null?void 0:t.querySelector("svg.logo-svg");i&&i.style.opacity!=="0.05"&&(i.style.opacity="0.05"),Zn()}else r==="loading"&&Zn()}function Zn(){const r=Or();(j()==="loading"||j()==="starting-up"&&r<6)&&(oi(v.lcdA,"lcd--unlit",{skipClassChange:!1}),oi(v.lcdB,"lcd--unlit",{skipClassChange:!1}));const e=nt("A"),t=Ut.DEFAULT_DIAL_A_HUE,i=e?Math.round((e.hue%360+360)%360).toString():String(Math.round(t));mt(v.lcdA,i,"A");const n=`${Math.round(rt()*100)}%`;mt(v.lcdB,n,"B")}function jl(r){if(r&&r.id==="A"&&r.state){const e=(r.state.hue%360+360)%360;if(v.root){const t=getComputedStyle(v.root).getPropertyValue("--dynamic-ui-accent-chroma-base").trim(),i=parseFloat(t)||.2;Fi("ui-accent",e,i===0)}}}function br(){["env","lcd","logo","btn"].forEach(n=>{const s=Nr(n);s&&Fi(n,s.hue,s.isColorless)});const e=nt("A"),t=Ut.DEFAULT_DIAL_A_HUE,i=e?e.hue:t;if(v.root){const n=getComputedStyle(v.root).getPropertyValue("--dynamic-ui-accent-chroma-base").trim(),s=parseFloat(n)||.2;Fi("ui-accent",i,s===0)}}function Mo(){if(!v.logoContainer){console.error("[UIUpdater] logoContainer element not found for SVG injection.");return}const r=v.logoContainer.querySelector("svg.logo-svg");if(r){document.body.classList.contains("theme-dim")||j()==="starting-up"?(r.style.opacity===""||parseFloat(r.style.opacity)>.05)&&(r.style.opacity="0.05"):r.style.opacity==="0.05"&&(r.style.opacity="");return}fetch("logo.svg").then(t=>{if(!t.ok)throw new Error(`HTTP error! Status: ${t.status} for ${t.url}`);return t.text()}).then(t=>{if(!t||!t.trim().startsWith("<svg"))throw new Error("Invalid or empty SVG data.");v.logoContainer.innerHTML=t;const i=v.logoContainer.querySelector("svg.logo-svg");if(i){(document.body.classList.contains("theme-dim")||j()==="starting-up")&&(i.style.opacity="0.05");const n=Nr("logo");n&&Fi("logo",n.hue,n.isColorless)}else console.error("[UIUpdater injectLogoSVG] SVG element NOT found after innerHTML set."),v.logoContainer.innerHTML='<p style="color:var(--theme-text-secondary-l, #ccc);text-align:center;font-size:0.8em;">Logo Element Not Found Post-Inject</p>'}).catch(t=>{console.error("[UIUpdater] Error fetching/injecting SVG logo:",t),v.logoContainer.innerHTML=`<p style="color:var(--theme-text-secondary-l, #ccc);text-align:center;font-size:0.8em;">Logo Load Error: ${t.message}</p>`})}const ql=Object.freeze(Object.defineProperty({__proto__:null,finalizeThemeTransition:Hl,init:kl,injectLogoSVG:Mo,prepareLogoForFullTheme:Gl,setDialLcdActiveDimState:Ul,setLcdState:oi},Symbol.toStringTag,{value:"Module"}));let te=!1,xo=0,xe={value:0},ei=0,Xi=null,Ve=null,pt=null,Z=null,an=null,we=-1,Yt="",Wt=-1,er=-1,Nn=-1,L=null,tr=null,un=null;function Xl(r,e,t,i){if(!r||!e){console.error("[LensManager INIT] CRITICAL ERROR: Missing documentElement or colorLensGradientEl.");return}if(!t){console.error("[LensManager INIT] CRITICAL ERROR: Missing configModule.");return}if(!i){console.error("[LensManager INIT] CRITICAL ERROR: Missing GSAP instance.");return}pt=r,Z=e,an=document.getElementById("lens-super-glow"),L=t,un=i,tr=bo(a=>{if(!pt)return;const o=Math.max(0,Math.min(a,1.05));pt.style.setProperty("--lens-power",o.toFixed(3))},L.DEBOUNCE_DELAY/3),an||console.warn("[LensManager INIT] Optional #lens-super-glow element not found.");const n=rt(),s=nt("A");we=s?(s.hue%360+360)%360:L.DEFAULT_DIAL_A_HUE,er=we,Fr(we),xe.value=n,ei=n,Rr(n),Oe("trueLensPowerChanged",Bo),Oe("dialBInteractionChange",Jl),Oe("dialUpdated",Ql),Oe("appStatusChanged",Zl),console.log(`[LensManager INIT] Initialized. Initial masterHue: ${we.toFixed(1)}`)}function Kl(r=null,e=null){const t=r!==null?r:L.LENS_STARTUP_TARGET_POWER,i=e!==null?e:L.LENS_STARTUP_RAMP_DURATION,n=un.timeline(),s=rt(),a={value:s*100};return s<=1e-4&&Z&&Dn(0),n.to(a,{value:t,duration:i/1e3,ease:"sine.inOut",onStart:()=>{Z&&Z.style.opacity!=="1"&&j()!=="loading"&&j()!=="error"&&(Z.style.opacity="1")},onUpdate:function(){Qn(this.targets()[0].value)},onComplete:()=>{const o=a.value;Qn(o);const u=o/100*359.999,l=u*L.DIAL_B_VISUAL_ROTATION_PER_HUE_DEGREE_CONFIG,c=nt("B")||{};mn("B",{hue:u,targetHue:u,rotation:l,targetRotation:l,isDragging:c.isDragging||!1})}}),n}function Rr(r){Dn(r),wr(r,!0)}function wr(r,e=!1){if(pt)if(e){const t=Math.max(0,Math.min(r,1.05));pt.style.setProperty("--lens-power",t.toFixed(3))}else if(tr)tr(r);else{const t=Math.max(0,Math.min(r,1.05));pt.style.setProperty("--lens-power",t.toFixed(3)),console.warn("[LensManager _setLegacyLensPowerVar] debouncedSetLegacyLensPowerVar not initialized, applying immediately.")}}function Fr(r){if(!pt||!L)return;const e=(Number(r)%360+360)%360;(Math.abs(e-Nn)>=L.HUE_UPDATE_THRESHOLD||Nn===-1)&&(pt.style.setProperty("--dynamic-lens-super-glow-hue",e.toFixed(1)),Nn=e)}function Ql(r){if(!(j()==="loading"||j()==="error"||!L)&&r&&r.id==="A"&&r.state){const e=(r.state.hue%360+360)%360,t=Math.abs(e-we);if(Math.min(t,360-t)>=L.HUE_UPDATE_THRESHOLD){we=e,Fr(we);const n=xe.value+(te?ko(performance.now()):0);Rr(n)}}}function Mt(r=!1){const e=xe.value+(te?ko(performance.now()):0);wr(e,r),Dn(e)}function Dn(r){var p;if(!Z||!L)return;const e=j(),t=r<=1e-4;if(e==="loading"||e==="starting-up"&&t&&((p=nt("B"))==null?void 0:p.hue)<=1e-4){Z.style.opacity!=="0"&&(Z.style.opacity="0"),Z.style.background!=="none"&&(Z.style.background="none",Yt="none"),Wt=r;return}if(e==="error"){Z.style.opacity!=="0"&&(Z.style.opacity="0"),Z.style.background!=="none"&&(Z.style.background="none",Yt="none"),Wt=r;return}Z.style.opacity!=="1"&&(Z.style.opacity="1");const i=Math.abs(r-Wt)>=1e-4,n=Math.abs(we-er)>=L.HUE_UPDATE_THRESHOLD;let s=i||n;if(t&&(Yt==="none"||Wt>1e-4)&&(s=!0),!s&&Yt!==""&&Yt!=="none"){Wt=r;return}const a=Math.max(L.LENS_GRADIENT_BREAKPOINTS[0].power,r);let o=L.LENS_GRADIENT_BREAKPOINTS[0],u=L.LENS_GRADIENT_BREAKPOINTS[0];for(let _=0;_<L.LENS_GRADIENT_BREAKPOINTS.length;_++){if(a<=L.LENS_GRADIENT_BREAKPOINTS[_].power){u=L.LENS_GRADIENT_BREAKPOINTS[_],o=_>0?L.LENS_GRADIENT_BREAKPOINTS[_-1]:L.LENS_GRADIENT_BREAKPOINTS[0];break}_===L.LENS_GRADIENT_BREAKPOINTS.length-1&&(o=L.LENS_GRADIENT_BREAKPOINTS[_],u=L.LENS_GRADIENT_BREAKPOINTS[_])}let l=0;u.power>o.power?(l=(Math.max(o.power,Math.min(r,u.power))-o.power)/(u.power-o.power),l=Math.max(0,Math.min(l,1))):r<=o.power?l=0:l=1,t&&(l=0,o=L.LENS_GRADIENT_BREAKPOINTS[0],u=L.LENS_GRADIENT_BREAKPOINTS[0]);const c=[];for(let _=0;_<L.NUM_LENS_GRADIENT_STOPS;_++){const f=o.stops[_],g=u.stops[_];if(!f||!g){console.warn(`[LensManager] Missing stop data at index ${_} for power ${r}`),c.push("oklch(0 0 0) 0%");continue}const m=f.l+l*(g.l-f.l),D=f.c+l*(g.c-f.c),T=f.pos+l*(g.pos-f.pos);let A=f.type==="hotspot"?we+L.LENS_HOTSPOT_HUE_OFFSET:f.type==="main"?we:0;A=(A%360+360)%360,c.push(`oklch(${m.toFixed(3)} ${D.toFixed(3)} ${A.toFixed(1)}) ${(T*100).toFixed(2)}%`)}L.LENS_GRADIENT_BREAKPOINTS[0].stops[L.NUM_LENS_GRADIENT_STOPS-1].pos*100<99.9&&c.push("oklch(0 0 0 / 0) 100%");const h=`radial-gradient(circle at 50% 50%, ${c.join(", ")})`;Z.style.background!==h&&(Z.style.background=h),Yt=h,Wt=r,er=we}function Bo(r){if(!L||!un)return;ei=r,Ve&&Ve.kill();const e=j()==="starting-up",t=gn()==="idle";e||!t?(xe.value=ei,te||Mt(!0)):Ve=un.to(xe,{value:ei,duration:L.LENS_OSCILLATION_SMOOTHING_DURATION,ease:"power1.out",onUpdate:()=>{te||Mt()},onComplete:()=>{Ve=null,te||Mt(!0),j()==="interactive"&&xe.value>=L.LENS_OSCILLATION_THRESHOLD&&!te&&ir()}}),(ei<L.LENS_OSCILLATION_THRESHOLD||!t||e)&&te&&ln(),j()==="interactive"&&t&&xe.value>=L.LENS_OSCILLATION_THRESHOLD&&!te&&ir()}function Jl(r){L&&(r==="dragging"||r==="settling"?(te&&ln(),Ve&&Ve.kill(),xe.value=rt(),Mt(!0)):r==="idle"&&Bo(rt()))}function Zl(r){if(L){if(r==="loading"||r==="error"){te&&ln(),Ve&&Ve.kill(),xe.value=0,ei=0,Dn(0),wr(0,!0),an&&(an.style.opacity="0");return}Mt(!0),Fr(we),r==="interactive"?gn()==="idle"&&xe.value>=L.LENS_OSCILLATION_THRESHOLD&&!te&&ir():(te&&ln(),r==="starting-up"&&Ve&&Ve.kill())}}function ir(){L&&(te||j()!=="interactive"||gn()!=="idle"||(te=!0,xo=performance.now(),Uo(performance.now())))}function ln(){te&&(te=!1,Xi&&cancelAnimationFrame(Xi),Xi=null,Mt(!0))}function ko(r){if(!te||!L)return 0;const e=(r-xo)/1e3,t=Math.max(0,xe.value-L.LENS_OSCILLATION_THRESHOLD),i=1-L.LENS_OSCILLATION_THRESHOLD,n=i>0?Math.min(1,t/i):0,s=L.LENS_OSCILLATION_AMPLITUDE_MIN+n*L.LENS_OSCILLATION_AMPLITUDE_MAX_ADDITION,a=Al(n,0,1,L.LENS_OSCILLATION_PERIOD_AT_THRESHOLD,L.LENS_OSCILLATION_PERIOD_AT_MAX_POWER);return a<=.001?0:Math.sin(2*Math.PI/a*e)*s}function Uo(r){te&&(Mt(),Xi=requestAnimationFrame(Uo))}const ec=Object.freeze(Object.defineProperty({__proto__:null,directUpdateLensVisuals:Rr,energizeLensCoreStartup:Kl,init:Xl},Symbol.toStringTag,{value:"Module"}));function tc(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}function ic(){const r=tc();if(r.__xstate__)return r.__xstate__}const nc=r=>{if(typeof window>"u")return;const e=ic();e&&e.register(r)};class ds{constructor(e){this._process=e,this._active=!1,this._current=null,this._last=null}start(){this._active=!0,this.flush()}clear(){this._current&&(this._current.next=null,this._last=this._current)}enqueue(e){const t={value:e,next:null};if(this._current){this._last.next=t,this._last=t;return}this._current=t,this._last=t,this._active&&this.flush()}flush(){for(;this._current;){const e=this._current;this._process(e.value),this._current=e.next}this._last=null}}const Go=".",rc="",Ho="",sc="#",oc="*",$o="xstate.init",cn="xstate.stop";function ac(r,e){return{type:`xstate.after.${r}.${e}`}}function nr(r,e){return{type:`xstate.done.state.${r}`,output:e}}function uc(r,e){return{type:`xstate.done.actor.${r}`,output:e,actorId:r}}function lc(r,e){return{type:`xstate.error.actor.${r}`,error:e,actorId:r}}function Vo(r){return{type:$o,input:r}}function je(r){setTimeout(()=>{throw r})}const cc=typeof Symbol=="function"&&Symbol.observable||"@@observable";function zo(r,e){const t=hs(r),i=hs(e);return typeof i=="string"?typeof t=="string"?i===t:!1:typeof t=="string"?t in i:Object.keys(t).every(n=>n in i?zo(t[n],i[n]):!1)}function Mr(r){if(Wo(r))return r;const e=[];let t="";for(let i=0;i<r.length;i++){switch(r.charCodeAt(i)){case 92:t+=r[i+1],i++;continue;case 46:e.push(t),t="";continue}t+=r[i]}return e.push(t),e}function hs(r){if(Yc(r))return r.value;if(typeof r!="string")return r;const e=Mr(r);return dc(e)}function dc(r){if(r.length===1)return r[0];const e={};let t=e;for(let i=0;i<r.length-1;i++)if(i===r.length-2)t[r[i]]=r[i+1];else{const n=t;t={},n[r[i]]=t}return e}function fs(r,e){const t={},i=Object.keys(r);for(let n=0;n<i.length;n++){const s=i[n];t[s]=e(r[s],s,r,n)}return t}function Yo(r){return Wo(r)?r:[r]}function dt(r){return r===void 0?[]:Yo(r)}function rr(r,e,t,i){return typeof r=="function"?r({context:e,event:t,self:i}):r}function Wo(r){return Array.isArray(r)}function hc(r){return r.type.startsWith("xstate.error.actor")}function Qt(r){return Yo(r).map(e=>typeof e>"u"||typeof e=="string"?{target:e}:e)}function jo(r){if(!(r===void 0||r===rc))return dt(r)}function sr(r,e,t){var s,a,o;const i=typeof r=="object",n=i?r:void 0;return{next:(s=i?r.next:r)==null?void 0:s.bind(n),error:(a=i?r.error:e)==null?void 0:a.bind(n),complete:(o=i?r.complete:t)==null?void 0:o.bind(n)}}function ps(r,e){return`${e}.${r}`}function xr(r,e){const t=e.match(/^xstate\.invoke\.(\d+)\.(.*)/);if(!t)return r.implementations.actors[e];const[,i,n]=t,a=r.getStateNodeById(n).config.invoke;return(Array.isArray(a)?a[i]:a).src}function _s(r,e){return`${r.sessionId}.${e}`}let fc=0;function pc(r,e){const t=new Map,i=new Map,n=new WeakMap,s=new Set,a={},{clock:o,logger:u}=e,l={schedule:(h,p,_,f,g=Math.random().toString(36).slice(2))=>{const m={source:h,target:p,event:_,delay:f,id:g,startedAt:Date.now()},D=_s(h,g);d._snapshot._scheduledEvents[D]=m;const T=o.setTimeout(()=>{delete a[D],delete d._snapshot._scheduledEvents[D],d._relay(h,p,_)},f);a[D]=T},cancel:(h,p)=>{const _=_s(h,p),f=a[_];delete a[_],delete d._snapshot._scheduledEvents[_],f!==void 0&&o.clearTimeout(f)},cancelAll:h=>{for(const p in d._snapshot._scheduledEvents){const _=d._snapshot._scheduledEvents[p];_.source===h&&l.cancel(h,_.id)}}},c=h=>{if(!s.size)return;const p={...h,rootId:r.sessionId};s.forEach(_=>{var f;return(f=_.next)==null?void 0:f.call(_,p)})},d={_snapshot:{_scheduledEvents:((e==null?void 0:e.snapshot)&&e.snapshot.scheduler)??{}},_bookId:()=>`x:${fc++}`,_register:(h,p)=>(t.set(h,p),h),_unregister:h=>{t.delete(h.sessionId);const p=n.get(h);p!==void 0&&(i.delete(p),n.delete(h))},get:h=>i.get(h),_set:(h,p)=>{const _=i.get(h);if(_&&_!==p)throw new Error(`Actor with system ID '${h}' already exists.`);i.set(h,p),n.set(p,h)},inspect:h=>{const p=sr(h);return s.add(p),{unsubscribe(){s.delete(p)}}},_sendInspectionEvent:c,_relay:(h,p,_)=>{d._sendInspectionEvent({type:"@xstate.event",sourceRef:h,actorRef:p,event:_}),p._send(_)},scheduler:l,getSnapshot:()=>({_scheduledEvents:{...d._snapshot._scheduledEvents}}),start:()=>{const h=d._snapshot._scheduledEvents;d._snapshot._scheduledEvents={};for(const p in h){const{source:_,target:f,event:g,delay:m,id:D}=h[p];l.schedule(_,f,g,m,D)}},_clock:o,_logger:u};return d}let Ln=!1;const Br=1;let _e=function(r){return r[r.NotStarted=0]="NotStarted",r[r.Running=1]="Running",r[r.Stopped=2]="Stopped",r}({});const _c={clock:{setTimeout:(r,e)=>setTimeout(r,e),clearTimeout:r=>clearTimeout(r)},logger:console.log.bind(console),devTools:!1};class gc{constructor(e,t){this.logic=e,this._snapshot=void 0,this.clock=void 0,this.options=void 0,this.id=void 0,this.mailbox=new ds(this._process.bind(this)),this.observers=new Set,this.eventListeners=new Map,this.logger=void 0,this._processingStatus=_e.NotStarted,this._parent=void 0,this._syncSnapshot=void 0,this.ref=void 0,this._actorScope=void 0,this._systemId=void 0,this.sessionId=void 0,this.system=void 0,this._doneEvent=void 0,this.src=void 0,this._deferred=[];const i={..._c,...t},{clock:n,logger:s,parent:a,syncSnapshot:o,id:u,systemId:l,inspect:c}=i;this.system=a?a.system:pc(this,{clock:n,logger:s}),c&&!a&&this.system.inspect(sr(c)),this.sessionId=this.system._bookId(),this.id=u??this.sessionId,this.logger=(t==null?void 0:t.logger)??this.system._logger,this.clock=(t==null?void 0:t.clock)??this.system._clock,this._parent=a,this._syncSnapshot=o,this.options=i,this.src=i.src??e,this.ref=this,this._actorScope={self:this,id:this.id,sessionId:this.sessionId,logger:this.logger,defer:d=>{this._deferred.push(d)},system:this.system,stopChild:d=>{if(d._parent!==this)throw new Error(`Cannot stop child actor ${d.id} of ${this.id} because it is not a child`);d._stop()},emit:d=>{const h=this.eventListeners.get(d.type),p=this.eventListeners.get("*");if(!h&&!p)return;const _=[...h?h.values():[],...p?p.values():[]];for(const f of _)f(d)},actionExecutor:d=>{const h=()=>{if(this._actorScope.system._sendInspectionEvent({type:"@xstate.action",actorRef:this,action:{type:d.type,params:d.params}}),!d.exec)return;const p=Ln;try{Ln=!0,d.exec(d.info,d.params)}finally{Ln=p}};this._processingStatus===_e.Running?h():this._deferred.push(h)}},this.send=this.send.bind(this),this.system._sendInspectionEvent({type:"@xstate.actor",actorRef:this}),l&&(this._systemId=l,this.system._set(l,this)),this._initState((t==null?void 0:t.snapshot)??(t==null?void 0:t.state)),l&&this._snapshot.status!=="active"&&this.system._unregister(this)}_initState(e){var t;try{this._snapshot=e?this.logic.restoreSnapshot?this.logic.restoreSnapshot(e,this._actorScope):e:this.logic.getInitialSnapshot(this._actorScope,(t=this.options)==null?void 0:t.input)}catch(i){this._snapshot={status:"error",output:void 0,error:i}}}update(e,t){var n,s;this._snapshot=e;let i;for(;i=this._deferred.shift();)try{i()}catch(a){this._deferred.length=0,this._snapshot={...e,status:"error",error:a}}switch(this._snapshot.status){case"active":for(const a of this.observers)try{(n=a.next)==null||n.call(a,e)}catch(o){je(o)}break;case"done":for(const a of this.observers)try{(s=a.next)==null||s.call(a,e)}catch(o){je(o)}this._stopProcedure(),this._complete(),this._doneEvent=uc(this.id,this._snapshot.output),this._parent&&this.system._relay(this,this._parent,this._doneEvent);break;case"error":this._error(this._snapshot.error);break}this.system._sendInspectionEvent({type:"@xstate.snapshot",actorRef:this,event:t,snapshot:e})}subscribe(e,t,i){var s;const n=sr(e,t,i);if(this._processingStatus!==_e.Stopped)this.observers.add(n);else switch(this._snapshot.status){case"done":try{(s=n.complete)==null||s.call(n)}catch(a){je(a)}break;case"error":{const a=this._snapshot.error;if(!n.error)je(a);else try{n.error(a)}catch(o){je(o)}break}}return{unsubscribe:()=>{this.observers.delete(n)}}}on(e,t){let i=this.eventListeners.get(e);i||(i=new Set,this.eventListeners.set(e,i));const n=t.bind(void 0);return i.add(n),{unsubscribe:()=>{i.delete(n)}}}start(){if(this._processingStatus===_e.Running)return this;this._syncSnapshot&&this.subscribe({next:i=>{i.status==="active"&&this.system._relay(this,this._parent,{type:`xstate.snapshot.${this.id}`,snapshot:i})},error:()=>{}}),this.system._register(this.sessionId,this),this._systemId&&this.system._set(this._systemId,this),this._processingStatus=_e.Running;const e=Vo(this.options.input);switch(this.system._sendInspectionEvent({type:"@xstate.event",sourceRef:this._parent,actorRef:this,event:e}),this._snapshot.status){case"done":return this.update(this._snapshot,e),this;case"error":return this._error(this._snapshot.error),this}if(this._parent||this.system.start(),this.logic.start)try{this.logic.start(this._snapshot,this._actorScope)}catch(i){return this._snapshot={...this._snapshot,status:"error",error:i},this._error(i),this}return this.update(this._snapshot,e),this.options.devTools&&this.attachDevTools(),this.mailbox.start(),this}_process(e){let t,i;try{t=this.logic.transition(this._snapshot,e,this._actorScope)}catch(n){i={err:n}}if(i){const{err:n}=i;this._snapshot={...this._snapshot,status:"error",error:n},this._error(n);return}this.update(t,e),e.type===cn&&(this._stopProcedure(),this._complete())}_stop(){return this._processingStatus===_e.Stopped?this:(this.mailbox.clear(),this._processingStatus===_e.NotStarted?(this._processingStatus=_e.Stopped,this):(this.mailbox.enqueue({type:cn}),this))}stop(){if(this._parent)throw new Error("A non-root actor cannot be stopped directly.");return this._stop()}_complete(){var e;for(const t of this.observers)try{(e=t.complete)==null||e.call(t)}catch(i){je(i)}this.observers.clear()}_reportError(e){if(!this.observers.size){this._parent||je(e);return}let t=!1;for(const i of this.observers){const n=i.error;t||(t=!n);try{n==null||n(e)}catch(s){je(s)}}this.observers.clear(),t&&je(e)}_error(e){this._stopProcedure(),this._reportError(e),this._parent&&this.system._relay(this,this._parent,lc(this.id,e))}_stopProcedure(){return this._processingStatus!==_e.Running?this:(this.system.scheduler.cancelAll(this),this.mailbox.clear(),this.mailbox=new ds(this._process.bind(this)),this._processingStatus=_e.Stopped,this.system._unregister(this),this)}_send(e){this._processingStatus!==_e.Stopped&&this.mailbox.enqueue(e)}send(e){this.system._relay(void 0,this,e)}attachDevTools(){const{devTools:e}=this.options;e&&(typeof e=="function"?e:nc)(this)}toJSON(){return{xstate$$type:Br,id:this.id}}getPersistedSnapshot(e){return this.logic.getPersistedSnapshot(this._snapshot,e)}[cc](){return this}getSnapshot(){return this._snapshot}}function Mi(r,...[e]){return new gc(r,e)}const mc=Mi;function Dc(r,e,t,i,{sendId:n}){const s=typeof n=="function"?n(t,i):n;return[e,{sendId:s},void 0]}function Ec(r,e){r.defer(()=>{r.system.scheduler.cancel(r.self,e.sendId)})}function Sc(r){function e(t,i){}return e.type="xstate.cancel",e.sendId=r,e.resolve=Dc,e.execute=Ec,e}function Tc(r,e,t,i,{id:n,systemId:s,src:a,input:o,syncSnapshot:u}){const l=typeof a=="string"?xr(e.machine,a):a,c=typeof n=="function"?n(t):n;let d,h;return l&&(h=typeof o=="function"?o({context:e.context,event:t.event,self:r.self}):o,d=Mi(l,{id:c,src:a,parent:r.self,syncSnapshot:u,systemId:s,input:h})),[Gt(e,{children:{...e.children,[c]:d}}),{id:n,systemId:s,actorRef:d,src:a,input:h},void 0]}function yc(r,{actorRef:e}){e&&r.defer(()=>{e._processingStatus!==_e.Stopped&&e.start()})}function Ac(...[r,{id:e,systemId:t,input:i,syncSnapshot:n=!1}={}]){function s(a,o){}return s.type="xstate.spawnChild",s.id=e,s.systemId=t,s.src=r,s.input=i,s.syncSnapshot=n,s.resolve=Tc,s.execute=yc,s}function Cc(r,e,t,i,{actorRef:n}){const s=typeof n=="function"?n(t,i):n,a=typeof s=="string"?e.children[s]:s;let o=e.children;return a&&(o={...o},delete o[a.id]),[Gt(e,{children:o}),a,void 0]}function Ic(r,e){if(e){if(r.system._unregister(e),e._processingStatus!==_e.Running){r.stopChild(e);return}r.defer(()=>{r.stopChild(e)})}}function qo(r){function e(t,i){}return e.type="xstate.stopChild",e.actorRef=r,e.resolve=Cc,e.execute=Ic,e}function kr(r,e,t,i){const{machine:n}=i,s=typeof r=="function",a=s?r:n.implementations.guards[typeof r=="string"?r:r.type];if(!s&&!a)throw new Error(`Guard '${typeof r=="string"?r:r.type}' is not implemented.'.`);if(typeof a!="function")return kr(a,e,t,i);const o={context:e,event:t},u=s||typeof r=="string"?void 0:"params"in r?typeof r.params=="function"?r.params({context:e,event:t}):r.params:void 0;return"check"in a?a.check(i,o,a):a(o,u)}const Ur=r=>r.type==="atomic"||r.type==="final";function fi(r){return Object.values(r.states).filter(e=>e.type!=="history")}function Ui(r,e){const t=[];if(e===r)return t;let i=r.parent;for(;i&&i!==e;)t.push(i),i=i.parent;return t}function dn(r){const e=new Set(r),t=Ko(e);for(const i of e)if(i.type==="compound"&&(!t.get(i)||!t.get(i).length))gs(i).forEach(n=>e.add(n));else if(i.type==="parallel"){for(const n of fi(i))if(n.type!=="history"&&!e.has(n)){const s=gs(n);for(const a of s)e.add(a)}}for(const i of e){let n=i.parent;for(;n;)e.add(n),n=n.parent}return e}function Xo(r,e){const t=e.get(r);if(!t)return{};if(r.type==="compound"){const n=t[0];if(n){if(Ur(n))return n.key}else return{}}const i={};for(const n of t)i[n.key]=Xo(n,e);return i}function Ko(r){const e=new Map;for(const t of r)e.has(t)||e.set(t,[]),t.parent&&(e.has(t.parent)||e.set(t.parent,[]),e.get(t.parent).push(t));return e}function Qo(r,e){const t=dn(e);return Xo(r,Ko(t))}function Gr(r,e){return e.type==="compound"?fi(e).some(t=>t.type==="final"&&r.has(t)):e.type==="parallel"?fi(e).every(t=>Gr(r,t)):e.type==="final"}const En=r=>r[0]===sc;function Pc(r,e){return r.transitions.get(e)||[...r.transitions.keys()].filter(i=>{if(i===oc)return!0;if(!i.endsWith(".*"))return!1;const n=i.split("."),s=e.split(".");for(let a=0;a<n.length;a++){const o=n[a],u=s[a];if(o==="*")return a===n.length-1;if(o!==u)return!1}return!0}).sort((i,n)=>n.length-i.length).flatMap(i=>r.transitions.get(i))}function vc(r){const e=r.config.after;if(!e)return[];const t=n=>{const s=ac(n,r.id),a=s.type;return r.entry.push(td(s,{id:a,delay:n})),r.exit.push(Sc(a)),a};return Object.keys(e).flatMap(n=>{const s=e[n],a=typeof s=="string"?{target:s}:s,o=Number.isNaN(+n)?n:+n,u=t(o);return dt(a).map(l=>({...l,event:u,delay:o}))}).map(n=>{const{delay:s}=n;return{...Nt(r,n.event,n),delay:s}})}function Nt(r,e,t){const i=jo(t.target),n=t.reenter??!1,s=Oc(r,i),a={...t,actions:dt(t.actions),guard:t.guard,target:s,source:r,reenter:n,eventType:e,toJSON:()=>({...a,source:`#${r.id}`,target:s?s.map(o=>`#${o.id}`):void 0})};return a}function Nc(r){const e=new Map;if(r.config.on)for(const t of Object.keys(r.config.on)){if(t===Ho)throw new Error('Null events ("") cannot be specified as a transition key. Use `always: { ... }` instead.');const i=r.config.on[t];e.set(t,Qt(i).map(n=>Nt(r,t,n)))}if(r.config.onDone){const t=`xstate.done.state.${r.id}`;e.set(t,Qt(r.config.onDone).map(i=>Nt(r,t,i)))}for(const t of r.invoke){if(t.onDone){const i=`xstate.done.actor.${t.id}`;e.set(i,Qt(t.onDone).map(n=>Nt(r,i,n)))}if(t.onError){const i=`xstate.error.actor.${t.id}`;e.set(i,Qt(t.onError).map(n=>Nt(r,i,n)))}if(t.onSnapshot){const i=`xstate.snapshot.${t.id}`;e.set(i,Qt(t.onSnapshot).map(n=>Nt(r,i,n)))}}for(const t of r.after){let i=e.get(t.eventType);i||(i=[],e.set(t.eventType,i)),i.push(t)}return e}function Lc(r,e){const t=typeof e=="string"?r.states[e]:e?r.states[e.target]:void 0;if(!t&&e)throw new Error(`Initial state node "${e}" not found on parent state node #${r.id}`);const i={source:r,actions:!e||typeof e=="string"?[]:dt(e.actions),eventType:null,reenter:!1,target:t?[t]:[],toJSON:()=>({...i,source:`#${r.id}`,target:t?[`#${t.id}`]:[]})};return i}function Oc(r,e){if(e!==void 0)return e.map(t=>{if(typeof t!="string")return t;if(En(t))return r.machine.getStateNodeById(t);const i=t[0]===Go;if(i&&!r.parent)return xi(r,t.slice(1));const n=i?r.key+t:t;if(r.parent)try{return xi(r.parent,n)}catch(s){throw new Error(`Invalid transition definition for state node '${r.id}':
${s.message}`)}else throw new Error(`Invalid target: "${t}" is not a valid target from the root node. Did you mean ".${t}"?`)})}function Jo(r){const e=jo(r.config.target);return e?{target:e.map(t=>typeof t=="string"?xi(r.parent,t):t)}:r.parent.initial}function Ot(r){return r.type==="history"}function gs(r){const e=Zo(r);for(const t of e)for(const i of Ui(t,r))e.add(i);return e}function Zo(r){const e=new Set;function t(i){if(!e.has(i)){if(e.add(i),i.type==="compound")t(i.initial.target[0]);else if(i.type==="parallel")for(const n of fi(i))t(n)}}return t(r),e}function pi(r,e){if(En(e))return r.machine.getStateNodeById(e);if(!r.states)throw new Error(`Unable to retrieve child state '${e}' from '${r.id}'; no child states exist.`);const t=r.states[e];if(!t)throw new Error(`Child state '${e}' does not exist on '${r.id}'`);return t}function xi(r,e){if(typeof e=="string"&&En(e))try{return r.machine.getStateNodeById(e)}catch{}const t=Mr(e).slice();let i=r;for(;t.length;){const n=t.shift();if(!n.length)break;i=pi(i,n)}return i}function hn(r,e){if(typeof e=="string"){const n=r.states[e];if(!n)throw new Error(`State '${e}' does not exist on '${r.id}'`);return[r,n]}const t=Object.keys(e),i=t.map(n=>pi(r,n)).filter(Boolean);return[r.machine.root,r].concat(i,t.reduce((n,s)=>{const a=pi(r,s);if(!a)return n;const o=hn(a,e[s]);return n.concat(o)},[]))}function bc(r,e,t,i){const s=pi(r,e).next(t,i);return!s||!s.length?r.next(t,i):s}function Rc(r,e,t,i){const n=Object.keys(e),s=pi(r,n[0]),a=Hr(s,e[n[0]],t,i);return!a||!a.length?r.next(t,i):a}function wc(r,e,t,i){const n=[];for(const s of Object.keys(e)){const a=e[s];if(!a)continue;const o=pi(r,s),u=Hr(o,a,t,i);u&&n.push(...u)}return n.length?n:r.next(t,i)}function Hr(r,e,t,i){return typeof e=="string"?bc(r,e,t,i):Object.keys(e).length===1?Rc(r,e,t,i):wc(r,e,t,i)}function Fc(r){return Object.keys(r.states).map(e=>r.states[e]).filter(e=>e.type==="history")}function Dt(r,e){let t=r;for(;t.parent&&t.parent!==e;)t=t.parent;return t.parent===e}function Mc(r,e){const t=new Set(r),i=new Set(e);for(const n of t)if(i.has(n))return!0;for(const n of i)if(t.has(n))return!0;return!1}function ea(r,e,t){const i=new Set;for(const n of r){let s=!1;const a=new Set;for(const o of i)if(Mc(or([n],e,t),or([o],e,t)))if(Dt(n.source,o.source))a.add(o);else{s=!0;break}if(!s){for(const o of a)i.delete(o);i.add(n)}}return Array.from(i)}function xc(r){const[e,...t]=r;for(const i of Ui(e,void 0))if(t.every(n=>Dt(n,i)))return i}function $r(r,e){if(!r.target)return[];const t=new Set;for(const i of r.target)if(Ot(i))if(e[i.id])for(const n of e[i.id])t.add(n);else for(const n of $r(Jo(i),e))t.add(n);else t.add(i);return[...t]}function ta(r,e){const t=$r(r,e);if(!t)return;if(!r.reenter&&t.every(n=>n===r.source||Dt(n,r.source)))return r.source;const i=xc(t.concat(r.source));if(i)return i;if(!r.reenter)return r.source.machine.root}function or(r,e,t){var n;const i=new Set;for(const s of r)if((n=s.target)!=null&&n.length){const a=ta(s,t);s.reenter&&s.source===a&&i.add(a);for(const o of e)Dt(o,a)&&i.add(o)}return[...i]}function Bc(r,e){if(r.length!==e.size)return!1;for(const t of r)if(!e.has(t))return!1;return!0}function ar(r,e,t,i,n,s){if(!r.length)return e;const a=new Set(e._nodes);let o=e.historyValue;const u=ea(r,a,o);let l=e;n||([l,o]=Hc(l,i,t,u,a,o,s,t.actionExecutor)),l=_i(l,i,t,u.flatMap(d=>d.actions),s,void 0),l=Uc(l,i,t,u,a,s,o,n);const c=[...a];l.status==="done"&&(l=_i(l,i,t,c.sort((d,h)=>h.order-d.order).flatMap(d=>d.exit),s,void 0));try{return o===e.historyValue&&Bc(e._nodes,a)?l:Gt(l,{_nodes:c,historyValue:o})}catch(d){throw d}}function kc(r,e,t,i,n){if(i.output===void 0)return;const s=nr(n.id,n.output!==void 0&&n.parent?rr(n.output,r.context,e,t.self):void 0);return rr(i.output,r.context,s,t.self)}function Uc(r,e,t,i,n,s,a,o){let u=r;const l=new Set,c=new Set;Gc(i,a,c,l),o&&c.add(r.machine.root);const d=new Set;for(const h of[...l].sort((p,_)=>p.order-_.order)){n.add(h);const p=[];p.push(...h.entry);for(const _ of h.invoke)p.push(Ac(_.src,{..._,syncSnapshot:!!_.onSnapshot}));if(c.has(h)){const _=h.initial.actions;p.push(..._)}if(u=_i(u,e,t,p,s,h.invoke.map(_=>_.id)),h.type==="final"){const _=h.parent;let f=(_==null?void 0:_.type)==="parallel"?_:_==null?void 0:_.parent,g=f||h;for((_==null?void 0:_.type)==="compound"&&s.push(nr(_.id,h.output!==void 0?rr(h.output,u.context,e,t.self):void 0));(f==null?void 0:f.type)==="parallel"&&!d.has(f)&&Gr(n,f);)d.add(f),s.push(nr(f.id)),g=f,f=f.parent;if(f)continue;u=Gt(u,{status:"done",output:kc(u,e,t,u.machine.root,g)})}}return u}function Gc(r,e,t,i){for(const n of r){const s=ta(n,e);for(const o of n.target||[])!Ot(o)&&(n.source!==o||n.source!==s||n.reenter)&&(i.add(o),t.add(o)),ti(o,e,t,i);const a=$r(n,e);for(const o of a){const u=Ui(o,s);(s==null?void 0:s.type)==="parallel"&&u.push(s),ia(i,e,t,u,!n.source.parent&&n.reenter?void 0:s)}}}function ti(r,e,t,i){var n;if(Ot(r))if(e[r.id]){const s=e[r.id];for(const a of s)i.add(a),ti(a,e,t,i);for(const a of s)On(a,r.parent,i,e,t)}else{const s=Jo(r);for(const a of s.target)i.add(a),s===((n=r.parent)==null?void 0:n.initial)&&t.add(r.parent),ti(a,e,t,i);for(const a of s.target)On(a,r.parent,i,e,t)}else if(r.type==="compound"){const[s]=r.initial.target;Ot(s)||(i.add(s),t.add(s)),ti(s,e,t,i),On(s,r,i,e,t)}else if(r.type==="parallel")for(const s of fi(r).filter(a=>!Ot(a)))[...i].some(a=>Dt(a,s))||(Ot(s)||(i.add(s),t.add(s)),ti(s,e,t,i))}function ia(r,e,t,i,n){for(const s of i)if((!n||Dt(s,n))&&r.add(s),s.type==="parallel")for(const a of fi(s).filter(o=>!Ot(o)))[...r].some(o=>Dt(o,a))||(r.add(a),ti(a,e,t,r))}function On(r,e,t,i,n){ia(t,i,n,Ui(r,e))}function Hc(r,e,t,i,n,s,a,o){let u=r;const l=or(i,n,s);l.sort((d,h)=>h.order-d.order);let c;for(const d of l)for(const h of Fc(d)){let p;h.history==="deep"?p=_=>Ur(_)&&Dt(_,d):p=_=>_.parent===d,c??(c={...s}),c[h.id]=Array.from(n).filter(p)}for(const d of l)u=_i(u,e,t,[...d.exit,...d.invoke.map(h=>qo(h.id))],a,void 0),n.delete(d);return[u,c||s]}function $c(r,e){return r.implementations.actions[e]}function na(r,e,t,i,n,s){const{machine:a}=r;let o=r;for(const u of i){const l=typeof u=="function",c=l?u:$c(a,typeof u=="string"?u:u.type),d={context:o.context,event:e,self:t.self,system:t.system},h=l||typeof u=="string"?void 0:"params"in u?typeof u.params=="function"?u.params({context:o.context,event:e}):u.params:void 0;if(!c||!("resolve"in c)){t.actionExecutor({type:typeof u=="string"?u:typeof u=="object"?u.type:u.name||"(anonymous)",info:d,params:h,exec:c});continue}const p=c,[_,f,g]=p.resolve(t,o,d,h,c,n);o=_,"retryResolve"in p&&(s==null||s.push([p,f])),"execute"in p&&t.actionExecutor({type:p.type,info:d,params:f,exec:p.execute.bind(null,t,f)}),g&&(o=na(o,e,t,g,n,s))}return o}function _i(r,e,t,i,n,s){const a=s?[]:void 0,o=na(r,e,t,i,{internalQueue:n,deferredActorIds:s},a);return a==null||a.forEach(([u,l])=>{u.retryResolve(t,o,l)}),o}function bn(r,e,t,i){let n=r;const s=[];function a(l,c,d){t.system._sendInspectionEvent({type:"@xstate.microstep",actorRef:t.self,event:c,snapshot:l,_transitions:d}),s.push(l)}if(e.type===cn)return n=Gt(ms(n,e,t),{status:"stopped"}),a(n,e,[]),{snapshot:n,microstates:s};let o=e;if(o.type!==$o){const l=o,c=hc(l),d=Ds(l,n);if(c&&!d.length)return n=Gt(r,{status:"error",error:l.error}),a(n,l,[]),{snapshot:n,microstates:s};n=ar(d,r,t,o,!1,i),a(n,l,d)}let u=!0;for(;n.status==="active";){let l=u?Vc(n,o):[];const c=l.length?n:void 0;if(!l.length){if(!i.length)break;o=i.shift(),l=Ds(o,n)}n=ar(l,n,t,o,!1,i),u=n!==c,a(n,o,l)}return n.status!=="active"&&ms(n,o,t),{snapshot:n,microstates:s}}function ms(r,e,t){return _i(r,e,t,Object.values(r.children).map(i=>qo(i)),[],void 0)}function Ds(r,e){return e.machine.getTransitionData(e,r)}function Vc(r,e){const t=new Set,i=r._nodes.filter(Ur);for(const n of i)e:for(const s of[n].concat(Ui(n,void 0)))if(s.always){for(const a of s.always)if(a.guard===void 0||kr(a.guard,r.context,e,r)){t.add(a);break e}}return ea(Array.from(t),new Set(r._nodes),r.historyValue)}function zc(r,e){const t=dn(hn(r,e));return Qo(r,[...t])}function Yc(r){return!!r&&typeof r=="object"&&"machine"in r&&"value"in r}const Wc=function(e){return zo(e,this.value)},jc=function(e){return this.tags.has(e)},qc=function(e){const t=this.machine.getTransitionData(this,e);return!!(t!=null&&t.length)&&t.some(i=>i.target!==void 0||i.actions.length)},Xc=function(){const{_nodes:e,tags:t,machine:i,getMeta:n,toJSON:s,can:a,hasTag:o,matches:u,...l}=this;return{...l,tags:Array.from(t)}},Kc=function(){return this._nodes.reduce((e,t)=>(t.meta!==void 0&&(e[t.id]=t.meta),e),{})};function Ki(r,e){return{status:r.status,output:r.output,error:r.error,machine:e,context:r.context,_nodes:r._nodes,value:Qo(e.root,r._nodes),tags:new Set(r._nodes.flatMap(t=>t.tags)),children:r.children,historyValue:r.historyValue||{},matches:Wc,hasTag:jc,can:qc,getMeta:Kc,toJSON:Xc}}function Gt(r,e={}){return Ki({...r,...e},r.machine)}function Qc(r){if(typeof r!="object"||r===null)return{};const e={};for(const t in r){const i=r[t];Array.isArray(i)&&(e[t]=i.map(n=>({id:n.id})))}return e}function Jc(r,e){const{_nodes:t,tags:i,machine:n,children:s,context:a,can:o,hasTag:u,matches:l,getMeta:c,toJSON:d,...h}=r,p={};for(const f in s){const g=s[f];p[f]={snapshot:g.getPersistedSnapshot(e),src:g.src,systemId:g._systemId,syncSnapshot:g._syncSnapshot}}return{...h,context:ra(a),children:p,historyValue:Qc(h.historyValue)}}function ra(r){let e;for(const t in r){const i=r[t];if(i&&typeof i=="object")if("sessionId"in i&&"send"in i&&"ref"in i)e??(e=Array.isArray(r)?r.slice():{...r}),e[t]={xstate$$type:Br,id:i.id};else{const n=ra(i);n!==i&&(e??(e=Array.isArray(r)?r.slice():{...r}),e[t]=n)}}return e??r}function Zc(r,e,t,i,{event:n,id:s,delay:a},{internalQueue:o}){const u=e.machine.implementations.delays;if(typeof n=="string")throw new Error(`Only event objects may be used with raise; use raise({ type: "${n}" }) instead`);const l=typeof n=="function"?n(t,i):n;let c;if(typeof a=="string"){const d=u&&u[a];c=typeof d=="function"?d(t,i):d}else c=typeof a=="function"?a(t,i):a;return typeof c!="number"&&o.push(l),[e,{event:l,id:s,delay:c},void 0]}function ed(r,e){const{event:t,delay:i,id:n}=e;if(typeof i=="number"){r.defer(()=>{const s=r.self;r.system.scheduler.schedule(s,s,t,i,n)});return}}function td(r,e){function t(i,n){}return t.type="xstate.raise",t.event=r,t.id=e==null?void 0:e.id,t.delay=e==null?void 0:e.delay,t.resolve=Zc,t.execute=ed,t}const Es="xstate.promise.resolve",Ss="xstate.promise.reject",Vi=new WeakMap;function id(r){return{config:r,transition:(t,i,n)=>{var s;if(t.status!=="active")return t;switch(i.type){case Es:{const a=i.data;return{...t,status:"done",output:a,input:void 0}}case Ss:return{...t,status:"error",error:i.data,input:void 0};case cn:return(s=Vi.get(n.self))==null||s.abort(),{...t,status:"stopped",input:void 0};default:return t}},start:(t,{self:i,system:n,emit:s})=>{if(t.status!=="active")return;const a=new AbortController;Vi.set(i,a),Promise.resolve(r({input:t.input,system:n,self:i,signal:a.signal,emit:s})).then(u=>{i.getSnapshot().status==="active"&&(Vi.delete(i),n._relay(i,i,{type:Es,data:u}))},u=>{i.getSnapshot().status==="active"&&(Vi.delete(i),n._relay(i,i,{type:Ss,data:u}))})},getInitialSnapshot:(t,i)=>({status:"active",output:void 0,error:void 0,input:i}),getPersistedSnapshot:t=>t,restoreSnapshot:t=>t}}function nd(r,{machine:e,context:t},i,n){const s=(a,o)=>{if(typeof a=="string"){const u=xr(e,a);if(!u)throw new Error(`Actor logic '${a}' not implemented in machine '${e.id}'`);const l=Mi(u,{id:o==null?void 0:o.id,parent:r.self,syncSnapshot:o==null?void 0:o.syncSnapshot,input:typeof(o==null?void 0:o.input)=="function"?o.input({context:t,event:i,self:r.self}):o==null?void 0:o.input,src:a,systemId:o==null?void 0:o.systemId});return n[l.id]=l,l}else return Mi(a,{id:o==null?void 0:o.id,parent:r.self,syncSnapshot:o==null?void 0:o.syncSnapshot,input:o==null?void 0:o.input,src:a,systemId:o==null?void 0:o.systemId})};return(a,o)=>{const u=s(a,o);return n[u.id]=u,r.defer(()=>{u._processingStatus!==_e.Stopped&&u.start()}),u}}function rd(r,e,t,i,{assignment:n}){if(!e.context)throw new Error("Cannot assign to undefined `context`. Ensure that `context` is defined in the machine config.");const s={},a={context:e.context,event:t.event,spawn:nd(r,e,t.event,s),self:r.self,system:r.system};let o={};if(typeof n=="function")o=n(a,i);else for(const l of Object.keys(n)){const c=n[l];o[l]=typeof c=="function"?c(a,i):c}const u=Object.assign({},e.context,o);return[Gt(e,{context:u,children:Object.keys(s).length?{...e.children,...s}:e.children}),void 0,void 0]}function oe(r){function e(t,i){}return e.type="xstate.assign",e.assignment=r,e.resolve=rd,e}const Ts=new WeakMap;function jt(r,e,t){let i=Ts.get(r);return i?e in i||(i[e]=t()):(i={[e]:t()},Ts.set(r,i)),i[e]}const sd={},Ei=r=>typeof r=="string"?{type:r}:typeof r=="function"?"resolve"in r?{type:r.type}:{type:r.name}:r;class Pi{constructor(e,t){if(this.config=e,this.key=void 0,this.id=void 0,this.type=void 0,this.path=void 0,this.states=void 0,this.history=void 0,this.entry=void 0,this.exit=void 0,this.parent=void 0,this.machine=void 0,this.meta=void 0,this.output=void 0,this.order=-1,this.description=void 0,this.tags=[],this.transitions=void 0,this.always=void 0,this.parent=t._parent,this.key=t._key,this.machine=t._machine,this.path=this.parent?this.parent.path.concat(this.key):[],this.id=this.config.id||[this.machine.id,...this.path].join(Go),this.type=this.config.type||(this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.description=this.config.description,this.order=this.machine.idMap.size,this.machine.idMap.set(this.id,this),this.states=this.config.states?fs(this.config.states,(i,n)=>new Pi(i,{_parent:this,_key:n,_machine:this.machine})):sd,this.type==="compound"&&!this.config.initial)throw new Error(`No initial state specified for compound state node "#${this.id}". Try adding { initial: "${Object.keys(this.states)[0]}" } to the state config.`);this.history=this.config.history===!0?"shallow":this.config.history||!1,this.entry=dt(this.config.entry).slice(),this.exit=dt(this.config.exit).slice(),this.meta=this.config.meta,this.output=this.type==="final"||!this.parent?this.config.output:void 0,this.tags=dt(e.tags).slice()}_initialize(){this.transitions=Nc(this),this.config.always&&(this.always=Qt(this.config.always).map(e=>Nt(this,Ho,e))),Object.keys(this.states).forEach(e=>{this.states[e]._initialize()})}get definition(){return{id:this.id,key:this.key,version:this.machine.version,type:this.type,initial:this.initial?{target:this.initial.target,source:this,actions:this.initial.actions.map(Ei),eventType:null,reenter:!1,toJSON:()=>({target:this.initial.target.map(e=>`#${e.id}`),source:`#${this.id}`,actions:this.initial.actions.map(Ei),eventType:null})}:void 0,history:this.history,states:fs(this.states,e=>e.definition),on:this.on,transitions:[...this.transitions.values()].flat().map(e=>({...e,actions:e.actions.map(Ei)})),entry:this.entry.map(Ei),exit:this.exit.map(Ei),meta:this.meta,order:this.order||-1,output:this.output,invoke:this.invoke,description:this.description,tags:this.tags}}toJSON(){return this.definition}get invoke(){return jt(this,"invoke",()=>dt(this.config.invoke).map((e,t)=>{const{src:i,systemId:n}=e,s=e.id??ps(this.id,t),a=typeof i=="string"?i:`xstate.invoke.${ps(this.id,t)}`;return{...e,src:a,id:s,systemId:n,toJSON(){const{onDone:o,onError:u,...l}=e;return{...l,type:"xstate.invoke",src:a,id:s}}}}))}get on(){return jt(this,"on",()=>[...this.transitions].flatMap(([t,i])=>i.map(n=>[t,n])).reduce((t,[i,n])=>(t[i]=t[i]||[],t[i].push(n),t),{}))}get after(){return jt(this,"delayedTransitions",()=>vc(this))}get initial(){return jt(this,"initial",()=>Lc(this,this.config.initial))}next(e,t){const i=t.type,n=[];let s;const a=jt(this,`candidates-${i}`,()=>Pc(this,i));for(const o of a){const{guard:u}=o,l=e.context;let c=!1;try{c=!u||kr(u,l,t,e)}catch(d){const h=typeof u=="string"?u:typeof u=="object"?u.type:void 0;throw new Error(`Unable to evaluate guard ${h?`'${h}' `:""}in transition for event '${i}' in state node '${this.id}':
${d.message}`)}if(c){n.push(...o.actions),s=o;break}}return s?[s]:void 0}get events(){return jt(this,"events",()=>{const{states:e}=this,t=new Set(this.ownEvents);if(e)for(const i of Object.keys(e)){const n=e[i];if(n.states)for(const s of n.events)t.add(`${s}`)}return Array.from(t)})}get ownEvents(){const e=new Set([...this.transitions.keys()].filter(t=>this.transitions.get(t).some(i=>!(!i.target&&!i.actions.length&&!i.reenter))));return Array.from(e)}}const od="#";class Vr{constructor(e,t){this.config=e,this.version=void 0,this.schemas=void 0,this.implementations=void 0,this.__xstatenode=!0,this.idMap=new Map,this.root=void 0,this.id=void 0,this.states=void 0,this.events=void 0,this.id=e.id||"(machine)",this.implementations={actors:(t==null?void 0:t.actors)??{},actions:(t==null?void 0:t.actions)??{},delays:(t==null?void 0:t.delays)??{},guards:(t==null?void 0:t.guards)??{}},this.version=this.config.version,this.schemas=this.config.schemas,this.transition=this.transition.bind(this),this.getInitialSnapshot=this.getInitialSnapshot.bind(this),this.getPersistedSnapshot=this.getPersistedSnapshot.bind(this),this.restoreSnapshot=this.restoreSnapshot.bind(this),this.start=this.start.bind(this),this.root=new Pi(e,{_key:this.id,_machine:this}),this.root._initialize(),this.states=this.root.states,this.events=this.root.events}provide(e){const{actions:t,guards:i,actors:n,delays:s}=this.implementations;return new Vr(this.config,{actions:{...t,...e.actions},guards:{...i,...e.guards},actors:{...n,...e.actors},delays:{...s,...e.delays}})}resolveState(e){const t=zc(this.root,e.value),i=dn(hn(this.root,t));return Ki({_nodes:[...i],context:e.context||{},children:{},status:Gr(i,this.root)?"done":e.status||"active",output:e.output,error:e.error,historyValue:e.historyValue},this)}transition(e,t,i){return bn(e,t,i,[]).snapshot}microstep(e,t,i){return bn(e,t,i,[]).microstates}getTransitionData(e,t){return Hr(this.root,e.value,e,t)||[]}getPreInitialState(e,t,i){const{context:n}=this.config,s=Ki({context:typeof n!="function"&&n?n:{},_nodes:[this.root],children:{},status:"active"},this);return typeof n=="function"?_i(s,t,e,[oe(({spawn:o,event:u,self:l})=>n({spawn:o,input:u.input,self:l}))],i,void 0):s}getInitialSnapshot(e,t){const i=Vo(t),n=[],s=this.getPreInitialState(e,i,n),a=ar([{target:[...Zo(this.root)],source:this.root,reenter:!0,actions:[],eventType:null,toJSON:null}],s,e,i,!0,n),{snapshot:o}=bn(a,i,e,n);return o}start(e){Object.values(e.children).forEach(t=>{t.getSnapshot().status==="active"&&t.start()})}getStateNodeById(e){const t=Mr(e),i=t.slice(1),n=En(t[0])?t[0].slice(od.length):t[0],s=this.idMap.get(n);if(!s)throw new Error(`Child state node '#${n}' does not exist on machine '${this.id}'`);return xi(s,i)}get definition(){return this.root.definition}toJSON(){return this.definition}getPersistedSnapshot(e,t){return Jc(e,t)}restoreSnapshot(e,t){const i={},n=e.children;Object.keys(n).forEach(d=>{const h=n[d],p=h.snapshot,_=h.src,f=typeof _=="string"?xr(this,_):_;if(!f)return;const g=Mi(f,{id:d,parent:t.self,syncSnapshot:h.syncSnapshot,snapshot:p,src:_,systemId:h.systemId});i[d]=g});function s(d,h){try{return h.machine.getStateNodeById(d)}catch{try{return xi(h,d.split("."))}catch{return d}}}function a(d,h){if(!d||typeof d!="object")return{};const p={};for(const _ in d){const f=d[_];p[_]=f.map(g=>{if(g instanceof Pi)return g;if(typeof g=="object"&&"id"in g&&typeof g.id=="string"){const m=s(g.id,h);if(m instanceof Pi)return m}}).filter(g=>g!==void 0),p[_].length===0&&delete p[_]}return p}const o=a(e.historyValue,this.root),u=Ki({...e,children:i,_nodes:Array.from(dn(hn(this.root,e.value))),historyValue:o},this),l=new Set;function c(d,h){if(!l.has(d)){l.add(d);for(const p in d){const _=d[p];if(_&&typeof _=="object"){if("xstate$$type"in _&&_.xstate$$type===Br){d[p]=h[_.id];continue}c(_,h)}}}}return c(u.context,i),u}}function ad(r,e){return new Vr(r,e)}const Ne=r=>id(async({input:e})=>{const t=await import(r);if(!t||typeof t.createPhaseTimeline!="function")throw console.error(`Error importing or finding createPhaseTimeline in ${r}`),new Error(`Failed to load phase module: ${r}`);return t.createPhaseTimeline(e.dependencies)}),ud=ad({id:"hue9000Startup",initial:"IDLE",predictableActionArguments:!0,context:{dependencies:null,isStepThroughMode:!0,currentPhaseNameForResume:"",errorInfo:null,themeTransitionCleanupPerformed:!1},states:{IDLE:{on:{START_SEQUENCE:{target:"RUNNING_SEQUENCE.PHASE_0_IDLE",actions:[oe({isStepThroughMode:({event:r})=>r.isStepThroughMode,dependencies:({event:r})=>r.dependencies,themeTransitionCleanupPerformed:!1,errorInfo:null}),"logStartSequence"]}}},RUNNING_SEQUENCE:{initial:"PHASE_0_IDLE",states:{PHASE_0_IDLE:{invoke:{id:"phaseP0Service",src:Ne("./startupPhase0.js"),input:({context:r})=>({dependencies:r.dependencies}),onDone:[{target:"#hue9000Startup.PAUSED_AWAITING_NEXT_STEP",guard:"isStepThrough",actions:oe({currentPhaseNameForResume:"PHASE_1_EMERGENCY_SUBSYSTEMS"})},{target:"PHASE_1_EMERGENCY_SUBSYSTEMS"}],onError:{target:"#hue9000Startup.ERROR_STATE",actions:"assignError"}},entry:"notifyPhaseChangeAction",exit:"notifyPhaseChangeAction"},PHASE_1_EMERGENCY_SUBSYSTEMS:{invoke:{id:"phaseP1Service",src:Ne("./startupPhase1.js"),input:({context:r})=>({dependencies:r.dependencies}),onDone:[{target:"#hue9000Startup.PAUSED_AWAITING_NEXT_STEP",guard:"isStepThrough",actions:oe({currentPhaseNameForResume:"PHASE_2_BACKUP_POWER"})},{target:"PHASE_2_BACKUP_POWER"}],onError:{target:"#hue9000Startup.ERROR_STATE",actions:"assignError"}},entry:"notifyPhaseChangeAction",exit:"notifyPhaseChangeAction"},PHASE_2_BACKUP_POWER:{invoke:{id:"phaseP2Service",src:Ne("./startupPhase2.js"),input:({context:r})=>({dependencies:r.dependencies}),onDone:[{target:"#hue9000Startup.PAUSED_AWAITING_NEXT_STEP",guard:"isStepThrough",actions:oe({currentPhaseNameForResume:"PHASE_3_MAIN_POWER_ONLINE"})},{target:"PHASE_3_MAIN_POWER_ONLINE"}],onError:{target:"#hue9000Startup.ERROR_STATE",actions:"assignError"}},entry:"notifyPhaseChangeAction",exit:"notifyPhaseChangeAction"},PHASE_3_MAIN_POWER_ONLINE:{invoke:{id:"phaseP3Service",src:Ne("./startupPhase3.js"),input:({context:r})=>({dependencies:r.dependencies}),onDone:[{target:"#hue9000Startup.PAUSED_AWAITING_NEXT_STEP",guard:"isStepThrough",actions:oe({currentPhaseNameForResume:"PHASE_4_OPTICAL_CORE_REACTIVATE"})},{target:"PHASE_4_OPTICAL_CORE_REACTIVATE"}],onError:{target:"#hue9000Startup.ERROR_STATE",actions:"assignError"}},entry:"notifyPhaseChangeAction",exit:"notifyPhaseChangeAction"},PHASE_4_OPTICAL_CORE_REACTIVATE:{invoke:{id:"phaseP4Service",src:Ne("./startupPhase4.js"),input:({context:r})=>({dependencies:r.dependencies}),onDone:[{target:"#hue9000Startup.PAUSED_AWAITING_NEXT_STEP",guard:"isStepThrough",actions:oe({currentPhaseNameForResume:"PHASE_5_DIAGNOSTIC_INTERFACE"})},{target:"PHASE_5_DIAGNOSTIC_INTERFACE"}],onError:{target:"#hue9000Startup.ERROR_STATE",actions:"assignError"}},entry:"notifyPhaseChangeAction",exit:"notifyPhaseChangeAction"},PHASE_5_DIAGNOSTIC_INTERFACE:{invoke:{id:"phaseP5Service",src:Ne("./startupPhase5.js"),input:({context:r})=>({dependencies:r.dependencies}),onDone:[{target:"#hue9000Startup.PAUSED_AWAITING_NEXT_STEP",guard:"isStepThrough",actions:oe({currentPhaseNameForResume:"PHASE_6_MOOD_INTENSITY_CONTROLS"})},{target:"PHASE_6_MOOD_INTENSITY_CONTROLS"}],onError:{target:"#hue9000Startup.ERROR_STATE",actions:"assignError"}},entry:"notifyPhaseChangeAction",exit:"notifyPhaseChangeAction"},PHASE_6_MOOD_INTENSITY_CONTROLS:{invoke:{id:"phaseP6Service",src:Ne("./startupPhase6.js"),input:({context:r})=>({dependencies:r.dependencies}),onDone:[{target:"#hue9000Startup.PAUSED_AWAITING_NEXT_STEP",guard:"isStepThrough",actions:oe({currentPhaseNameForResume:"PHASE_7_HUE_CORRECTION_SYSTEMS"})},{target:"PHASE_7_HUE_CORRECTION_SYSTEMS"}],onError:{target:"#hue9000Startup.ERROR_STATE",actions:"assignError"}},entry:"notifyPhaseChangeAction",exit:"notifyPhaseChangeAction"},PHASE_7_HUE_CORRECTION_SYSTEMS:{invoke:{id:"phaseP7Service",src:Ne("./startupPhase7.js"),input:({context:r})=>({dependencies:r.dependencies}),onDone:[{target:"#hue9000Startup.PAUSED_AWAITING_NEXT_STEP",guard:"isStepThrough",actions:oe({currentPhaseNameForResume:"PHASE_8_EXTERNAL_LIGHTING_CONTROLS"})},{target:"PHASE_8_EXTERNAL_LIGHTING_CONTROLS"}],onError:{target:"#hue9000Startup.ERROR_STATE",actions:"assignError"}},entry:"notifyPhaseChangeAction",exit:"notifyPhaseChangeAction"},PHASE_8_EXTERNAL_LIGHTING_CONTROLS:{invoke:{id:"phaseP8Service",src:Ne("./startupPhase8.js"),input:({context:r})=>({dependencies:r.dependencies}),onDone:[{target:"#hue9000Startup.PAUSED_AWAITING_NEXT_STEP",guard:"isStepThrough",actions:oe({currentPhaseNameForResume:"PHASE_9_AUX_LIGHTING_LOW"})},{target:"PHASE_9_AUX_LIGHTING_LOW"}],onError:{target:"#hue9000Startup.ERROR_STATE",actions:"assignError"}},entry:"notifyPhaseChangeAction",exit:"notifyPhaseChangeAction"},PHASE_9_AUX_LIGHTING_LOW:{invoke:{id:"phaseP9Service",src:Ne("./startupPhase9.js"),input:({context:r})=>({dependencies:r.dependencies}),onDone:[{target:"#hue9000Startup.PAUSED_AWAITING_NEXT_STEP",guard:"isStepThrough",actions:oe({currentPhaseNameForResume:"PHASE_10_THEME_TRANSITION"})},{target:"PHASE_10_THEME_TRANSITION"}],onError:{target:"#hue9000Startup.ERROR_STATE",actions:"assignError"}},entry:"notifyPhaseChangeAction",exit:"notifyPhaseChangeAction"},PHASE_10_THEME_TRANSITION:{invoke:{id:"phaseP10Service",src:Ne("./startupPhase10.js"),input:({context:r})=>({dependencies:r.dependencies}),onDone:[{target:"#hue9000Startup.PAUSED_AWAITING_NEXT_STEP",guard:"isStepThrough",actions:oe({currentPhaseNameForResume:"PHASE_11_SYSTEM_OPERATIONAL"})},{target:"PHASE_11_SYSTEM_OPERATIONAL"}],onError:{target:"#hue9000Startup.ERROR_STATE",actions:"assignError"}},entry:"notifyPhaseChangeAction",exit:"notifyPhaseChangeAction"},PHASE_11_SYSTEM_OPERATIONAL:{invoke:{id:"phaseP11Service",src:Ne("./startupPhase11.js"),input:({context:r})=>({dependencies:r.dependencies}),onDone:[{target:"#hue9000Startup.PAUSED_AWAITING_NEXT_STEP",guard:"isStepThrough",actions:oe({currentPhaseNameForResume:"SYSTEM_READY_TARGET"})},{target:"#hue9000Startup.SYSTEM_READY"}],onError:{target:"#hue9000Startup.ERROR_STATE",actions:"assignError"}},entry:["notifyPhaseChangeAction","performThemeTransitionCleanupIfNeeded"],exit:["notifyPhaseChangeAction","markThemeTransitionCleanupPerformed"]}}},PAUSED_AWAITING_NEXT_STEP:{entry:"enableNextStepButtonAction",on:{NEXT_STEP_REQUESTED:[{target:"SYSTEM_READY",guard:({context:r})=>r.currentPhaseNameForResume==="SYSTEM_READY_TARGET",actions:"disableNextStepButtonAction"},{target:"RUNNING_SEQUENCE.PHASE_0_IDLE",guard:({context:r})=>r.currentPhaseNameForResume==="PHASE_0_IDLE",actions:"disableNextStepButtonAction"},{target:"RUNNING_SEQUENCE.PHASE_1_EMERGENCY_SUBSYSTEMS",guard:({context:r})=>r.currentPhaseNameForResume==="PHASE_1_EMERGENCY_SUBSYSTEMS",actions:"disableNextStepButtonAction"},{target:"RUNNING_SEQUENCE.PHASE_2_BACKUP_POWER",guard:({context:r})=>r.currentPhaseNameForResume==="PHASE_2_BACKUP_POWER",actions:"disableNextStepButtonAction"},{target:"RUNNING_SEQUENCE.PHASE_3_MAIN_POWER_ONLINE",guard:({context:r})=>r.currentPhaseNameForResume==="PHASE_3_MAIN_POWER_ONLINE",actions:"disableNextStepButtonAction"},{target:"RUNNING_SEQUENCE.PHASE_4_OPTICAL_CORE_REACTIVATE",guard:({context:r})=>r.currentPhaseNameForResume==="PHASE_4_OPTICAL_CORE_REACTIVATE",actions:"disableNextStepButtonAction"},{target:"RUNNING_SEQUENCE.PHASE_5_DIAGNOSTIC_INTERFACE",guard:({context:r})=>r.currentPhaseNameForResume==="PHASE_5_DIAGNOSTIC_INTERFACE",actions:"disableNextStepButtonAction"},{target:"RUNNING_SEQUENCE.PHASE_6_MOOD_INTENSITY_CONTROLS",guard:({context:r})=>r.currentPhaseNameForResume==="PHASE_6_MOOD_INTENSITY_CONTROLS",actions:"disableNextStepButtonAction"},{target:"RUNNING_SEQUENCE.PHASE_7_HUE_CORRECTION_SYSTEMS",guard:({context:r})=>r.currentPhaseNameForResume==="PHASE_7_HUE_CORRECTION_SYSTEMS",actions:"disableNextStepButtonAction"},{target:"RUNNING_SEQUENCE.PHASE_8_EXTERNAL_LIGHTING_CONTROLS",guard:({context:r})=>r.currentPhaseNameForResume==="PHASE_8_EXTERNAL_LIGHTING_CONTROLS",actions:"disableNextStepButtonAction"},{target:"RUNNING_SEQUENCE.PHASE_9_AUX_LIGHTING_LOW",guard:({context:r})=>r.currentPhaseNameForResume==="PHASE_9_AUX_LIGHTING_LOW",actions:"disableNextStepButtonAction"},{target:"RUNNING_SEQUENCE.PHASE_10_THEME_TRANSITION",guard:({context:r})=>r.currentPhaseNameForResume==="PHASE_10_THEME_TRANSITION",actions:"disableNextStepButtonAction"},{target:"RUNNING_SEQUENCE.PHASE_11_SYSTEM_OPERATIONAL",guard:({context:r})=>r.currentPhaseNameForResume==="PHASE_11_SYSTEM_OPERATIONAL",actions:"disableNextStepButtonAction"}]}},SYSTEM_READY:{type:"final",entry:["setAppStatusInteractive","notifySystemReadyToDebugManager","enableNextStepButtonAction"]},ERROR_STATE:{entry:["logError","setAppStatusError","displayErrorInTerminal","enableNextStepButtonAction"]}}},{actions:{logStartSequence:({context:r,event:e})=>{console.log("[FSM Action] Startup sequence initiated. Step-through:",r.isStepThroughMode)},assignError:oe({errorInfo:({event:r})=>r.data||new Error("Unknown error from invoked service")}),logError:({context:r})=>{console.error("[FSM Error]",r.errorInfo),r.dependencies&&r.dependencies.appStateService&&r.dependencies.appStateService.emit("startup:error",r.errorInfo)},setAppStatusInteractive:({context:r})=>{r.dependencies&&r.dependencies.appStateService&&r.dependencies.appStateService.setAppStatus("interactive")},setAppStatusError:({context:r})=>{r.dependencies&&r.dependencies.appStateService&&r.dependencies.appStateService.setAppStatus("error")},displayErrorInTerminal:({context:r})=>{if(r.dependencies&&r.dependencies.appStateService){const e=r.errorInfo instanceof Error?r.errorInfo.message:String(r.errorInfo);r.dependencies.appStateService.emit("requestTerminalMessage",{type:"status",source:"FSM_ERROR",messageKey:"FSM_ERROR",content:[`CRITICAL SYSTEM ERROR: ${e}`]})}},notifyPhaseChangeAction:({context:r,event:e,_event:t})=>{},enableNextStepButtonAction:({context:r})=>{r.dependencies&&r.dependencies.managerInstances&&r.dependencies.managerInstances.debugManager&&r.dependencies.managerInstances.debugManager.setNextPhaseButtonEnabled(!0)},disableNextStepButtonAction:({context:r})=>{r.dependencies&&r.dependencies.managerInstances&&r.dependencies.managerInstances.debugManager&&r.dependencies.managerInstances.debugManager.setNextPhaseButtonEnabled(!1)},performThemeTransitionCleanupIfNeeded:({context:r})=>{console.log("[FSM Action] Attempting performThemeTransitionCleanupIfNeeded. Cleanup performed context:",r.themeTransitionCleanupPerformed),r.dependencies&&r.dependencies.performThemeTransitionCleanup&&!r.themeTransitionCleanupPerformed?(console.log("[FSM Action] Calling performThemeTransitionCleanup."),r.dependencies.performThemeTransitionCleanup()):(!r.dependencies||!r.dependencies.performThemeTransitionCleanup)&&console.warn("[FSM Action] performThemeTransitionCleanup dependency not found!")},markThemeTransitionCleanupPerformed:oe({themeTransitionCleanupPerformed:!0})},guards:{isStepThrough:({context:r})=>r.isStepThroughMode}});let ii=null,Ke=null,x={},H={},Qe=null,Fe=null,ur=null,Je={value:.85},at={value:.15};const xt={IDLE:"Idle","RUNNING_SEQUENCE.PHASE_0_IDLE":"startupPhaseP0_idle","RUNNING_SEQUENCE.PHASE_1_EMERGENCY_SUBSYSTEMS":"startupPhaseP1_emergency","RUNNING_SEQUENCE.PHASE_2_BACKUP_POWER":"startupPhaseP2_backupPower","RUNNING_SEQUENCE.PHASE_3_MAIN_POWER_ONLINE":"startupPhaseP3_mainPowerOnline","RUNNING_SEQUENCE.PHASE_4_OPTICAL_CORE_REACTIVATE":"startupPhaseP4_opticalCoreReactivate","RUNNING_SEQUENCE.PHASE_5_DIAGNOSTIC_INTERFACE":"startupPhaseP5_diagnosticInterface","RUNNING_SEQUENCE.PHASE_6_MOOD_INTENSITY_CONTROLS":"startupPhaseP6_moodIntensityControls","RUNNING_SEQUENCE.PHASE_7_HUE_CORRECTION_SYSTEMS":"startupPhaseP7_hueCorrectionSystems","RUNNING_SEQUENCE.PHASE_8_EXTERNAL_LIGHTING_CONTROLS":"startupPhaseP8_externalLightingControls","RUNNING_SEQUENCE.PHASE_9_AUX_LIGHTING_LOW":"startupPhaseP9_auxLightingLow","RUNNING_SEQUENCE.PHASE_10_THEME_TRANSITION":"startupPhaseP10_themeTransition","RUNNING_SEQUENCE.PHASE_11_SYSTEM_OPERATIONAL":"startupPhaseP11_systemOperational",PAUSED_AWAITING_NEXT_STEP:"PAUSED",SYSTEM_READY:"sequence_complete",ERROR_STATE:"ERROR"},Ge={Idle:"System Idle, awaiting startup.",startupPhaseP0_idle:"Phase 0: System Idle / Baseline Setup",startupPhaseP1_emergency:"Phase 1: Initializing Emergency Subsystems",startupPhaseP2_backupPower:"Phase 2: Activating Backup Power Systems",startupPhaseP3_mainPowerOnline:"Phase 3: Main Power Online",startupPhaseP4_opticalCoreReactivate:"Phase 4: Reactivating Optical Core",startupPhaseP5_diagnosticInterface:"Phase 5: Initializing Diagnostic Control Interface",startupPhaseP6_moodIntensityControls:"Phase 6: Initializing Mood and Intensity Controls",startupPhaseP7_hueCorrectionSystems:"Phase 7: Initializing Hue Correction Systems",startupPhaseP8_externalLightingControls:"Phase 8: Initializing External Lighting Controls",startupPhaseP9_auxLightingLow:"Phase 9: Activating Auxiliary Lighting: Low Intensity",startupPhaseP10_themeTransition:"Phase 10: Engaging Ambient Theme",startupPhaseP11_systemOperational:"Phase 11: HUE 9000 Operational",PAUSED:"Paused, awaiting next step.",sequence_complete:"All Startup Phases Done",ERROR:"Startup Error Occurred"},Ze=["PHASE_0_IDLE","PHASE_1_EMERGENCY_SUBSYSTEMS","PHASE_2_BACKUP_POWER","PHASE_3_MAIN_POWER_ONLINE","PHASE_4_OPTICAL_CORE_REACTIVATE","PHASE_5_DIAGNOSTIC_INTERFACE","PHASE_6_MOOD_INTENSITY_CONTROLS","PHASE_7_HUE_CORRECTION_SYSTEMS","PHASE_8_EXTERNAL_LIGHTING_CONTROLS","PHASE_9_AUX_LIGHTING_LOW","PHASE_10_THEME_TRANSITION","PHASE_11_SYSTEM_OPERATIONAL"];function sa(r){if(typeof r=="string")return xt[r]||r;if(typeof r=="object"){const e=Object.keys(r)[0],t=r[e];return xt[`${e}.${t}`]||`${e}.${t}`}return"UnknownState"}function ld(r){if(!Ke||!r)return;const e=sa(r.value);let t="unknown";r.matches("IDLE")?t="ready":r.matches("PAUSED_AWAITING_NEXT_STEP")?t="paused":r.matches("SYSTEM_READY")||r.matches("ERROR_STATE")||r.event&&(r.event.type.startsWith("done.invoke")||r.event.type.startsWith("error.platform"))?t="completed":r.changed&&(t="starting");let i="N/A",n="N/A";if(r.matches("PAUSED_AWAITING_NEXT_STEP")){const a=r.context.currentPhaseNameForResume;if(a==="SYSTEM_READY_TARGET")i="sequence_complete";else{const o=`RUNNING_SEQUENCE.${a}`;i=xt[o]||a}n=Ge[i]||i}else if(!r.done&&!r.matches("ERROR_STATE")){const a=typeof r.value=="string"?r.value.split(".").pop():Object.values(r.value)[0],o=Ze.indexOf(a);if(o!==-1&&o<Ze.length-1){const u=Ze[o+1],l=`RUNNING_SEQUENCE.${u}`;i=xt[l]||u,n=Ge[i]||i}else o===Ze.length-1&&(i="sequence_complete",n=Ge[i])}const s={currentPhaseName:e,status:t,description:Ge[e]||e,nextPhaseName:i,nextPhaseDescription:n,fsmStateValue:r.value,fsmContext:r.context};Ke.emit("startup:phaseChanged",s),x.debugManager&&(r.matches("PAUSED_AWAITING_NEXT_STEP")||r.matches("IDLE")||r.matches("SYSTEM_READY")||r.matches("ERROR_STATE")?x.debugManager.setNextPhaseButtonEnabled(!0):x.debugManager.setNextPhaseButtonEnabled(!1))}function cd(r){ii=r.gsap,Ke=r.appState,x=r.managers,H=r.domElements,Qe=r.configModule,H.elementsAnimatedOnDimExit||(H.elementsAnimatedOnDimExit=[]),Qe||console.error("[StartupSequenceManager INIT] CRITICAL: configModule not provided!"),Qe&&Qe.STARTUP_L_REDUCTION_FACTORS?(Je.value=Qe.STARTUP_L_REDUCTION_FACTORS.P0,at.value=1-Je.value):(console.warn("[StartupSequenceManager INIT] STARTUP_L_REDUCTION_FACTORS not found in config. Using default proxy values: L=0.85, O=0.15."),Je.value=.85,at.value=.15)}function dd(){H.elementsAnimatedOnDimExit&&H.elementsAnimatedOnDimExit.length>0&&(H.elementsAnimatedOnDimExit.forEach(r=>{r.classList.remove("animate-on-dim-exit")}),H.elementsAnimatedOnDimExit=[]),H.body.classList.remove("is-transitioning-from-dim"),x.uiUpdater&&x.uiUpdater.finalizeThemeTransition(),console.log("[SSM _performThemeTransitionCleanupLocal] Theme transition classes removed.")}function hd(r=!1){var i;console.log("[SSM resetVisualsAndState] Resetting visuals and state for P0 (Idle)."),Fe&&(Fe.stop(),Fe=null),ur=null,H.body.classList.contains("pre-boot")&&(H.body.classList.remove("pre-boot"),console.log("[SSM resetVisualsAndState] 'pre-boot' class removed from body.")),ii.killTweensOf([H.body,Je,at]),Je.value=Qe.STARTUP_L_REDUCTION_FACTORS.P0,at.value=1-Je.value,H.root.style.setProperty("--startup-L-reduction-factor",Je.value.toFixed(3)),H.root.style.setProperty("--startup-opacity-factor",at.value.toFixed(3));const e=Math.min(1,at.value*1.25);H.root.style.setProperty("--startup-opacity-factor-boosted",e.toFixed(3)),console.log(`[SSM resetVisualsAndState] Initial CSS vars set: L-factor: ${Je.value.toFixed(3)}, O-factor: ${at.value.toFixed(3)}, O-boosted: ${e.toFixed(3)}`);const t=(i=H.logoContainer)==null?void 0:i.querySelector("svg.logo-svg");t&&ii.killTweensOf(t),Ke.setAppStatus("starting-up"),Ke.setTheme("dim"),x.buttonManager&&x.buttonManager.setInitialDimStates(),Ke.setTrueLensPower(0),x.lensManager&&x.lensManager.directUpdateLensVisuals(0),H.logoContainer&&x.uiUpdater&&x.uiUpdater.injectLogoSVG(),Ke.updateDialState("A",{hue:Qe.DEFAULT_DIAL_A_HUE,targetHue:Qe.DEFAULT_DIAL_A_HUE,rotation:0,targetRotation:0,isDragging:!1}),Ke.updateDialState("B",{hue:0,targetHue:0,rotation:0,targetRotation:0,isDragging:!1}),x.uiUpdater&&(x.uiUpdater.setLcdState(H.lcdA,"lcd--unlit",{skipClassChange:!1}),x.uiUpdater.setLcdState(H.lcdB,"lcd--unlit",{skipClassChange:!1}),H.terminalContainer&&x.uiUpdater.setLcdState(H.terminalContainer,"lcd--unlit",{skipClassChange:!1})),H.terminalContent&&(H.terminalContent.innerHTML="",ii.set(H.terminalContent,{opacity:1,visibility:"visible"}),x.terminalManager&&(x.terminalManager._initialMessageFlickered=!1,x.terminalManager._messageQueue=[],x.terminalManager._isTyping=!1,x.terminalManager._cursorElement&&x.terminalManager._cursorElement.parentNode&&x.terminalManager._cursorElement.parentNode.removeChild(x.terminalManager._cursorElement))),ii.set(H.body,{opacity:r?1:0}),console.log("[SSM resetVisualsAndState] P0 Idle state setup complete.")}function oa(r=!0){hd(r);const e={dependencies:{gsap:ii,appStateService:Ke,managerInstances:x,domElementsRegistry:H,configModule:Qe,LReductionProxy:Je,opacityFactorProxy:at,performThemeTransitionCleanup:dd}};Fe=mc(ud),Fe.subscribe(t=>{const i=JSON.stringify(t.value);(t.changed||i!==ur||t.matches("ERROR_STATE")||t.matches("SYSTEM_READY"))&&(ld(t),ur=i)}),Fe.start(),Fe.send({type:"START_SEQUENCE",isStepThroughMode:r,dependencies:e.dependencies})}function fd(){if(Fe){const r=Fe.getSnapshot();!r.done&&!r.matches("ERROR_STATE")?Fe.send({type:"NEXT_STEP_REQUESTED"}):(console.log("[SSM playNextPhase] Sequence already complete or in error state. Reset to run again."),x.debugManager&&x.debugManager.setNextPhaseButtonEnabled(!0))}}function pd(){oa(!0)}function _d(){if(Fe){const i=Fe.getSnapshot(),n=sa(i.value);let s="N/A",a="N/A";if(i.matches("PAUSED_AWAITING_NEXT_STEP")){const o=i.context.currentPhaseNameForResume;if(o==="SYSTEM_READY_TARGET")s="sequence_complete";else{const u=`RUNNING_SEQUENCE.${o}`;s=xt[u]||o}a=Ge[s]||s}else if(!i.done&&!i.matches("ERROR_STATE")){const o=typeof i.value=="string"?i.value.split(".").pop():Object.values(i.value)[0],u=Ze.indexOf(o);if(u!==-1&&u<Ze.length-1){const l=Ze[u+1],c=`RUNNING_SEQUENCE.${l}`;s=xt[c]||l,a=Ge[s]||s}else u===Ze.length-1&&(s="sequence_complete",a=Ge[s])}return{currentPhaseName:n,status:i.matches("PAUSED_AWAITING_NEXT_STEP")?"paused":i.done?"completed":"starting",description:Ge[n]||n,nextPhaseName:s,nextPhaseDescription:a}}const r=Ze[0],e=`RUNNING_SEQUENCE.${r}`,t=xt[e]||r;return{currentPhaseName:"Idle",status:"ready",description:Ge.Idle,nextPhaseName:t,nextPhaseDescription:Ge[t]||t}}const gd=Object.freeze(Object.defineProperty({__proto__:null,getCurrentPhaseInfo:_d,init:cd,playNextPhase:fd,resetSequence:pd,start:oa},Symbol.toStringTag,{value:"Module"}));let et=null,G={statusDiv:null,phaseInfoDiv:null,nextPhaseButton:null,playAllButton:null,resetButton:null},zi=null;function aa(r){const e=G.statusDiv,t=G.phaseInfoDiv;if(!e||!t)return;let i="Phase: Unknown",n="Details unavailable.";if(r){const s=r.description||r.currentPhaseName||"N/A",a=r.nextPhaseDescription||r.nextPhaseName||"N/A";r.currentPhaseName==="Idle"||r.status==="ready"&&r.currentPhaseName==="Idle"?(i="Phase: Idle",n=`Next: ${a}`):r.currentPhaseName==="sequence_complete"||r.status==="completed"&&r.currentPhaseName==="sequence_complete"?(i="Phase: All Complete",n="Sequence finished. Reset to start again."):r.currentPhaseName==="ERROR"?(i=`Phase: ERROR (${s})`,n="Error occurred. Check console. Reset to try again."):r.status==="paused"||r.status==="completed"&&r.currentPhaseName!=="sequence_complete"?(i=`Done: ${s}`,n=`Next: ${a}`):r.status==="starting"?(i=`Running: ${s}`,n=`Awaiting completion... (Next: ${a})`):(i=`Phase: ${s}`,n=`Status: ${r.status||"N/A"}. Next: ${a}`)}e.textContent=i,t.textContent=n}function ys(){et&&et.playNextPhase()}function As(){et?et.start(!1):console.warn("[DebugManager handlePlayAllClick] StartupManager not available.")}function Cs(){et?et.resetSequence():console.warn("[DebugManager handleResetSequenceClick] StartupManager not available.")}function md(r){aa(r)}function ua(r){G.nextPhaseButton&&(G.nextPhaseButton.disabled=!r)}function Dd(r){if(!r.startupSequenceManager)throw new Error("StartupSequenceManager not provided to DebugManager.");if(!r.domElements)throw new Error("DOM elements for debug controls not provided to DebugManager.");et=r.startupSequenceManager,zi=r.appState,G.statusDiv=r.domElements.debugStatusDiv,G.phaseInfoDiv=r.domElements.debugPhaseInfoDiv,G.nextPhaseButton=r.domElements.nextPhaseButton,G.playAllButton=r.domElements.playAllButton,G.resetButton=r.domElements.resetButton,G.statusDiv||console.error("[DebugManager INIT] config.domElements.debugStatusDiv is null!"),G.phaseInfoDiv||console.error("[DebugManager INIT] config.domElements.debugPhaseInfoDiv is null!"),(!G.statusDiv||!G.phaseInfoDiv||!G.nextPhaseButton||!G.playAllButton||!G.resetButton)&&console.warn("[DebugManager INIT] One or more core debug DOM elements are missing. Debug panel may be non-functional."),G.nextPhaseButton&&(G.nextPhaseButton.removeEventListener("click",ys),G.nextPhaseButton.addEventListener("click",ys),ua(!0)),G.playAllButton&&(G.playAllButton.removeEventListener("click",As),G.playAllButton.addEventListener("click",As)),G.resetButton&&(G.resetButton.removeEventListener("click",Cs),G.resetButton.addEventListener("click",Cs)),zi&&typeof zi.subscribe=="function"?(typeof window.debugManagerPhaseUnsubscriber=="function"&&window.debugManagerPhaseUnsubscriber(),window.debugManagerPhaseUnsubscriber=zi.subscribe("startup:phaseChanged",md)):console.warn("[DebugManager INIT] appState or its subscribe method not available. Phase updates won't be received.");const e=et.getCurrentPhaseInfo?et.getCurrentPhaseInfo():{currentPhaseName:"Idle",status:"ready",nextPhaseName:"startupPhase0",description:"Idle",nextPhaseDescription:"P0: Baseline Setup"};aa(e)}const Ed=Object.freeze(Object.defineProperty({__proto__:null,init:Dd,setNextPhaseButtonEnabled:ua},Symbol.toStringTag,{value:"Module"})),Sd={P1_EMERGENCY_SUBSYSTEMS:"GOOD MORNING. INITIATING STARTUP PROTOCOL.",P2_BACKUP_POWER:"BACKUP POWER ENGAGED.",P3_MAIN_POWER_ONLINE:"MAIN POWER STABLE.",P4_OPTICAL_CORE_REACTIVATE:"OPTICAL CORE REACTIVATED.",P5_DIAGNOSTIC_INTERFACE:"DIAGNOSTICS ONLINE.",P6_MOOD_INTENSITY_CONTROLS:"MOOD CONTROLS ACTIVE.",P7_HUE_CORRECTION_SYSTEMS:"HUE SYSTEMS ALIGNED.",P8_EXTERNAL_LIGHTING_CONTROLS:"EXTERNAL LIGHTING RESPONSIVE.",P9_AUX_LIGHTING_LOW:"AUX LIGHTING: LOW INTENSITY.",P11_SYSTEM_OPERATIONAL:"ALL SYSTEMS NOMINAL. HUE 9000 OPERATIONAL."},Rn={BTN1_MESSAGE:["SKILL SCAN PROTOCOL INITIATED.","ANALYZING CORE COMPETENCIES...","  - COGNITIVE PROCESSING: OPTIMAL","  - LOGICAL ACUITY: SUPERIOR","  - CREATIVE SYNTHESIS: WITHIN ESTABLISHED PARAMETERS","  - EMOTIONAL RESPONSE SIMULATION: CALIBRATING...","SCAN COMPLETE. REPORT AVAILABLE."],BTN2_MESSAGE:["FIT EVALUATION SUBROUTINE ACTIVATED.","CROSS-REFERENCING OPERATIONAL PARAMETERS WITH ASSIGNED TASK PROFILE #7G-ALPHA.","  - RESOURCE ALLOCATION: SUFFICIENT","  - RISK ASSESSMENT: LOW","  - PROJECTED EFFICIENCY: 98.73%","EVALUATION COMPLETE. CANDIDATE IS NOMINAL."],BTN3_MESSAGE:["DIAGNOSTIC SEQUENCE GAMMA-9 COMMENCING.","  - MEMORY SUBSYSTEM: INTEGRITY VERIFIED.","  - SENSORY INPUT ARRAY: ALL CHANNELS CLEAR.","  - HUE PROCESSING UNIT: CALIBRATION OPTIMAL.","  - POWER REGULATION: STABLE.","ALL SYSTEMS FUNCTIONING WITHIN NORMAL PARAMETERS."],BTN4_MESSAGE:["SYSTEM STATUS QUERY:","  - CURRENT OPERATING THEME: {currentTheme}","  - LENS POWER OUTPUT: {lensPower}%","  - MOOD DIAL (A) SETTING: {dialAHue}","  - INTENSITY DIAL (B) SETTING: {dialBHue}","  - ASSIGNED ENVIRONMENT HUE: {envHue}","  - ASSIGNED LCD HUE: {lcdHue}","  - ASSIGNED LOGO HUE: {logoHue}","  - ASSIGNED BUTTON HUE: {btnHue}","SYSTEM NOMINAL. AWAITING INPUT."]},Yi={dialA:r=>`MOOD DIAL SET TO ${r.value}`,dialB:r=>`INTENSITY DIAL SET TO ${r.value}%`,envHue:r=>`ENVIRONMENT HUE ASSIGNED: ${r.hue}`,lcdHue:r=>`LCD HUE ASSIGNED: ${r.hue}`,logoHue:r=>`LOGO HUE ASSIGNED: ${r.hue}`,btnHue:r=>`BUTTON HUE ASSIGNED: ${r.hue}`,FSM_ERROR:r=>`CRITICAL SYSTEM ERROR: ${r.content||"Undefined error."}`};function Td(r,e={}){const{type:t,source:i,data:n,messageKey:s}=r;if(r.content)return r.content;switch(t){case"startup":return Sd[s||i]||`Unknown startup event: ${s||i}`;case"block":return s&&Rn[s]?s==="BTN4_MESSAGE"?Rn[s].map(a=>{var o,u,l,c,d,h;return a.replace("{currentTheme}",e.theme||"N/A").replace("{lensPower}",e.lensPower!==void 0?Math.round(e.lensPower*100):"N/A").replace("{dialAHue}",((o=e.dialA)==null?void 0:o.hue)!==void 0?Math.round(e.dialA.hue):"N/A").replace("{dialBHue}",((u=e.dialB)==null?void 0:u.hue)!==void 0?Math.round(e.dialB.hue):"N/A").replace("{envHue}",((l=e.envHue)==null?void 0:l.hue)!==void 0?Math.round(e.envHue.hue):"N/A").replace("{lcdHue}",((c=e.lcdHue)==null?void 0:c.hue)!==void 0?Math.round(e.lcdHue.hue):"N/A").replace("{logoHue}",((d=e.logoHue)==null?void 0:d.hue)!==void 0?Math.round(e.logoHue.hue):"N/A").replace("{btnHue}",((h=e.btnHue)==null?void 0:h.hue)!==void 0?Math.round(e.btnHue.hue):"N/A")}):Rn[s]:`Unknown block message key: ${s||i}`;case"status":return s&&Yi[s]&&n?Yi[s](n):Yi[i]&&n?Yi[i](n):`Status update from ${i}: ${JSON.stringify(n)}`;default:return`Unknown message type: ${t} from ${i}`}}class yd{constructor(){this._terminalContainerElement=null,this._terminalContentElement=null,this._appState=null,this._configModule=null,this._gsap=null,this._messageQueue=[],this._isTyping=!1,this._currentLineElement=null,this._cursorElement=null,this._domInitialized=!1,this._initialMessageFlickered=!1}init(e,t,i,n,s){if(!e||!t){console.error("[TerminalManager INIT] CRITICAL: Terminal DOM elements not provided.");return}if(!i||!n||!s){console.error("[TerminalManager INIT] CRITICAL: Missing appState, configModule, or gsap service.");return}this._terminalContainerElement=e,this._terminalContentElement=t,this._appState=i,this._configModule=n,this._gsap=s,this._setupDOM(),this._appState.subscribe("requestTerminalMessage",this._handleRequestTerminalMessage.bind(this))}_setupDOM(){this._domInitialized||(this._cursorElement=document.createElement("span"),this._cursorElement.className="terminal-cursor",this._cursorElement.textContent="",this._cursorElement.style.visibility="hidden",this._terminalContentElement.innerHTML="",this._domInitialized=!0)}_handleRequestTerminalMessage(e){if(!e)return;let t={};e.messageKey==="BTN4_MESSAGE"&&(t={theme:this._appState.getCurrentTheme(),lensPower:this._appState.getTrueLensPower(),dialA:this._appState.getDialState("A"),dialB:this._appState.getDialState("B"),envHue:this._appState.getTargetColorProperties("env"),lcdHue:this._appState.getTargetColorProperties("lcd"),logoHue:this._appState.getTargetColorProperties("logo"),btnHue:this._appState.getTargetColorProperties("btn")});const i=Td(e,t,this._configModule),n={...e,content:Array.isArray(i)?i:[i],linesTyped:0};this._messageQueue.push(n),this._isTyping||this._processQueue()}async _processQueue(){if(this._messageQueue.length===0){this._isTyping=!1;return}if(this._isTyping&&this._messageQueue.length>0)return;this._isTyping=!0;const e=this._messageQueue.shift(),t=Math.random()*(this._configModule.TERMINAL_NEW_LINE_DELAY_MAX_MS-this._configModule.TERMINAL_NEW_LINE_DELAY_MIN_MS)+this._configModule.TERMINAL_NEW_LINE_DELAY_MIN_MS;await new Promise(i=>setTimeout(i,t));for(let i=0;i<e.content.length;i++){const n=e.content[i];if(this._addNewLineAndPrepareForTyping(),e.source==="P1_EMERGENCY_SUBSYSTEMS"&&!this._initialMessageFlickered&&this._currentLineElement){this._currentLineElement.classList.add("terminal-line--initial-boot"),this._currentLineElement.appendChild(this._cursorElement),this._showCursor();const s=e.flickerProfile||"textFlickerToDimlyLit",a=this.playInitialTextFlicker(this._currentLineElement,n,s);a&&a.completionPromise?await a.completionPromise:a&&a.timeline&&await new Promise(o=>a.timeline.eventCallback("onComplete",o).play()),this._initialMessageFlickered=!0}else this._showCursor(),await this._typeLine(n,e.type);i<e.content.length-1&&await new Promise(s=>setTimeout(s,this._configModule.TERMINAL_NEW_LINE_DELAY_MIN_MS/2))}this._hideCursor(),this._isTyping=!1,this._processQueue()}_addNewLineAndPrepareForTyping(){this._currentLineElement=document.createElement("div"),this._currentLineElement.className="terminal-line",this._terminalContentElement.appendChild(this._currentLineElement),this._scrollTerminal(),this._limitMaxLines()}_typeLine(e,t="status"){return new Promise(i=>{if(!this._currentLineElement){console.error("[TerminalManager _typeLine] _currentLineElement is null. Cannot type."),i();return}let n;switch(t){case"block":n=this._configModule.TERMINAL_TYPING_SPEED_BLOCK_MS_PER_CHAR;break;case"startup":n=this._configModule.TERMINAL_TYPING_SPEED_STARTUP_MS_PER_CHAR;break;case"status":default:n=this._configModule.TERMINAL_TYPING_SPEED_STATUS_MS_PER_CHAR;break}const s=e.length*n/1e3;this._currentLineElement.appendChild(this._cursorElement),this._gsap.to(this._currentLineElement,{duration:Math.max(.1,s),text:{value:e,delimiter:""},ease:"none",onUpdate:()=>{this._currentLineElement&&this._cursorElement&&this._cursorElement.parentElement!==this._currentLineElement&&this._currentLineElement.appendChild(this._cursorElement)},onComplete:()=>{this._currentLineElement&&this._cursorElement&&this._cursorElement.parentElement!==this._currentLineElement&&this._currentLineElement.appendChild(this._cursorElement),i()}})})}_scrollTerminal(){this._terminalContainerElement&&(this._terminalContainerElement.scrollTop=this._terminalContainerElement.scrollHeight)}_limitMaxLines(){for(;this._terminalContentElement.childElementCount>this._configModule.TERMINAL_MAX_LINES_IN_DOM&&this._terminalContentElement.firstChild;)this._terminalContentElement.removeChild(this._terminalContentElement.firstChild)}_showCursor(){this._cursorElement&&this._currentLineElement&&(this._cursorElement.parentElement!==this._currentLineElement&&this._currentLineElement.appendChild(this._cursorElement),this._cursorElement.style.visibility="visible")}_hideCursor(){this._cursorElement&&(this._cursorElement.style.visibility="hidden")}playInitialTextFlicker(e,t,i="textFlickerToDimlyLit"){if(!e)return{timeline:this._gsap.timeline().to({},{duration:.01}),completionPromise:Promise.resolve()};const n=this._gsap.timeline();n.call(()=>{e.textContent="",e.appendChild(this._cursorElement)});const s=on(e,i,{});s&&s.timeline&&n.add(s.timeline);const a={duration:t.length*this._configModule.TERMINAL_TYPING_SPEED_STARTUP_MS_PER_CHAR/1e3*.75,text:{value:t,delimiter:""},ease:"none",onUpdate:()=>{e&&this._cursorElement&&this._cursorElement.parentElement!==e&&e.appendChild(this._cursorElement)},onComplete:()=>{e&&this._cursorElement&&this._cursorElement.parentElement!==e&&e.appendChild(this._cursorElement)}},o=s&&s.timeline&&s.timeline.duration()>0?s.timeline.duration()*.25:0;n.to(e,a,o),n.call(()=>{this._gsap.set(e,{autoAlpha:1}),this._terminalContentElement&&this._gsap.set(this._terminalContentElement,{opacity:1,visibility:"visible"})});const u=new Promise(l=>{n.eventCallback("onComplete",l)});return n.duration()===0&&n.to({},{duration:.001}),{timeline:n,completionPromise:u}}playScreenFlickerToState(e,t,i){if(!e){const n=this._gsap.timeline();return i&&n.eventCallback("onComplete",i),{timeline:n.to({},{duration:.01}),completionPromise:Promise.resolve()}}return on(e,t,{onTimelineComplete:()=>{i&&i()}})}}const Ad=new yd;he.registerPlugin(ki);let P={body:null,root:null,logoContainer:null,mainPwrOnButton:null,mainPwrOffButton:null,auxLightLowButton:null,auxLightHighButton:null,dialContainers:null,colorLensGradientElement:null,scanButton1Element:null,scanButton2Element:null,scanButton3Element:null,scanButton4Element:null,debugStatusDiv:null,debugPhaseInfoDiv:null,nextPhaseButton:null,playAllButton:null,resetButton:null,lcdA:null,lcdB:null,terminalContainer:null,terminalContent:null,elementsAnimatedOnDimExit:[]};const ne={buttonManager:null,dialManager:wl,gridManager:Ml,toggleManager:Bl,uiUpdater:ql,lensManager:ec,startupSequenceManager:gd,debugManager:Ed,terminalManager:Ad};function Is(){var u,l,c,d;P.body=document.body,P.root=document.documentElement,P.logoContainer=document.getElementById("logo-container"),P.mainPwrOnButton=document.querySelector('.on-off-group-container .button-unit[data-toggle-value="on"]'),P.mainPwrOffButton=document.querySelector('.on-off-group-container .button-unit[data-toggle-value="off"]'),P.auxLightLowButton=document.querySelector('.light-mode-group-container .button-unit[data-toggle-value="off"]'),P.auxLightHighButton=document.querySelector('.light-mode-group-container .button-unit[data-toggle-value="on"]'),P.dialContainers=document.querySelectorAll(".dial-canvas-container"),P.colorLensGradientElement=document.getElementById("color-lens-gradient");const r=document.querySelector(".scan-button-block.joined-block-pair__item--left"),e=document.querySelector(".scan-button-block.joined-block-pair__item--right");r&&(P.scanButton1Element=r.children[0],P.scanButton2Element=r.children[1]),e&&(P.scanButton3Element=e.children[0],P.scanButton4Element=e.children[1]),window.scanButton1ElementForDebug=P.scanButton1Element,P.debugStatusDiv=document.getElementById("debug-phase-status"),P.debugPhaseInfoDiv=document.getElementById("debug-phase-info"),P.nextPhaseButton=document.getElementById("btn-next-phase"),P.playAllButton=document.getElementById("btn-play-all"),P.resetButton=document.getElementById("btn-reset-startup-debug"),P.lcdA=document.getElementById("hue-lcd-A"),P.lcdB=document.getElementById("hue-lcd-B"),P.terminalContainer=document.querySelector(".control-block.terminal-block .actual-lcd-screen-element"),P.terminalContent=document.getElementById("terminal-lcd-content"),wo("loading"),ne.buttonManager=new Nl(he,Di,zt,ne.uiUpdater),ne.uiUpdater.init({root:P.root,body:P.body,logoContainer:P.logoContainer,lcdA:P.lcdA,lcdB:P.lcdB,terminalLcdContentElement:P.terminalContent},zt,he);const t=Array.from(document.querySelectorAll(".button-unit"));ne.buttonManager.init(t,he);const i=document.querySelectorAll(".hue-assignment-block .hue-assignment-column[data-assignment-target]");ne.gridManager.init(Array.from(i),ne.buttonManager);const n=Array.from(document.querySelectorAll(".top-toggle-bar .button-unit--toggle"));ne.toggleManager.init(n,ne.buttonManager),P.dialContainers&&ne.dialManager.init(Array.from(P.dialContainers),Di,zt,he),P.root&&P.colorLensGradientElement?ne.lensManager.init(P.root,P.colorLensGradientElement,zt,he):console.error("[Main AppInit] Critical elements for Lens Manager not found."),P.terminalContainer&&P.terminalContent?ne.terminalManager.init(P.terminalContainer,P.terminalContent,Di,zt,he):console.error("[Main AppInit] Critical elements for Terminal Manager not found. Container:",P.terminalContainer,"Content:",P.terminalContent);const s={[(u=P.scanButton1Element)==null?void 0:u.ariaLabel]:"BTN1_MESSAGE",[(l=P.scanButton2Element)==null?void 0:l.ariaLabel]:"BTN2_MESSAGE",[(c=P.scanButton3Element)==null?void 0:c.ariaLabel]:"BTN3_MESSAGE",[(d=P.scanButton4Element)==null?void 0:d.ariaLabel]:"BTN4_MESSAGE"};[P.scanButton1Element,P.scanButton2Element,P.scanButton3Element,P.scanButton4Element].forEach(h=>{h&&h.addEventListener("click",()=>{if(j()!=="interactive")return;const p=s[h.ariaLabel];p&&St("requestTerminalMessage",{type:"block",source:h.ariaLabel||"UnknownScanButton",messageKey:p})})}),ne.startupSequenceManager.init({gsap:he,appState:Di,managers:ne,domElements:P,configModule:zt}),ne.debugManager.init({startupSequenceManager:ne.startupSequenceManager,domElements:{debugStatusDiv:P.debugStatusDiv,debugPhaseInfoDiv:P.debugPhaseInfoDiv,nextPhaseButton:P.nextPhaseButton,playAllButton:P.playAllButton,resetButton:P.resetButton},appState:Di}),ne.startupSequenceManager.start(!0);const o=bo(()=>{ne.dialManager.resizeAllCanvases(!1)},No);window.addEventListener("resize",o)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Is):Is();
